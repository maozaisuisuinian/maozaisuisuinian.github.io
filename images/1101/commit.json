{"compress":true,"commitItems":[["25394870-eaf1-4b3f-8438-9826f606a19b",1531707641931,"",[[1531707586395,["whale@Whale",[[1,0,"php反序列化\n===\n\n\n"]],[0,0],[14,14]]],[1531707664659,["whale@Whale",[[1,14,"\n![捕获]($res/%E6%8D%95%E8%8E%B7.PNG)\n"]],[14,14],[50,50]]],[1531708322295,["whale@Whale",[[1,50,"\n\n"]],[50,50],[51,51]]],[1531708322542,["whale@Whale",[[1,52,"\n"]],[51,51],[52,52]]],[1531708328725,["whale@Whale",[[1,53,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)\n\n"]],[52,52],[94,94]]],[1531709627944,["whale@Whale",[[-1,14,"\n"]],[13,13],[12,12]]],[1531709628360,["whale@Whale",[[-1,13,"\n"]],[12,12],[11,11]]],[1531709629439,["whale@Whale",[[-1,10,"="]],[11,11],[10,10]]],[1531709631175,["whale@Whale",[[1,10,"="]],[10,10],[11,11]]],[1531709631992,["whale@Whale",[[-1,10,"="]],[11,11],[10,10]]],[1531709632595,["whale@Whale",[[1,10,"="]],[10,10],[11,11]]],[1531709633311,["whale@Whale",[[1,13,"\n"]],[11,11],[12,12]]],[1531709633960,["whale@Whale",[[-1,13,"\n"]],[12,12],[11,11]]],[1531709641657,["whale@Whale",[[1,15,"1]($res/1.png)\n\n!["]],[12,12],[30,30]]],[1531709644407,["whale@Whale",[[-1,30,"\n"]],[30,30],[29,29]]],[1531709709696,["whale@Whale",[[1,12,"基础只是"]],[12,12],[16,16]]],[1531709711313,["whale@Whale",[[-1,12,"基础只是"]],[16,16],[12,12]]],[1531709717671,["whale@Whale",[[1,12,"php基础提要："]],[12,12],[20,20]]],[1531709736676,["whale@Whale",[[1,74,"php允许保存一个对象方便以后重用，"]],[74,74],[92,92]]],[1531709742247,["whale@Whale",[[1,92,"这就是序列化。"]],[92,92],[99,99]]],[1531709742695,["whale@Whale",[[1,101,"\n"]],[99,99],[100,100]]],[1531709756016,["whale@Whale",[[1,100,"场景：变量值需要跨脚本传递。"]],[100,100],[114,114]]],[1531710485447,["whale@Whale",[[1,116,"\n"]],[115,115],[116,116]]],[1531710493449,["whale@Whale",[[1,122,"3]($res/%E6%8D%95%E8%8E%B7%203.PNG)\n\n![捕获 "]],[116,116],[158,158]]],[1531710500781,["whale@Whale",[[1,116,"序列化"]],[116,116],[119,119]]],[1531710506966,["whale@Whale",[[1,116,"### "]],[116,116],[120,120]]],[1531710598688,["whale@Whale",[[1,165,"### 反序列化"]],[165,165],[173,173]]],[1531722685289,["whale@Whale",[[1,174,"\n"]],[173,173],[174,174]]],[1531722692565,["whale@Whale",[[1,180,"4]($res/%E6%8D%95%E8%8E%B7%204.PNG)\n\n![捕获 "]],[174,174],[216,216]]],[1531722708479,["whale@Whale",[[-1,174,"\n"]],[174,174],[173,173]]],[1531722714152,["whale@Whale",[[1,216,"\n"]],[215,215],[216,216]]],[1531722720974,["whale@Whale",[[-1,126,"捕获 3"]],[130,130],[126,126]]],[1531722722848,["whale@Whale",[[-1,172,"捕获 4"]],[176,176],[172,172]]],[1531722791200,["whale@Whale",[[-1,209,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)"]],[209,249],[209,209]]],[1531722797007,["whale@Whale",[[1,209,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)"]],[209,209],[209,249]]],[1531722802807,["whale@Whale",[[-1,209,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)"]],[209,249],[209,209]]],[1531722808237,["whale@Whale",[[1,209,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)"]],[209,209],[209,249]]],[1531722816934,["whale@Whale",[[-1,209,"![捕获 2]($res/%E6%8D%95%E8%8E%B7%202.PNG)"]],[209,249],[209,209]]],[1531723246071,["whale@Whale",[[1,170,"\n"]],[169,169],[170,170]]],[1531723248463,["whale@Whale",[[1,171,"\n"]],[170,170],[171,171]]],[1531723268170,["whale@Whale",[[1,171,"先建立一个logfile.php，use.php包含它，"]],[171,171],[199,199]]],[1531723278609,["whale@Whale",[[-1,195,"包含它，"]],[199,199],[195,195]]],[1531723278937,["whale@Whale",[[1,195,"。"]],[195,195],[196,196]]],[1531723283423,["whale@Whale",[[1,238,"\n"]],[234,234],[235,235]]],[1531723826782,["whale@Whale",[[1,197,"\n"]],[196,196],[197,197]]],[1531723833443,["whale@Whale",[[1,200,"捕获 5]($res/%E6%8D%95%E8%8E%B7%205.PNG)\n\n!["]],[197,197],[239,239]]],[1531723838106,["whale@Whale",[[-1,200,"捕获 5]"],[1,205,"l"]],[200,205],[200,201]]],[1531723838315,["whale@Whale",[[1,201,"o"]],[200,201],[200,202]]],[1531723838537,["whale@Whale",[[1,202,"g"]],[200,202],[200,203]]],[1531723839111,["whale@Whale",[[1,203,"'f"]],[200,203],[200,205]]],[1531723839298,["whale@Whale",[[1,205,"i"]],[200,205],[200,206]]],[1531723839441,["whale@Whale",[[1,206,"'l"]],[200,206],[200,208]]],[1531723839651,["whale@Whale",[[-1,206,"'"],[1,208,"e"]],[200,208],[200,208]]],[1531723840194,["whale@Whale",[[-1,203,"'"]],[200,208],[200,207]]],[1531723840802,["whale@Whale",[[1,207,".php"]],[207,207],[211,211]]],[1531723849550,["whale@Whale",[[-1,200,"logfile.php"]],[211,211],[200,200]]],[1531723850655,["whale@Whale",[[1,200,"】"]],[200,200],[201,201]]],[1531723851677,["whale@Whale",[[-1,200,"】"]],[201,201],[200,200]]],[1531723852468,["whale@Whale",[[1,200,"]"]],[200,200],[201,201]]],[1531723856611,["whale@Whale",[[1,200,"logfile.php"]],[200,200],[211,211]]],[1531723882583,["whale@Whale",[[-1,288,"\n"]],[286,286],[285,285]]],[1531723883375,["whale@Whale",[[1,285,"zhi"]],[285,285],[288,288]]],[1531723884031,["whale@Whale",[[-1,285,"zhi"]],[288,288],[285,285]]],[1531723903549,["whale@Whale",[[1,285,"之后，建立一个test.php，其中建立一个"]],[285,285],[307,307]]],[1531723908702,["whale@Whale",[[-1,303,"建立一个"]],[307,307],[303,303]]],[1531723912301,["whale@Whale",[[1,303,"定义一个心得"]],[303,303],[309,309]]],[1531723913860,["whale@Whale",[[-1,307,"心得"]],[309,309],[307,307]]],[1531723915282,["whale@Whale",[[1,307,"心得"]],[307,307],[309,309]]],[1531723915873,["whale@Whale",[[-1,307,"心得"]],[309,309],[307,307]]],[1531723923622,["whale@Whale",[[1,307,"新的类 User,"]],[307,307],[316,316]]],[1531723924393,["whale@Whale",[[-1,315,","]],[316,316],[315,315]]],[1531723924686,["whale@Whale",[[1,315,"."]],[315,315],[316,316]]],[1531723986048,["whale@Whale",[[-1,315,"."]],[316,316],[315,315]]],[1531723986795,["whale@Whale",[[1,315,"."]],[315,315],[316,316]]],[1531723987295,["whale@Whale",[[-1,315,"."]],[316,316],[315,315]]],[1531723987921,["whale@Whale",[[1,315,"。"]],[315,315],[316,316]]],[1531724325582,["whale@Whale",[[1,319,"\n"]],[316,316],[317,317]]],[1531724330394,["whale@Whale",[[1,317,"此时1.php"]],[317,317],[324,324]]],[1531724350934,["whale@Whale",[[1,21,"\n"]],[20,20],[21,21]]],[1531724351630,["whale@Whale",[[1,39,"\n"]],[38,38],[39,39]]],[1531724352623,["whale@Whale",[[-1,24,"1"]],[25,25],[24,24]]],[1531724354997,["whale@Whale",[[1,24,"图1"]],[24,24],[26,26]]],[1531724357351,["whale@Whale",[[-1,43,"捕获"]],[45,45],[43,43]]],[1531724367623,["whale@Whale",[[-1,320,"1.php"]],[325,325],[320,320]]],[1531724369718,["whale@Whale",[[1,320,"图一 "]],[320,320],[323,323]]],[1531724370207,["whale@Whale",[[-1,322," "]],[323,323],[322,322]]],[1531724379216,["whale@Whale",[[1,322,"建立的1.php还存在。"]],[322,322],[334,334]]],[1531724379512,["whale@Whale",[[1,337,"\n"]],[334,334],[335,335]]],[1531724379869,["whale@Whale",[[1,338,"\n"]],[335,335],[336,336]]],[1531724402594,["whale@Whale",[[1,336,"![捕获 6]($res/%E6%8D%95%E8%8E%B7%206.PNG)\n\n"]],[335,335],[377,377]]],[1531724405367,["whale@Whale",[[1,381,"\n"]],[377,377],[378,378]]],[1531724425729,["whale@Whale",[[1,379,"![捕获 7]($res/%E6%8D%95%E8%8E%B7%207.PNG)\n\n"]],[378,378],[420,420]]],[1531724429023,["whale@Whale",[[-1,335,"\n"]],[335,335],[334,334]]],[1531724429681,["whale@Whale",[[-1,377,"\n"]],[377,377],[376,376]]],[1531724429967,["whale@Whale",[[-1,376,"\n"]],[376,376],[375,375]]],[1531726558500,["whale@Whale",[[1,418,"O:7:\"LogFile\":1:{s:8:\"filename\";s:5:\"1.php\";}"]],[418,418],[463,463]]],[1531726561487,["whale@Whale",[[-1,418,"O:7:\"LogFile\":1:{s:8:\"filename\";s:5:\"1.php\";}"]],[463,463],[418,418]]],[1531726757783,["whale@Whale",[[1,248,"\n"]],[247,247],[248,248]]],[1531726775734,["whale@Whale",[[1,248,"logfile.php定义了一个类，可以进行文件删除操作。"]],[248,248],[277,277]]],[1531726776087,["whale@Whale",[[1,278,"\n"]],[277,277],[278,278]]],[1531726781119,["whale@Whale",[[1,317,"\n"]],[315,315],[316,316]]],[1531726781479,["whale@Whale",[[1,318,"\n"]],[316,316],[317,317]]],[1531726785688,["whale@Whale",[[1,317,"use.php"]],[317,317],[324,324]]],[1531726812997,["whale@Whale",[[1,324,"zhi"]],[324,324],[327,327]]],[1531726813716,["whale@Whale",[[-1,324,"zhi"]],[327,327],[324,324]]],[1531726825653,["whale@Whale",[[1,324,"指定了一个文件，进行删除。O:7:\"LogFile\":1:{s:8:\"filename\";s:5:\"1.php\";}"]],[324,324],[382,382]]],[1531726831544,["whale@Whale",[[1,337,"·"]],[337,337],[338,338]]],[1531726832150,["whale@Whale",[[-1,337,"·"]],[338,338],[337,337]]],[1531726832658,["whale@Whale",[[1,337,"`"]],[337,337],[338,338]]],[1531726833531,["whale@Whale",[[1,383,"`"]],[383,383],[384,384]]],[1531726835790,["whale@Whale",[[1,337,"\n"]],[337,337],[338,338]]],[1531726836846,["whale@Whale",[[1,387,"\n"]],[385,385],[386,386]]],[1531726837817,["whale@Whale",[[1,386,"fu"]],[386,386],[388,388]]],[1531726838372,["whale@Whale",[[-1,386,"fu"]],[388,388],[386,386]]],[1531726846377,["whale@Whale",[[1,386,"复制生成的这个序列，之后要"]],[386,386],[399,399]]],[1531726847795,["whale@Whale",[[1,399,"用到。"]],[399,399],[402,402]]],[1531729481201,["whale@Whale",[[1,12,"\n"]],[11,11],[12,12]]],[1531729481405,["whale@Whale",[[1,13,"\n"]],[12,12],[13,13]]],[1531729486318,["whale@Whale",[[1,12,"参考资料："]],[12,12],[17,17]]],[1531729489577,["whale@Whale",[[1,12,"【"]],[12,12],[13,13]]],[1531729490918,["whale@Whale",[[-1,12,"【"]],[13,13],[12,12]]],[1531729492043,["whale@Whale",[[1,12,"[]"]],[12,12],[14,14]]],[1531729492550,["whale@Whale",[[-1,13,"]"]],[14,14],[13,13]]],[1531729495109,["whale@Whale",[[1,18,"]()"]],[18,18],[21,21]]],[1531729496168,["whale@Whale",[[1,20,"https://securitycafe.ro/2015/01/05/understanding-php-object-injection/"]],[20,20],[90,90]]],[1531729519120,["whale@Whale",[[1,18,"## [Understanding PHP Object Injection](https://securitycafe.ro/2015/01/05/understanding-php-object-injection/)"]],[18,18],[129,129]]],[1531729525231,["whale@Whale",[[-1,46," "],[1,47," "],[-1,55,"n"]],[56,56],[55,55]]],[1531729530885,["whale@Whale",[[-1,18,"## ["]],[20,20],[18,18]]],[1531729537822,["whale@Whale",[[-1,124,"](https://securitycafe.ro/2015/01/05/understanding-php-object-injection/)"]],[52,125],[52,52]]],[1531729545780,["whale@Whale",[[1,51,"n"]],[51,51],[52,52]]]]],["cdecb134-ea6f-446e-87d7-31d0c4308a88",1541050463852,"php反序列化\n===\n[参考资料：Understanding PHP Object Injection](https://securitycafe.ro/2015/01/05/understanding-php-object-injection/)\n\nphp基础提要：\n\n![图1]($res/1.png)\n\n![]($res/%E6%8D%95%E8%8E%B7.PNG)\n\nphp允许保存一个对象方便以后重用，这就是序列化。\n场景：变量值需要跨脚本传递。\n\n### 序列化\n![]($res/%E6%8D%95%E8%8E%B7%203.PNG)\n### 反序列化\n\n先建立一个logfile.php，use.php。\n\n![logfile.php]($res/%E6%8D%95%E8%8E%B7%205.PNG)\n\nlogfile.php定义了一个类，可以进行文件删除操作。\n\n![]($res/%E6%8D%95%E8%8E%B7%204.PNG)\n\nuse.php指定了一个文件，进行删除。\n`O:7:\"LogFile\":1:{s:8:\"filename\";s:5:\"1.php\";}`\n复制生成的这个序列，之后要用到。\n\n之后，建立一个test.php，其中定义一个新的类 User。\n此时图一建立的1.php还存在。\n![捕获 6]($res/%E6%8D%95%E8%8E%B7%206.PNG)\n![捕获 7]($res/%E6%8D%95%E8%8E%B7%207.PNG)\n\n\n\n\n",[[1541050447147,["whale@Whale",[[-1,136,"\n"]],[136,136],[135,135]]],[1541050673679,["whale@Whale",[[1,276,"\n"]],[276,276],[277,277]]],[1541051454521,["whale@Whale",[[1,286,"下面演示php反序列化漏洞。"]],[286,286],[300,300]]],[1541051463670,["whale@Whale",[[-1,301,"先"]],[301,302],[301,301]]],[1541051464966,["whale@Whale",[[-1,303,"一个"]],[305,305],[303,303]]],[1541051467533,["whale@Whale",[[1,314,"（）"]],[314,314],[316,316]]],[1541051480898,["whale@Whale",[[1,315,"定义了一个类，可以进行文件删除"]],[315,315],[330,330]]],[1541051484774,["whale@Whale",[[-1,298,"洞"]],[299,299],[298,298]]],[1541051484981,["whale@Whale",[[-1,297,"漏"]],[298,298],[297,297]]],[1541051487477,["whale@Whale",[[1,337,"（）"]],[337,337],[339,339]]],[1541051498790,["whale@Whale",[[1,338,"使用这个类，生成序列号字符串"]],[338,338],[352,352]]],[1541051514048,["whale@Whale",[[-1,405,"logfile.php定义了一个类，可以进行文件删除操作"]],[405,433],[405,405]]],[1541051516941,["whale@Whale",[[1,369,"定义了一个类，可以进行文件删除操作"]],[358,369],[386,386]]],[1541051518574,["whale@Whale",[[-1,422,"。\n"]],[422,424],[422,422]]],[1541051519462,["whale@Whale",[[-1,422,"\n"]],[422,422],[421,421]]],[1541051561576,["whale@Whale",[[1,355,"1.php()"]],[355,355],[362,362]]],[1541051562614,["whale@Whale",[[-1,360,"()"]],[362,362],[360,360]]],[1541051563354,["whale@Whale",[[1,360,"（）"]],[360,360],[362,362]]],[1541051574112,["whale@Whale",[[1,361,"之后用脚本删除1.php"]],[361,361],[373,373]]],[1541051580614,["whale@Whale",[[1,366,"演示，"]],[366,366],[369,369]]],[1541051586581,["whale@Whale",[[1,378,"\n"]],[377,377],[378,378]]],[1541051591538,["whale@Whale",[[1,378,"test.php（）"]],[378,378],[388,388]]],[1541051598658,["whale@Whale",[[1,387,"接受"]],[387,387],[389,389]]],[1541051608813,["whale@Whale",[[-1,346,"序列号"],[1,349,"x"]],[346,349],[346,347]]],[1541051609018,["whale@Whale",[[1,347,"u"]],[346,347],[346,348]]],[1541051609333,["whale@Whale",[[1,348,"'l"]],[346,348],[346,350]]],[1541051609563,["whale@Whale",[[1,350,"i"]],[346,350],[346,351]]],[1541051609659,["whale@Whale",[[1,351,"e"]],[346,351],[346,352]]],[1541051609883,["whale@Whale",[[1,352,"'h"]],[346,352],[346,354]]],[1541051609988,["whale@Whale",[[1,354,"u"]],[346,354],[346,355]]],[1541051610057,["whale@Whale",[[1,355,"a"]],[346,355],[346,356]]],[1541051610520,["whale@Whale",[[-1,346,"xu'lie'hua"],[1,356,"序列化"]],[346,356],[346,349]]],[1541051622439,["whale@Whale",[[1,389,"序列化字符串，删除1.php"]],[389,389],[403,403]]],[1541051625388,["whale@Whale",[[-1,368,"，"]],[369,369],[368,368]]],[1541051630229,["whale@Whale",[[-1,370,"1.php"]],[370,375],[370,370]]],[1541051636241,["whale@Whale",[[1,370,"该脚本"]],[370,370],[373,373]]],[1541051639653,["whale@Whale",[[-1,363,"用脚本"]],[366,366],[363,363]]],[1541051645532,["whale@Whale",[[1,399,"\n"]],[398,398],[399,399]]],[1541051814858,["whale@Whale",[[1,640,"\n"]],[639,639],[640,640]]],[1541051844129,["whale@Whale",[[1,640,"划重点，test.php因为接受了用户给出的变量usr"]],[640,640],[667,667]]],[1541051852920,["whale@Whale",[[1,667,"_serialized."]],[667,667],[679,679]]],[1541051859953,["whale@Whale",[[-1,678,"."]],[679,679],[678,678]]],[1541051860369,["whale@Whale",[[1,678,","]],[678,678],[679,679]]],[1541051861003,["whale@Whale",[[-1,678,","]],[679,679],[678,678]]],[1541051862461,["whale@Whale",[[1,678,"，二"]],[678,678],[680,680]]],[1541051862951,["whale@Whale",[[-1,679,"二"]],[680,680],[679,679]]],[1541051889364,["whale@Whale",[[1,679,"而用户的输入不可控。导致php脚本解析并执行了删除1.php的操作。"]],[679,679],[713,713]]],[1541051895514,["whale@Whale",[[-1,640,"划重点，test.php因为接受了用户给出的变量usr_serialized，而用户的输入不可控。导致php脚本解析并执行了删除1.php的操作。"]],[640,713],[640,640]]],[1541051896346,["whale@Whale",[[-1,640,"\n"]],[640,640],[639,639]]],[1541051898802,["whale@Whale",[[1,722,"划重点，test.php因为接受了用户给出的变量usr_serialized，而用户的输入不可控。导致php脚本解析并执行了删除1.php的操作。"]],[722,722],[795,795]]],[1541052385665,["whale@Whale",[[1,797,"而test.php本来设计的"]],[797,797],[811,811]]],[1541052393824,["whale@Whale",[[1,811,"功能，是传递“”"]],[811,811],[819,819]]],[1541052435608,["whale@Whale",[[1,818,"O:4:\"User\":2:{s:3:\"age\";i:20;s:4:\"name\";s:4:\"John\";}"]],[818,818],[870,870]]],[1541052439411,["whale@Whale",[[-1,831,"{"]],[831,831],[831,831]]],[1541052444804,["whale@Whale",[[1,872,"\n"]],[870,870],[871,871]]],[1541052446020,["whale@Whale",[[1,873,"\n"]],[871,871],[872,872]]],[1541052453200,["whale@Whale",[[1,872,"于是页面会显示“”"]],[872,872],[881,881]]],[1541052466741,["whale@Whale",[[1,880,"User John is 20 years old."]],[880,880],[906,906]]],[1541052478357,["whale@Whale",[[1,909,"\n"]],[908,908],[909,909]]],[1541052503347,["whale@Whale",[[-1,909,"\n"],[1,910,"在跨页面传递变量的时候，没有设计好，就导致了这个命令执行。"]],[909,909],[938,938]]]]]]}