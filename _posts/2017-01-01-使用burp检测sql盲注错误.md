---
title: 使用burp检测sql盲注错误
categories:
- tools
- sql-inject
tags:
- tools
---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用burp检测sql盲注错误</title>
    <style type="text/css" media="all">
      body {
        margin: 0;
        font-family: "Helvetica Neue", Helvetica, Arial, "Hiragino Sans GB", sans-serif;
        font-size: 14px;
        line-height: 20px;
        color: #777;
        background-color: white;
      }
      .container {
        width: 700px;
        margin-right: auto;
        margin-left: auto;
      }

      .post {
        font-family: Georgia, "Times New Roman", Times, "SimSun", serif;
        position: relative;
        padding: 70px;
        bottom: 0;
        overflow-y: auto;
        font-size: 16px;
        font-weight: normal;
        line-height: 25px;
        color: #515151;
      }

      .post h1{
        font-size: 50px;
        font-weight: 500;
        line-height: 60px;
        margin-bottom: 40px;
        color: inherit;
      }

      .post p {
        margin: 0 0 35px 0;
      }

      .post img {
        border: 1px solid #D9D9D9;
      }

      .post a {
        color: #28A1C5;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="post">
        <h1 class="title">使用burp检测sql盲注错误</h1>
        <div class="show-content">
          <p><a href="https://support.portswigger.net/customer/en/portal/articles/2163788-Methodology_Blind%20SQL%20Injection%20Detection.html" target="_blank">https://support.portswigger.net/customer/en/portal/articles/2163788-Methodology_Blind%20SQL%20Injection%20Detection.html</a></p><p>sql注入漏洞，如果不能直接被标识为消息错误或者直接返回数据，那么sql注入漏洞就不得不与“blind（盲目的）”相关。</p><p>这些漏洞利用会更加困难，但不是不可能来探测和利用。在这篇文章我们将会测试一些可能的方式，通过盲注sql漏洞有关的布尔盲注时间、时间延迟注入等外部方式。</p><h1>布尔盲注。</h1><p>这里我们有一个web应用程序案例。从OWASP的错误web应用程序项目获得的“WebGoat”版本。</p><p>这个表单是被设计用来测试输入的用户号码是否存在。</p><p>我们可以看到用户号码101产生一个正确的结果，所以这个用户号码是有效的。这就是正确的条件。</p><div class="image-package">
<img class="uploaded-img" src="http://upload-images.jianshu.io/upload_images/2883590-c43f7138c2e0764c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="auto" height="auto"><br><div class="image-caption"></div>
</div><p>接下来我们将会满足错误条件。在这个案例中，我们会使用用户号码666。这个应用程序返回了一个消极的响应，所以用户号码是无效的。</p><p>这就是错误的情形。</p><div class="image-package">
<img class="uploaded-img" src="http://upload-images.jianshu.io/upload_images/2883590-1b95bf370a7b00fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="auto" height="auto"><br><div class="image-caption"></div>
</div><p>下一步是确认输入作为sql查询，并且我们能够使用使用sql语法执行一个正确或者错误测试。</p><p>接下来我们输入101 and 1=1。我们知道这些条件都是正确的，并且会期待一个正确的响应。</p><div class="image-package">
<img class="uploaded-img" src="http://upload-images.jianshu.io/upload_images/2883590-89d8d31df0f3180a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="auto" height="auto"><br><div class="image-caption"></div>
</div><p>这里我们输入101 and 1=2，我们知道仅仅只有一部分条件是正确的，并且返回一个错误响应。</p><p>现在我们可以知道,我们可以使用sql语法询问应用程序"问题"，我们可以注入sql来寻找任意信息。</p><div class="image-package">
<img class="uploaded-img" src="http://upload-images.jianshu.io/upload_images/2883590-f7b57cc6c7d5b876.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="auto" height="auto"><br><div class="image-caption"></div>
</div><p>在这个案例中我们将会寻找与c_cnumber有关的pin号码。为了寻找pin在这个案例中，我们将会改变用sql语句改变数字，并且等待应用程序产生一个正确的响应。为了减少请求包含的数字，我们能够每一次就测试一个字符的号码，然后执行二进制搜索来有效的找到正确答案。</p><p>我们能够使用Burp Intruder来自动化这个过程。</p><h1>使用时间延时</h1><p>在一些sql注入案例中，通过布尔条件盲注引发不会引发任何不同的响应，另一个替代的技术通常是时间延时注入。</p><p>在这个案例中我们使用一个<a href="http://mdsec.net/labs/" target="_blank">练习</a>。</p><p>我们可能会尝试引起条件错误。然而，这对于应用程序的行为，没有任何效果，即使在数据库内部引起了一个错误。</p><p>在这种情形下，我们可以使用Burp Suite来插入sql，将会导致一个时间延迟，然后监控响应的时间。</p><p>确保代理Proxy中的拦截Intercept按钮是开启的"Intercept is on"。然后重新发送一个请求。</p><p>在任何地方右键，然后点击Send to Repeater</p><p>我们可以使用"request"面板中的“raw"或者"params"按钮改变请求。</p><p>在这个案例中，我们注入MS-SQL数据库。我们注入如下字符到请求参数然后监控应用程序将会使用多久，以此判定漏洞。</p><blockquote><p>1; waitfor delay '0:0:5'--</p></blockquote><p>在repeater响应控制台，我们可以看到花费了多久获得了响应。在这个案例中花费了5秒。</p><p>这显示了应用程序确实有SQL注入。</p><h1>使用外部方法</h1><p>在一些情况下，不可能引发任何可以注意到的应用程序响应异常，无论是从它的内容或者它花费的时间。</p><p>在这种情况下，检测SQL注入漏洞的可能方式是引发数据库与测试者的服务器out-of-band网络连接。</p><p>Burp扫描器使用了这个技术通过Burp Collaborator</p><p>在这个案例，我们可以看到Burp扫描器利用盲注入漏洞引发数据库与Burp Collaborator 服务器网络连接。</p><p>这个特别的攻击使用了微软SQL服务器xp_dirtree存储进程。同样的技术存在与其他数据库平台，并且这些都被Burp扫描器所使用。</p><p>(原网页 ——burp官网提供了一个5分钟的视频，进行操作讲解，建议移步，进行观摩学习)</p>
        </div>
      </div>
    </div>
  </body>
</html>
